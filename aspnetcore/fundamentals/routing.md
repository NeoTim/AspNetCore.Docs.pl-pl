---
title: Routing w ASP.NET Rdzeniu
author: rick-anderson
description: Dowiedz się, jak ASP.NET routingu core jest odpowiedzialny za dopasowanie żądań HTTP i wysyłanie do wykonywalnych punktów końcowych.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 4/1/2020
uid: fundamentals/routing
ms.openlocfilehash: 0fc89ccf15c14c67f284a7084a21159af300a195
ms.sourcegitcommit: 5af16166977da598953f82da3ed3b7712d38f6cb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/14/2020
ms.locfileid: "81277226"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="85187-103">Routing w ASP.NET Rdzeniu</span><span class="sxs-lookup"><span data-stu-id="85187-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="85187-104">Przez [Ryan Nowak](https://github.com/rynowak), Kirk [Larkin](https://twitter.com/serpent5)i [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="85187-104">By [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="85187-105">Routing jest odpowiedzialny za dopasowywanie przychodzących żądań HTTP i wysyłanie tych żądań do wykonywalnych punktów końcowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-105">Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app's executable endpoints.</span></span> <span data-ttu-id="85187-106">[Punkty końcowe](#endpoint) to jednostki kodu obsługi żądań wykonywalnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-106">[Endpoints](#endpoint) are the app's units of executable request-handling code.</span></span> <span data-ttu-id="85187-107">Punkty końcowe są definiowane w aplikacji i konfigurowane po uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-107">Endpoints are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="85187-108">Proces dopasowywania punktu końcowego można wyodrębnić wartości z adresu URL żądania i podać te wartości do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="85187-108">The endpoint matching process can extract values from the request's URL and provide those values for request processing.</span></span> <span data-ttu-id="85187-109">Korzystając z informacji o punktach końcowych z aplikacji, routing jest również w stanie wygenerować adresy URL, które mapują do punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-109">Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="85187-110">Aplikacje mogą konfigurować routing za pomocą:</span><span class="sxs-lookup"><span data-stu-id="85187-110">Apps can configure routing using:</span></span>

- <span data-ttu-id="85187-111">Kontrolery</span><span class="sxs-lookup"><span data-stu-id="85187-111">Controllers</span></span>
- <span data-ttu-id="85187-112">Razor Pages</span><span class="sxs-lookup"><span data-stu-id="85187-112">Razor Pages</span></span>
- <span data-ttu-id="85187-113">SignalR</span><span class="sxs-lookup"><span data-stu-id="85187-113">SignalR</span></span>
- <span data-ttu-id="85187-114">Usługi gRPC</span><span class="sxs-lookup"><span data-stu-id="85187-114">gRPC Services</span></span>
- <span data-ttu-id="85187-115">[Oprogramowanie pośredniczące](xref:fundamentals/middleware/index) z włączoną funkcją punktu końcowego, takie jak [Health Checks](xref:host-and-deploy/health-checks).</span><span class="sxs-lookup"><span data-stu-id="85187-115">Endpoint-enabled [middleware](xref:fundamentals/middleware/index) such as [Health Checks](xref:host-and-deploy/health-checks).</span></span>
- <span data-ttu-id="85187-116">Delegaci i lambdas zarejestrowane z routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-116">Delegates and lambdas registered with routing.</span></span>

<span data-ttu-id="85187-117">Ten dokument zawiera szczegóły niskiego poziomu ASP.NET routingu core.</span><span class="sxs-lookup"><span data-stu-id="85187-117">This document covers low-level details of ASP.NET Core routing.</span></span> <span data-ttu-id="85187-118">Aby uzyskać informacje na temat konfigurowania routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-118">For information on configuring routing:</span></span>

* <span data-ttu-id="85187-119">Dla kontrolerów, <xref:mvc/controllers/routing>patrz .</span><span class="sxs-lookup"><span data-stu-id="85187-119">For controllers, see <xref:mvc/controllers/routing>.</span></span>
* <span data-ttu-id="85187-120">Aby zapoznać się z <xref:razor-pages/razor-pages-conventions>konwencjami strony razor, zobacz .</span><span class="sxs-lookup"><span data-stu-id="85187-120">For Razor Pages conventions, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="85187-121">System routingu punktów końcowych opisany w tym dokumencie ma zastosowanie do ASP.NET Core 3.0 i nowszych.</span><span class="sxs-lookup"><span data-stu-id="85187-121">The endpoint routing system described in this document applies to ASP.NET Core 3.0 and later.</span></span> <span data-ttu-id="85187-122">Aby uzyskać informacje na temat <xref:Microsoft.AspNetCore.Routing.IRouter>poprzedniego systemu routingu opartego na programie , wybierz ASP.NET wersję Core 2.1 przy użyciu jednego z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="85187-122">For information on the previous routing system based on <xref:Microsoft.AspNetCore.Routing.IRouter>, select the ASP.NET Core 2.1 version using one of the following approaches:</span></span>

* <span data-ttu-id="85187-123">Selektor wersji dla poprzedniej wersji.</span><span class="sxs-lookup"><span data-stu-id="85187-123">The version selector for a previous version.</span></span>
* <span data-ttu-id="85187-124">Wybierz [ASP.NET routingu Core 2.1](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="85187-124">Select [ASP.NET Core 2.1 routing](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

<span data-ttu-id="85187-125">[Wyświetl lub pobierz przykładowy kod](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([jak pobrać](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="85187-125">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([how to download](xref:index#how-to-download-a-sample))</span></span>

<span data-ttu-id="85187-126">Próbki pobierania dla tego dokumentu są włączone `Startup` przez określoną klasę.</span><span class="sxs-lookup"><span data-stu-id="85187-126">The download samples for this document are enabled by a specific `Startup` class.</span></span> <span data-ttu-id="85187-127">Aby uruchomić określoną próbkę, zmodyfikuj *Program.cs,* aby wywołać żądaną `Startup` klasę.</span><span class="sxs-lookup"><span data-stu-id="85187-127">To run a specific sample, modify *Program.cs* to call the desired `Startup` class.</span></span>

## <a name="routing-basics"></a><span data-ttu-id="85187-128">Podstawowe informacje o routingu</span><span class="sxs-lookup"><span data-stu-id="85187-128">Routing basics</span></span>

<span data-ttu-id="85187-129">Wszystkie szablony ASP.NET Core obejmują routing w wygenerowanym kodzie.</span><span class="sxs-lookup"><span data-stu-id="85187-129">All ASP.NET Core templates include routing in the generated code.</span></span> <span data-ttu-id="85187-130">Routing jest zarejestrowany w potoku [oprogramowania pośredniczącego](xref:fundamentals/middleware/index) w `Startup.Configure`pliku .</span><span class="sxs-lookup"><span data-stu-id="85187-130">Routing is registered in the [middleware](xref:fundamentals/middleware/index) pipeline in `Startup.Configure`.</span></span>

<span data-ttu-id="85187-131">Poniższy kod przedstawia podstawowy przykład routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-131">The following code shows a basic example of routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet&highlight=8,10)]

<span data-ttu-id="85187-132">Routing wykorzystuje parę oprogramowania pośredniczącego, zarejestrowanego przez <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> i: <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*></span><span class="sxs-lookup"><span data-stu-id="85187-132">Routing uses a pair of middleware, registered by <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span></span>

* <span data-ttu-id="85187-133">`UseRouting`dodaje dopasowanie trasy do potoku oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-133">`UseRouting` adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="85187-134">To oprogramowanie pośredniczące analizuje zestaw punktów końcowych zdefiniowanych w aplikacji i wybiera [najlepsze dopasowanie](#urlm) na podstawie żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-134">This middleware looks at the set of endpoints defined in the app, and selects the [best match](#urlm) based on the request.</span></span>
* <span data-ttu-id="85187-135">`UseEndpoints`dodaje wykonanie punktu końcowego do potoku oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-135">`UseEndpoints` adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="85187-136">Uruchamia delegata skojarzonego z wybranym punktem końcowym.</span><span class="sxs-lookup"><span data-stu-id="85187-136">It runs the delegate associated with the selected endpoint.</span></span>

<span data-ttu-id="85187-137">W poprzednim przykładzie znajduje się pojedyncza *trasa do* punktu końcowego kodu przy użyciu [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) metody:</span><span class="sxs-lookup"><span data-stu-id="85187-137">The preceding example includes a single *route to code* endpoint using the [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) method:</span></span>

* <span data-ttu-id="85187-138">Gdy żądanie `GET` HTTP jest wysyłane `/`do głównego adresu URL:</span><span class="sxs-lookup"><span data-stu-id="85187-138">When an HTTP `GET` request is sent to the root URL `/`:</span></span>
  * <span data-ttu-id="85187-139">Delegat żądania pokazano wykonuje.</span><span class="sxs-lookup"><span data-stu-id="85187-139">The request delegate shown executes.</span></span>
  * <span data-ttu-id="85187-140">`Hello World!`jest zapisywany w odpowiedzi HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-140">`Hello World!` is written to the HTTP response.</span></span> <span data-ttu-id="85187-141">Domyślnie głównym adresem `/` `https://localhost:5001/`URL jest .</span><span class="sxs-lookup"><span data-stu-id="85187-141">By default, the root URL `/` is `https://localhost:5001/`.</span></span>
* <span data-ttu-id="85187-142">Jeśli metoda żądania `GET` nie jest lub `/`główny adres URL nie jest , nie trasy mecze i HTTP 404 jest zwracany.</span><span class="sxs-lookup"><span data-stu-id="85187-142">If the request method is not `GET` or the root URL is not `/`, no route matches and an HTTP 404 is returned.</span></span>

### <a name="endpoint"></a><span data-ttu-id="85187-143">Endpoint</span><span class="sxs-lookup"><span data-stu-id="85187-143">Endpoint</span></span>

<a name="endpoint"></a>

<span data-ttu-id="85187-144">Metoda `MapGet` jest używana do definiowania **punktu końcowego**.</span><span class="sxs-lookup"><span data-stu-id="85187-144">The `MapGet` method is used to define an **endpoint**.</span></span> <span data-ttu-id="85187-145">Punkt końcowy jest coś, co może być:</span><span class="sxs-lookup"><span data-stu-id="85187-145">An endpoint is something that can be:</span></span>

* <span data-ttu-id="85187-146">Wybrano, dopasowując adres URL i metodę HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-146">Selected, by matching the URL and HTTP method.</span></span>
* <span data-ttu-id="85187-147">Wykonywane, uruchamiając pełnomocnika.</span><span class="sxs-lookup"><span data-stu-id="85187-147">Executed, by running the delegate.</span></span>

<span data-ttu-id="85187-148">Punkty końcowe, które mogą być dopasowane i wykonywane `UseEndpoints`przez aplikację są konfigurowane w programie .</span><span class="sxs-lookup"><span data-stu-id="85187-148">Endpoints that can be matched and executed by the app are configured in `UseEndpoints`.</span></span> <span data-ttu-id="85187-149">Na przykład <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*> <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, i [podobne metody](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) połączyć delegatów żądania do systemu routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-149">For example, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [similar methods](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connect request delegates to the routing system.</span></span>
<span data-ttu-id="85187-150">Dodatkowe metody mogą być używane do łączenia funkcji ASP.NET Core framework z systemem routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-150">Additional methods can be used to connect ASP.NET Core framework features to the routing system:</span></span>
- [<span data-ttu-id="85187-151">MapRazorPages dla stron razor</span><span class="sxs-lookup"><span data-stu-id="85187-151">MapRazorPages for Razor Pages</span></span>](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)
- [<span data-ttu-id="85187-152">Kontrolery MapControllers dla kontrolerów</span><span class="sxs-lookup"><span data-stu-id="85187-152">MapControllers for controllers</span></span>](xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*)
- [<span data-ttu-id="85187-153">>\<MapHub THub dla SignalR</span><span class="sxs-lookup"><span data-stu-id="85187-153">MapHub\<THub> for SignalR</span></span>](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*) 
- [<span data-ttu-id="85187-154">MapGrpcService\<> dla gRPC</span><span class="sxs-lookup"><span data-stu-id="85187-154">MapGrpcService\<TService> for gRPC</span></span>](xref:grpc/aspnetcore)

<span data-ttu-id="85187-155">W poniższym przykładzie przedstawiono routing z bardziej zaawansowanym szablonem trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-155">The following example shows routing with a more sophisticated route template:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/RouteTemplateStartup.cs?name=snippet)]

<span data-ttu-id="85187-156">Ciąg `/hello/{name:alpha}` jest **szablonem trasy**.</span><span class="sxs-lookup"><span data-stu-id="85187-156">The string `/hello/{name:alpha}` is a **route template**.</span></span> <span data-ttu-id="85187-157">Służy do konfigurowania sposobu dopasowania punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-157">It is used to configure how the endpoint is matched.</span></span> <span data-ttu-id="85187-158">W takim przypadku szablon jest zgodny:</span><span class="sxs-lookup"><span data-stu-id="85187-158">In this case, the template matches:</span></span>

* <span data-ttu-id="85187-159">Adres URL, taki jak`/hello/Ryan`</span><span class="sxs-lookup"><span data-stu-id="85187-159">A URL like `/hello/Ryan`</span></span>
* <span data-ttu-id="85187-160">Dowolna ścieżka `/hello/` adresu URL, po której następuje sekwencja znaków alfabetycznych.</span><span class="sxs-lookup"><span data-stu-id="85187-160">Any URL path that begins with `/hello/` followed by a sequence of alphabetic characters.</span></span>  <span data-ttu-id="85187-161">`:alpha`stosuje ograniczenie trasy, które pasuje tylko do znaków alfabetycznych.</span><span class="sxs-lookup"><span data-stu-id="85187-161">`:alpha` applies a route constraint that matches only alphabetic characters.</span></span> <span data-ttu-id="85187-162">[Ograniczenia trasy](#route-constraint-reference) są wyjaśnione w dalszej części tego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="85187-162">[Route constraints](#route-constraint-reference) are explained later in this document.</span></span>

<span data-ttu-id="85187-163">Drugi segment ścieżki adresu `{name:alpha}`URL, :</span><span class="sxs-lookup"><span data-stu-id="85187-163">The second segment of the URL path, `{name:alpha}`:</span></span>

* <span data-ttu-id="85187-164">Jest powiązany `name` z parametrem.</span><span class="sxs-lookup"><span data-stu-id="85187-164">Is bound to the `name` parameter.</span></span>
* <span data-ttu-id="85187-165">Jest przechwytywany i przechowywany w [httprequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span><span class="sxs-lookup"><span data-stu-id="85187-165">Is captured and stored in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span></span>

<span data-ttu-id="85187-166">System routingu punktów końcowych opisany w tym dokumencie jest nowy od ASP.NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="85187-166">The endpoint routing system described in this document is new as of ASP.NET Core 3.0.</span></span> <span data-ttu-id="85187-167">Jednak wszystkie wersje ASP.NET Core obsługują ten sam zestaw funkcji szablonu trasy i ograniczeń trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-167">However, all versions of ASP.NET Core support the same set of route template features and route constraints.</span></span>

<span data-ttu-id="85187-168">W poniższym przykładzie przedstawiono routing z [kontrolą kondycji](xref:host-and-deploy/health-checks) i autoryzacją:</span><span class="sxs-lookup"><span data-stu-id="85187-168">The following example shows routing with [health checks](xref:host-and-deploy/health-checks) and authorization:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

[!INCLUDE[request localized comments](~/includes/code-comments-loc.md)]

<span data-ttu-id="85187-169">W poprzednim przykładzie pokazano, jak:</span><span class="sxs-lookup"><span data-stu-id="85187-169">The preceding example demonstrates how:</span></span>

* <span data-ttu-id="85187-170">Oprogramowanie pośredniczące autoryzacji może być używane z routingiem.</span><span class="sxs-lookup"><span data-stu-id="85187-170">The authorization middleware can be used with routing.</span></span>
* <span data-ttu-id="85187-171">Punkty końcowe mogą służyć do konfigurowania zachowania autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-171">Endpoints can be used to configure authorization behavior.</span></span>

<span data-ttu-id="85187-172">Wywołanie <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> dodaje punkt końcowy sprawdzania kondycji.</span><span class="sxs-lookup"><span data-stu-id="85187-172">The <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> call adds a health check endpoint.</span></span> <span data-ttu-id="85187-173">Tworzenie <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> łańcucha do tego wywołania dołącza zasady autoryzacji do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-173">Chaining <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> on to this call attaches an authorization policy to the endpoint.</span></span>

<span data-ttu-id="85187-174"><xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> Wywołanie <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> i dodaje oprogramowanie pośredniczące uwierzytelniania i autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-174">Calling <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> and <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> adds the authentication and authorization middleware.</span></span> <span data-ttu-id="85187-175">Te oprogramowanie pośredniczące są umieszczone między <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> i `UseEndpoints` tak, że mogą:</span><span class="sxs-lookup"><span data-stu-id="85187-175">These middleware are placed between <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and `UseEndpoints` so that they can:</span></span>

* <span data-ttu-id="85187-176">Zobacz, który punkt `UseRouting`końcowy został wybrany przez .</span><span class="sxs-lookup"><span data-stu-id="85187-176">See which endpoint was selected by `UseRouting`.</span></span>
* <span data-ttu-id="85187-177">Zastosuj zasady autoryzacji przed <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> wysyłką do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-177">Apply an authorization policy before <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> dispatches to the endpoint.</span></span>

<a name="metadata"></a>

### <a name="endpoint-metadata"></a><span data-ttu-id="85187-178">Metadane punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="85187-178">Endpoint metadata</span></span>

<span data-ttu-id="85187-179">W poprzednim przykładzie istnieją dwa punkty końcowe, ale tylko punkt końcowy sprawdzania kondycji ma dołączoną zasadę autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-179">In the preceding example, there are two endpoints, but only the health check endpoint has an authorization policy attached.</span></span> <span data-ttu-id="85187-180">Jeśli żądanie jest zgodne z `/healthz`punktem końcowym sprawdzania kondycji, wykonywane jest sprawdzanie autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-180">If the request matches the health check endpoint, `/healthz`, an authorization check is performed.</span></span> <span data-ttu-id="85187-181">To pokazuje, że punkty końcowe mogą mieć dodatkowe dane dołączone do nich.</span><span class="sxs-lookup"><span data-stu-id="85187-181">This demonstrates that endpoints can have extra data attached to them.</span></span> <span data-ttu-id="85187-182">Te dodatkowe dane są nazywane **metadanymi**punktu końcowego:</span><span class="sxs-lookup"><span data-stu-id="85187-182">This extra data is called endpoint **metadata**:</span></span>

* <span data-ttu-id="85187-183">Metadane mogą być przetwarzane przez oprogramowanie pośredniczące obsługujące routing.</span><span class="sxs-lookup"><span data-stu-id="85187-183">The metadata can be processed by routing-aware middleware.</span></span>
* <span data-ttu-id="85187-184">Metadane mogą być dowolnego typu .NET.</span><span class="sxs-lookup"><span data-stu-id="85187-184">The metadata can be of any .NET type.</span></span>

## <a name="routing-concepts"></a><span data-ttu-id="85187-185">Pojęcia dotyczące routingu</span><span class="sxs-lookup"><span data-stu-id="85187-185">Routing concepts</span></span>

<span data-ttu-id="85187-186">System routingu opiera się na potoku oprogramowania pośredniczącego, dodając zaawansowana koncepcja **punktu końcowego.**</span><span class="sxs-lookup"><span data-stu-id="85187-186">The routing system builds on top of the middleware pipeline by adding the powerful **endpoint** concept.</span></span> <span data-ttu-id="85187-187">Punkty końcowe reprezentują jednostki funkcji aplikacji, które różnią się od siebie pod względem routingu, autoryzacji i dowolnej liczby ASP.NET systemów Core.</span><span class="sxs-lookup"><span data-stu-id="85187-187">Endpoints represent units of the app's functionality that are distinct from each other in terms of routing, authorization, and any number of ASP.NET Core's systems.</span></span>

<a name="endpoint"></a>

### <a name="aspnet-core-endpoint-definition"></a><span data-ttu-id="85187-188">Definicja punktu końcowego ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="85187-188">ASP.NET Core endpoint definition</span></span>

<span data-ttu-id="85187-189">Punktem końcowym ASP.NET Core jest:</span><span class="sxs-lookup"><span data-stu-id="85187-189">An ASP.NET Core endpoint is:</span></span>

* <span data-ttu-id="85187-190">Plik wykonywalny: ma <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>plik .</span><span class="sxs-lookup"><span data-stu-id="85187-190">Executable: Has a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span></span>
* <span data-ttu-id="85187-191">Rozszerzalny: Ma kolekcję [metadanych.](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*)</span><span class="sxs-lookup"><span data-stu-id="85187-191">Extensible: Has a [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) collection.</span></span>
* <span data-ttu-id="85187-192">Możliwość wyboru: Opcjonalnie ma [informacje o routingu](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span><span class="sxs-lookup"><span data-stu-id="85187-192">Selectable: Optionally, has [routing information](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span></span>
* <span data-ttu-id="85187-193">Wyliczalne: Kolekcja punktów końcowych może być wymieniona <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> przez pobranie z [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="85187-193">Enumerable: The collection of endpoints can be listed by retrieving the <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> from [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="85187-194">Poniższy kod pokazuje, jak pobrać i sprawdzić punkt końcowy pasujący do bieżącego żądania:</span><span class="sxs-lookup"><span data-stu-id="85187-194">The following code shows how to retrieve and inspect the endpoint matching the current request:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/EndpointInspectorStartup.cs?name=snippet)]

<span data-ttu-id="85187-195">Punkt końcowy, jeśli jest zaznaczony, `HttpContext`można pobrać z pliku .</span><span class="sxs-lookup"><span data-stu-id="85187-195">The endpoint, if selected, can be retrieved from the `HttpContext`.</span></span> <span data-ttu-id="85187-196">Jego właściwości mogą być kontrolowane.</span><span class="sxs-lookup"><span data-stu-id="85187-196">Its properties can be inspected.</span></span> <span data-ttu-id="85187-197">Obiekty punktu końcowego są niezmienne i nie można ich zmodyfikować po utworzeniu.</span><span class="sxs-lookup"><span data-stu-id="85187-197">Endpoint objects are immutable and cannot be modified after creation.</span></span> <span data-ttu-id="85187-198">Najczęstszym typem punktu końcowego jest . <xref:Microsoft.AspNetCore.Routing.RouteEndpoint></span><span class="sxs-lookup"><span data-stu-id="85187-198">The most common type of endpoint is a <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span></span> <span data-ttu-id="85187-199">`RouteEndpoint`zawiera informacje, które umożliwiają wybór przez system wyznaczania tras.</span><span class="sxs-lookup"><span data-stu-id="85187-199">`RouteEndpoint` includes information that allows it to be to selected by the routing system.</span></span>

<span data-ttu-id="85187-200">W poprzednim kodzie [aplikacji. Użyj](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) konfiguruje oprogramowanie [pośredniczące](xref:fundamentals/middleware/index)w wierszu .</span><span class="sxs-lookup"><span data-stu-id="85187-200">In the preceding code, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configures an in-line [middleware](xref:fundamentals/middleware/index).</span></span>

<a name="mt"></a>

<span data-ttu-id="85187-201">Poniższy kod pokazuje, że `app.Use` w zależności od tego, gdzie jest wywoływana w potoku, może nie być punkt końcowy:</span><span class="sxs-lookup"><span data-stu-id="85187-201">The following code shows that, depending on where `app.Use` is called in the pipeline, there may not be an endpoint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/MiddlewareFlowStartup.cs?name=snippet)]

<span data-ttu-id="85187-202">W tym poprzednim `Console.WriteLine` przykładzie dodaje instrukcje, które wyświetlają, czy punkt końcowy został wybrany.</span><span class="sxs-lookup"><span data-stu-id="85187-202">This preceding sample adds `Console.WriteLine` statements that display whether or not an endpoint has been selected.</span></span> <span data-ttu-id="85187-203">Dla jasności przykład przypisuje nazwę wyświetlaną do `/` podanego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-203">For clarity, the sample assigns a display name to the provided `/` endpoint.</span></span>

<span data-ttu-id="85187-204">Uruchamianie tego kodu `/` z adresem URL wyświetla:</span><span class="sxs-lookup"><span data-stu-id="85187-204">Running this code with a URL of `/` displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: Hello
3. Endpoint: Hello
```

<span data-ttu-id="85187-205">Uruchamianie tego kodu z dowolnym innym adresem URL wyświetla:</span><span class="sxs-lookup"><span data-stu-id="85187-205">Running this code with any other URL displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: (null)
4. Endpoint: (null)
```

<span data-ttu-id="85187-206">To dane wyjściowe pokazują, że:</span><span class="sxs-lookup"><span data-stu-id="85187-206">This output demonstrates that:</span></span>

* <span data-ttu-id="85187-207">Punkt końcowy jest zawsze `UseRouting` null przed jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="85187-207">The endpoint is always null before `UseRouting` is called.</span></span>
* <span data-ttu-id="85187-208">Jeśli zostanie znalezione dopasowanie, punkt końcowy jest `UseRouting` <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>nie-null między i .</span><span class="sxs-lookup"><span data-stu-id="85187-208">If a match is found, the endpoint is non-null between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="85187-209">Oprogramowanie `UseEndpoints` pośredniczące jest **terminalem** po znalezieniu dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-209">The `UseEndpoints` middleware is **terminal** when a match is found.</span></span> <span data-ttu-id="85187-210">[Oprogramowanie pośredniczące terminalu](#tm) jest zdefiniowane w dalszej części tego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="85187-210">[Terminal middleware](#tm) is defined later in this document.</span></span>
* <span data-ttu-id="85187-211">Oprogramowanie pośredniczące po `UseEndpoints` wykonaniu tylko wtedy, gdy nie znaleziono dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-211">The middleware after `UseEndpoints` execute only when no match is found.</span></span>

<span data-ttu-id="85187-212">Oprogramowanie `UseRouting` pośredniczące używa [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) metody, aby dołączyć punkt końcowy do bieżącego kontekstu.</span><span class="sxs-lookup"><span data-stu-id="85187-212">The `UseRouting` middleware uses the [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) method to attach the endpoint to the current context.</span></span> <span data-ttu-id="85187-213">Jest możliwe, aby `UseRouting` zastąpić oprogramowanie pośredniczące z logiką niestandardową i nadal uzyskać korzyści z używania punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-213">It's possible to replace the `UseRouting` middleware with custom logic and still get the benefits of using endpoints.</span></span> <span data-ttu-id="85187-214">Punkty końcowe są niskiego poziomu pierwotne, takie jak oprogramowanie pośredniczące i nie są powiązane z implementacji routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-214">Endpoints are a low-level primitive like middleware, and aren't coupled to the routing implementation.</span></span> <span data-ttu-id="85187-215">Większość aplikacji nie musi `UseRouting` zastępować logiką niestandardową.</span><span class="sxs-lookup"><span data-stu-id="85187-215">Most apps don't need to replace `UseRouting` with custom logic.</span></span>

<span data-ttu-id="85187-216">Oprogramowanie `UseEndpoints` pośredniczące jest przeznaczone do `UseRouting` stosowania w połączeniu z oprogramowaniem pośredniczącym.</span><span class="sxs-lookup"><span data-stu-id="85187-216">The `UseEndpoints` middleware is designed to be used in tandem with the `UseRouting` middleware.</span></span> <span data-ttu-id="85187-217">Podstawowa logika do wykonania punktu końcowego nie jest skomplikowana.</span><span class="sxs-lookup"><span data-stu-id="85187-217">The core logic to execute an endpoint isn't complicated.</span></span> <span data-ttu-id="85187-218">Służy <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> do pobierania punktu końcowego, a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> następnie wywołać jego właściwości.</span><span class="sxs-lookup"><span data-stu-id="85187-218">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> to retrieve the endpoint, and then invoke its <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> property.</span></span>

<span data-ttu-id="85187-219">Poniższy kod pokazuje, jak oprogramowanie pośredniczące może wpływać na routing lub reagować na:</span><span class="sxs-lookup"><span data-stu-id="85187-219">The following code demonstrates how middleware can influence or react to routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/IntegratedMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="85187-220">W poprzednim przykładzie przedstawiono dwa ważne pojęcia:</span><span class="sxs-lookup"><span data-stu-id="85187-220">The preceding example demonstrates two important concepts:</span></span>

* <span data-ttu-id="85187-221">Oprogramowanie pośredniczące `UseRouting` można uruchomić przed zmodyfikowaniem danych, które działa na routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-221">Middleware can run before `UseRouting` to modify the data that routing operates upon.</span></span>
    * <span data-ttu-id="85187-222">Zwykle oprogramowanie pośredniczące, które pojawia się przed marszrutą, modyfikuje niektóre właściwości żądania, takie jak <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>lub <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span><span class="sxs-lookup"><span data-stu-id="85187-222">Usually middleware that appears before routing modifies some property of the request, such as <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>, or <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span></span>
* <span data-ttu-id="85187-223">Oprogramowanie pośredniczące `UseRouting` <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> można uruchomić między i do przetwarzania wyników routingu przed wykonaniem punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-223">Middleware can run between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> to process the results of routing before the endpoint is executed.</span></span>
    * <span data-ttu-id="85187-224">Oprogramowanie pośredniczące, które działa między `UseRouting` i: `UseEndpoints`</span><span class="sxs-lookup"><span data-stu-id="85187-224">Middleware that runs between `UseRouting` and `UseEndpoints`:</span></span>
      * <span data-ttu-id="85187-225">Zazwyczaj sprawdza metadane, aby zrozumieć punkty końcowe.</span><span class="sxs-lookup"><span data-stu-id="85187-225">Usually inspects metadata to understand the endpoints.</span></span>
      * <span data-ttu-id="85187-226">Często podejmuje decyzje dotyczące bezpieczeństwa, jak to zrobić przez `UseAuthorization` i `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="85187-226">Often makes security decisions, as done by `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="85187-227">Połączenie oprogramowania pośredniczącego i metadanych umożliwia konfigurowanie zasad dla punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-227">The combination of middleware and metadata allows configuring policies per-endpoint.</span></span>

<span data-ttu-id="85187-228">Poprzedni kod przedstawia przykład niestandardowego oprogramowania pośredniczącego, który obsługuje zasady punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-228">The preceding code shows an example of a custom middleware that supports per-endpoint policies.</span></span> <span data-ttu-id="85187-229">Oprogramowanie pośredniczące zapisuje *dziennik inspekcji* dostępu do poufnych danych do konsoli.</span><span class="sxs-lookup"><span data-stu-id="85187-229">The middleware writes an *audit log* of access to sensitive data to the console.</span></span> <span data-ttu-id="85187-230">Oprogramowanie pośredniczące można *audit* skonfigurować do inspekcji `AuditPolicyAttribute` punktu końcowego z metadanymi.</span><span class="sxs-lookup"><span data-stu-id="85187-230">The middleware can be configured to *audit* an endpoint with the `AuditPolicyAttribute` metadata.</span></span> <span data-ttu-id="85187-231">W tym przykładzie pokazano wzorzec *opt-in, w* którym tylko punkty końcowe, które są oznaczone jako poufne są poddane inspekcji.</span><span class="sxs-lookup"><span data-stu-id="85187-231">This sample demonstrates an *opt-in* pattern where only endpoints that are marked as sensitive are audited.</span></span> <span data-ttu-id="85187-232">Można zdefiniować tę logikę w odwrotnej kolejności, na przykład inspekcji wszystko, co nie jest oznaczone jako bezpieczne.</span><span class="sxs-lookup"><span data-stu-id="85187-232">It's possible to define this logic in reverse, auditing everything that isn't marked as safe, for example.</span></span> <span data-ttu-id="85187-233">System metadanych punktu końcowego jest elastyczny.</span><span class="sxs-lookup"><span data-stu-id="85187-233">The endpoint metadata system is flexible.</span></span> <span data-ttu-id="85187-234">Ta logika może być zaprojektowana w dowolny sposób, który pasuje do przypadku użycia.</span><span class="sxs-lookup"><span data-stu-id="85187-234">This logic could be designed in whatever way suits the use case.</span></span>

<span data-ttu-id="85187-235">Poprzedni przykładowy kod ma na celu zademonstrowanie podstawowych pojęć punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-235">The preceding sample code is intended to demonstrate the basic concepts of endpoints.</span></span> <span data-ttu-id="85187-236">**Próbka nie jest przeznaczona do użytku produkcyjnego.**</span><span class="sxs-lookup"><span data-stu-id="85187-236">**The sample is not intended for production use**.</span></span> <span data-ttu-id="85187-237">Bardziej kompletna wersja oprogramowania pośredniczącego *dziennika inspekcji:*</span><span class="sxs-lookup"><span data-stu-id="85187-237">A more complete version of an *audit log* middleware would:</span></span>

* <span data-ttu-id="85187-238">Zaloguj się do pliku lub bazy danych.</span><span class="sxs-lookup"><span data-stu-id="85187-238">Log to a file or database.</span></span>
* <span data-ttu-id="85187-239">Podaj szczegóły, takie jak użytkownik, adres IP, nazwa poufnego punktu końcowego i inne.</span><span class="sxs-lookup"><span data-stu-id="85187-239">Include details such as the user, IP address, name of the sensitive endpoint, and more.</span></span>

<span data-ttu-id="85187-240">Metadane `AuditPolicyAttribute` zasad inspekcji jest `Attribute` zdefiniowany jako łatwiejsze do użytku z klasowych struktur, takich jak kontrolery i SignalR.</span><span class="sxs-lookup"><span data-stu-id="85187-240">The audit policy metadata `AuditPolicyAttribute` is defined as an `Attribute` for easier use with class-based frameworks such as controllers and SignalR.</span></span> <span data-ttu-id="85187-241">W przypadku *używania trasy do kodu:*</span><span class="sxs-lookup"><span data-stu-id="85187-241">When using *route to code*:</span></span>

* <span data-ttu-id="85187-242">Metadane są dołączone do interfejsu API konstruktora.</span><span class="sxs-lookup"><span data-stu-id="85187-242">Metadata is attached with a builder API.</span></span>
* <span data-ttu-id="85187-243">Struktury oparte na klasach zawierają wszystkie atrybuty odpowiedniej metody i klasy podczas tworzenia punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-243">Class-based frameworks include all attributes on the corresponding method and class when creating endpoints.</span></span>

<span data-ttu-id="85187-244">Najlepszym rozwiązaniem dla typów metadanych jest zdefiniowanie ich jako interfejsów lub atrybutów.</span><span class="sxs-lookup"><span data-stu-id="85187-244">The best practices for metadata types are to define them either as interfaces or attributes.</span></span> <span data-ttu-id="85187-245">Interfejsy i atrybuty umożliwiają ponowne użycie kodu.</span><span class="sxs-lookup"><span data-stu-id="85187-245">Interfaces and attributes allow code reuse.</span></span> <span data-ttu-id="85187-246">System metadanych jest elastyczny i nie nakłada żadnych ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="85187-246">The metadata system is flexible and doesn't impose any limitations.</span></span>

<a name="tm"></a>

### <a name="comparing-a-terminal-middleware-and-routing"></a><span data-ttu-id="85187-247">Porównywanie oprogramowania pośredniczącego terminala i routingu</span><span class="sxs-lookup"><span data-stu-id="85187-247">Comparing a terminal middleware and routing</span></span>

<span data-ttu-id="85187-248">Poniższy przykładowy kod kontrastuje przy użyciu oprogramowania pośredniczącego przy użyciu routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-248">The following code sample contrasts using middleware with using routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/TerminalMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="85187-249">Styl oprogramowania pośredniczącego pokazane z `Approach 1:` jest oprogramowanie **pośredniczące terminalu**.</span><span class="sxs-lookup"><span data-stu-id="85187-249">The style of middleware shown with `Approach 1:` is **terminal middleware**.</span></span> <span data-ttu-id="85187-250">Nazywa się oprogramowanie pośredniczące terminalu, ponieważ wykonuje pasujące działanie:</span><span class="sxs-lookup"><span data-stu-id="85187-250">It's called terminal middleware because it does a matching operation:</span></span>

* <span data-ttu-id="85187-251">Pasujące operacji w poprzednim `Path == "/"` przykładzie jest `Path == "/Movie"` dla oprogramowania pośredniczącego i routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-251">The matching operation in the preceding sample is `Path == "/"` for the middleware and `Path == "/Movie"` for routing.</span></span>
* <span data-ttu-id="85187-252">Gdy dopasowanie zakończy się pomyślnie, wykonuje niektóre funkcje i `next` zwraca, zamiast wywoływania oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-252">When a match is successful, it executes some functionality and returns, rather than invoking the `next` middleware.</span></span>

<span data-ttu-id="85187-253">Nazywa się oprogramowanie pośredniczące terminalu, ponieważ kończy wyszukiwanie, wykonuje niektóre funkcje, a następnie zwraca.</span><span class="sxs-lookup"><span data-stu-id="85187-253">It's called terminal middleware because it terminates the search, executes some functionality, and then returns.</span></span>

<span data-ttu-id="85187-254">Porównanie oprogramowania pośredniczącego terminala i routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-254">Comparing a terminal middleware and routing:</span></span>
* <span data-ttu-id="85187-255">Oba podejścia umożliwiają zakończenie potoku przetwarzania:</span><span class="sxs-lookup"><span data-stu-id="85187-255">Both approaches allow terminating the processing pipeline:</span></span>
    * <span data-ttu-id="85187-256">Oprogramowanie pośredniczące kończy potok przez zwrócenie, a nie wywoływanie `next`.</span><span class="sxs-lookup"><span data-stu-id="85187-256">Middleware terminates the pipeline by returning rather than invoking `next`.</span></span>
    * <span data-ttu-id="85187-257">Punkty końcowe są zawsze końcowe.</span><span class="sxs-lookup"><span data-stu-id="85187-257">Endpoints are always terminal.</span></span>
* <span data-ttu-id="85187-258">Oprogramowanie pośredniczące terminalu umożliwia pozycjonowanie oprogramowania pośredniczącego w dowolnym miejscu w potoku:</span><span class="sxs-lookup"><span data-stu-id="85187-258">Terminal middleware allows positioning the middleware at an arbitrary place in the pipeline:</span></span>
    * <span data-ttu-id="85187-259">Punkty końcowe są wykonywane <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>w pozycji .</span><span class="sxs-lookup"><span data-stu-id="85187-259">Endpoints execute at the position of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="85187-260">Oprogramowanie pośredniczące terminalu umożliwia dowolny kod, aby określić, kiedy oprogramowanie pośredniczące pasuje:</span><span class="sxs-lookup"><span data-stu-id="85187-260">Terminal middleware allows arbitrary code to determine when the middleware matches:</span></span>
    * <span data-ttu-id="85187-261">Niestandardowy kod dopasowania trasy może być pełny i trudny do poprawnego zapisu.</span><span class="sxs-lookup"><span data-stu-id="85187-261">Custom route matching code can be verbose and difficult to write correctly.</span></span>
    * <span data-ttu-id="85187-262">Routing zapewnia proste rozwiązania dla typowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-262">Routing provides straightforward solutions for typical apps.</span></span> <span data-ttu-id="85187-263">Większość aplikacji nie wymaga niestandardowego kodu dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-263">Most apps don't require custom route matching code.</span></span>
* <span data-ttu-id="85187-264">Interfejs punktów końcowych z oprogramowaniem pośredniczącym, takim jak `UseAuthorization` i `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="85187-264">Endpoints interface with middleware such as `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="85187-265">Korzystanie z oprogramowania `UseAuthorization` `UseCors` pośredniczącego terminala z systemem autoryzacji lub wymaga ręcznego połączenia z systemem autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-265">Using a terminal middleware with `UseAuthorization` or `UseCors` requires manual interfacing with the authorization system.</span></span>

<span data-ttu-id="85187-266">[Punkt końcowy](#endpoint) definiuje zarówno:</span><span class="sxs-lookup"><span data-stu-id="85187-266">An [endpoint](#endpoint) defines both:</span></span>

* <span data-ttu-id="85187-267">Pełnomocnik do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="85187-267">A delegate to process requests.</span></span>
* <span data-ttu-id="85187-268">Kolekcja dowolnych metadanych.</span><span class="sxs-lookup"><span data-stu-id="85187-268">A collection of arbitrary metadata.</span></span> <span data-ttu-id="85187-269">Metadane są używane do implementowania problemów przekrojowych na podstawie zasad i konfiguracji dołączonych do każdego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-269">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="85187-270">Oprogramowanie pośredniczące terminalu może być skutecznym narzędziem, ale może wymagać:</span><span class="sxs-lookup"><span data-stu-id="85187-270">Terminal middleware can be an effective tool, but can require:</span></span>

* <span data-ttu-id="85187-271">Znaczna ilość kodowania i testowania.</span><span class="sxs-lookup"><span data-stu-id="85187-271">A significant amount of coding and testing.</span></span>
* <span data-ttu-id="85187-272">Ręczna integracja z innymi systemami w celu osiągnięcia pożądanego poziomu elastyczności.</span><span class="sxs-lookup"><span data-stu-id="85187-272">Manual integration with other systems to achieve the desired level of flexibility.</span></span>

<span data-ttu-id="85187-273">Należy rozważyć integrację z routingu przed napisaniem oprogramowania pośredniczącego terminala.</span><span class="sxs-lookup"><span data-stu-id="85187-273">Consider integrating with routing before writing a terminal middleware.</span></span>

<span data-ttu-id="85187-274">Istniejące oprogramowanie pośredniczące terminalu, które integruje się z [mapą](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) lub <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> zwykle można przekształcić w punkt końcowy obsługujący routing.</span><span class="sxs-lookup"><span data-stu-id="85187-274">Existing terminal middleware that integrates with [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) or <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> can usually be turned into a routing aware endpoint.</span></span> <span data-ttu-id="85187-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) pokazuje wzorzec router-ware:</span><span class="sxs-lookup"><span data-stu-id="85187-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstrates the pattern for router-ware:</span></span>
* <span data-ttu-id="85187-276">Zapisz metodę rozszerzenia <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>na .</span><span class="sxs-lookup"><span data-stu-id="85187-276">Write an extension method on <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span>
* <span data-ttu-id="85187-277">Utwórz zagnieżdżony potok oprogramowania pośredniczącego przy użyciu programu <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span><span class="sxs-lookup"><span data-stu-id="85187-277">Create a nested middleware pipeline using <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span></span>
* <span data-ttu-id="85187-278">Dołącz oprogramowanie pośredniczące do nowego potoku.</span><span class="sxs-lookup"><span data-stu-id="85187-278">Attach the middleware to the new pipeline.</span></span> <span data-ttu-id="85187-279">W tym <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>przypadku .</span><span class="sxs-lookup"><span data-stu-id="85187-279">In this case, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span></span>
* <span data-ttu-id="85187-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*>potoku oprogramowania <xref:Microsoft.AspNetCore.Http.RequestDelegate>pośredniczącego do pliku .</span><span class="sxs-lookup"><span data-stu-id="85187-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> the middleware pipeline into a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span>
* <span data-ttu-id="85187-281">Wywołanie `Map` i udostępnij nowy potok oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-281">Call `Map` and provide the new middleware pipeline.</span></span>
* <span data-ttu-id="85187-282">Zwraca obiekt konstruktora dostarczony przez `Map` metodę rozszerzenia.</span><span class="sxs-lookup"><span data-stu-id="85187-282">Return the builder object provided by `Map` from the extension method.</span></span>

<span data-ttu-id="85187-283">Poniższy kod pokazuje korzystanie z [MapHealthChecks:](xref:host-and-deploy/health-checks)</span><span class="sxs-lookup"><span data-stu-id="85187-283">The following code shows use of [MapHealthChecks](xref:host-and-deploy/health-checks):</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

<span data-ttu-id="85187-284">W poprzednim przykładzie pokazano, dlaczego zwracanie obiektu konstruktora jest ważne.</span><span class="sxs-lookup"><span data-stu-id="85187-284">The preceding sample shows why returning the builder object is important.</span></span> <span data-ttu-id="85187-285">Zwracanie obiektu konstruktora umożliwia deweloperowi aplikacji skonfigurowanie zasad, takich jak autoryzacja dla punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-285">Returning the builder object allows the app developer to configure policies such as authorization for the endpoint.</span></span> <span data-ttu-id="85187-286">W tym przykładzie oprogramowanie pośredniczące kontroli kondycji nie ma bezpośredniej integracji z systemem autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-286">In this example, the health checks middleware has no direct integration with the authorization system.</span></span>

<span data-ttu-id="85187-287">System metadanych został utworzony w odpowiedzi na problemy napotkane przez autorów rozszerzalności przy użyciu oprogramowania pośredniczącego terminala.</span><span class="sxs-lookup"><span data-stu-id="85187-287">The metadata system was created in response to the problems encountered by extensibility authors using terminal middleware.</span></span> <span data-ttu-id="85187-288">Jest problematyczne dla każdego oprogramowania pośredniczącego do zaimplementowania własnej integracji z systemem autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-288">It's problematic for each middleware to implement its own integration with the authorization system.</span></span>

<a name="urlm"></a>

### <a name="url-matching"></a><span data-ttu-id="85187-289">Dopasowywanie adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-289">URL matching</span></span>

* <span data-ttu-id="85187-290">Jest procesem, w którym routing pasuje do żądania przychodzącego do [punktu końcowego](#endpoint).</span><span class="sxs-lookup"><span data-stu-id="85187-290">Is the process by which routing matches an incoming request to an [endpoint](#endpoint).</span></span>
* <span data-ttu-id="85187-291">Jest oparty na danych w ścieżce adresu URL i nagłówkach.</span><span class="sxs-lookup"><span data-stu-id="85187-291">Is based on data in the URL path and headers.</span></span>
* <span data-ttu-id="85187-292">Można rozszerzyć, aby uwzględnić wszelkie dane w żądaniu.</span><span class="sxs-lookup"><span data-stu-id="85187-292">Can be extended to consider any data in the request.</span></span>

<span data-ttu-id="85187-293">Podczas wykonywania oprogramowania pośredniczącego routingu ustawia `Endpoint` wartości i trasy do funkcji [żądania](xref:fundamentals/request-features) na <xref:Microsoft.AspNetCore.Http.HttpContext> z bieżącego żądania:</span><span class="sxs-lookup"><span data-stu-id="85187-293">When a routing middleware executes, it sets an `Endpoint` and route values to a [request feature](xref:fundamentals/request-features) on the <xref:Microsoft.AspNetCore.Http.HttpContext> from the current request:</span></span>

* <span data-ttu-id="85187-294">Wywołanie [httpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) pobiera punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="85187-294">Calling [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) gets the endpoint.</span></span>
* <span data-ttu-id="85187-295">`HttpRequest.RouteValues`pobiera kolekcję wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-295">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="85187-296">[Oprogramowanie pośredniczące](xref:fundamentals/middleware/index) uruchomione po oprogramowaniu pośredniczącym routingu może sprawdzić punkt końcowy i podjąć działania.</span><span class="sxs-lookup"><span data-stu-id="85187-296">[Middleware](xref:fundamentals/middleware/index) running after the routing middleware can inspect the endpoint and take action.</span></span> <span data-ttu-id="85187-297">Na przykład oprogramowanie pośredniczące autoryzacji może przesłuchiwać kolekcję metadanych punktu końcowego dla zasad autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="85187-297">For example, an authorization middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="85187-298">Po wykonaniu całego oprogramowania pośredniczącego w potoku przetwarzania żądań wywoływany jest delegat wybranego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-298">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="85187-299">System routingu w routingu punktu końcowego jest odpowiedzialny za wszystkie decyzje dotyczące wysyłki.</span><span class="sxs-lookup"><span data-stu-id="85187-299">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="85187-300">Ponieważ oprogramowanie pośredniczące stosuje zasady na podstawie wybranego punktu końcowego, ważne jest, aby:</span><span class="sxs-lookup"><span data-stu-id="85187-300">Because the middleware applies policies based on the selected endpoint, it's important that:</span></span>

* <span data-ttu-id="85187-301">Każda decyzja, która może mieć wpływ na wysyłkę lub stosowanie zasad zabezpieczeń, jest podejmowana wewnątrz systemu routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-301">Any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

> [!WARNING]
> <span data-ttu-id="85187-302">W przypadku zgodności z powrotem, gdy kontroler lub Razor Pages delegata punktu końcowego jest wykonywana, właściwości [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) są ustawione na odpowiednie wartości na podstawie przetwarzania żądań wykonywane do tej pory.</span><span class="sxs-lookup"><span data-stu-id="85187-302">For backwards-compatibility, when a Controller or Razor Pages endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>
>
> <span data-ttu-id="85187-303">Typ `RouteContext` zostanie oznaczony jako przestarzały w przyszłej wersji:</span><span class="sxs-lookup"><span data-stu-id="85187-303">The `RouteContext` type will be marked obsolete in a future release:</span></span>
>
> * <span data-ttu-id="85187-304">`RouteData.Values` Migrowanie `HttpRequest.RouteValues`do pliku .</span><span class="sxs-lookup"><span data-stu-id="85187-304">Migrate `RouteData.Values` to `HttpRequest.RouteValues`.</span></span>
> * <span data-ttu-id="85187-305">Migruj, `RouteData.DataTokens` aby pobrać [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) z metadanych punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-305">Migrate `RouteData.DataTokens` to retrieve [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) from the endpoint metadata.</span></span>

<span data-ttu-id="85187-306">Dopasowywanie adresów URL działa w konfigurowalnym zestawie faz.</span><span class="sxs-lookup"><span data-stu-id="85187-306">URL matching operates in a configurable set of phases.</span></span> <span data-ttu-id="85187-307">W każdej fazie dane wyjściowe są zestawem dopasowań.</span><span class="sxs-lookup"><span data-stu-id="85187-307">In each phase, the output is a set of matches.</span></span> <span data-ttu-id="85187-308">Zestaw meczów można zawęzić do następnej fazy.</span><span class="sxs-lookup"><span data-stu-id="85187-308">The set of matches can be narrowed down further by the next phase.</span></span> <span data-ttu-id="85187-309">Implementacja routingu nie gwarantuje kolejność przetwarzania dla pasujących punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-309">The routing implementation does not guarantee a processing order for matching endpoints.</span></span> <span data-ttu-id="85187-310">**Wszystkie** możliwe dopasowania są przetwarzane jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="85187-310">**All** possible matches are processed at once.</span></span> <span data-ttu-id="85187-311">Fazy dopasowywania adresów URL występują w następującej kolejności.</span><span class="sxs-lookup"><span data-stu-id="85187-311">The URL matching phases occur in the following order.</span></span> <span data-ttu-id="85187-312">ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="85187-312">ASP.NET Core:</span></span>

1. <span data-ttu-id="85187-313">Przetwarza ścieżkę adresu URL względem zestawu punktów końcowych i ich szablonów tras, zbierając **wszystkie** dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-313">Processes the URL path against the set of endpoints and their route templates, collecting **all** of the matches.</span></span>
1. <span data-ttu-id="85187-314">Przyjmuje poprzednią listę i usuwa dopasowania, które nie powiodą się z zastosowanymi ograniczeniami trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-314">Takes the preceding list and removes matches that fail with route constraints applied.</span></span>
1. <span data-ttu-id="85187-315">Przyjmuje poprzednią listę i usuwa dopasowania, które nie powiedzie się zestaw [matcherpolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) wystąpień.</span><span class="sxs-lookup"><span data-stu-id="85187-315">Takes the preceding list and removes matches that fail the set of [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) instances.</span></span>
1. <span data-ttu-id="85187-316">Używa [endpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) do podjęcia ostatecznej decyzji z poprzedniej listy.</span><span class="sxs-lookup"><span data-stu-id="85187-316">Uses the [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) to make a final decision from the preceding list.</span></span>

<span data-ttu-id="85187-317">Lista punktów końcowych jest traktowana priorytetowo zgodnie z:</span><span class="sxs-lookup"><span data-stu-id="85187-317">The list of endpoints is prioritized according to:</span></span>

* <span data-ttu-id="85187-318">[RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span><span class="sxs-lookup"><span data-stu-id="85187-318">The [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span></span>
* <span data-ttu-id="85187-319">[Pierwszeństwo szablonu trasy](#rtp)</span><span class="sxs-lookup"><span data-stu-id="85187-319">The [route template precedence](#rtp)</span></span>

<span data-ttu-id="85187-320">Wszystkie pasujące punkty końcowe są przetwarzane <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> w każdej fazie, aż do osiągnięcia.</span><span class="sxs-lookup"><span data-stu-id="85187-320">All matching endpoints are processed in each phase until the <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> is reached.</span></span> <span data-ttu-id="85187-321">Jest `EndpointSelector` to faza końcowa.</span><span class="sxs-lookup"><span data-stu-id="85187-321">The `EndpointSelector` is the final phase.</span></span> <span data-ttu-id="85187-322">Wybiera punkt końcowy o najwyższym priorytecie z dopasowań jako najlepsze dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-322">It chooses the highest priority endpoint from the matches as the best match.</span></span> <span data-ttu-id="85187-323">Jeśli istnieją inne mecze o tym samym priorytecie co najlepsze dopasowanie, zgłaszany jest niejednoznaczny wyjątek dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-323">If there are other matches with the same priority as the best match, an ambiguous match exception is thrown.</span></span>

<span data-ttu-id="85187-324">Pierwszeństwo trasy jest obliczane na podstawie **bardziej szczegółowego** szablonu trasy, który ma wyższy priorytet.</span><span class="sxs-lookup"><span data-stu-id="85187-324">The route precedence is computed based on a **more specific** route template being given a higher priority.</span></span> <span data-ttu-id="85187-325">Rozważmy na przykład `/hello` szablony i: `/{message}`</span><span class="sxs-lookup"><span data-stu-id="85187-325">For example, consider the templates `/hello` and `/{message}`:</span></span>

* <span data-ttu-id="85187-326">Oba są zgodne `/hello`ze ścieżką adresu URL .</span><span class="sxs-lookup"><span data-stu-id="85187-326">Both match the URL path `/hello`.</span></span>
* <span data-ttu-id="85187-327">`/hello`jest bardziej szczegółowa, a zatem wyższy priorytet.</span><span class="sxs-lookup"><span data-stu-id="85187-327">`/hello`  is more specific and therefore higher priority.</span></span>

<span data-ttu-id="85187-328">Ogólnie rzecz biorąc pierwszeństwo trasy ma dobrą robotę, wybierając najlepsze dopasowanie dla rodzajów schematów adresów URL używanych w praktyce.</span><span class="sxs-lookup"><span data-stu-id="85187-328">In general, route precedence does a good job of choosing the best match for the kinds of URL schemes used in practice.</span></span> <span data-ttu-id="85187-329">Używaj <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> tylko wtedy, gdy jest to konieczne, aby uniknąć niejednoznaczności.</span><span class="sxs-lookup"><span data-stu-id="85187-329">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> only when necessary to avoid an ambiguity.</span></span>

<span data-ttu-id="85187-330">Ze względu na rodzaje rozszerzalności zapewniane przez routing, nie jest możliwe dla systemu routingu do obliczania z wyprzedzeniem niejednoznaczne trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-330">Due to the kinds of extensibility provided by routing, it isn't possible for the routing system to compute ahead of time the ambiguous routes.</span></span> <span data-ttu-id="85187-331">Rozważmy przykład, taki jak `/{message:alpha}` `/{message:int}`szablony tras i:</span><span class="sxs-lookup"><span data-stu-id="85187-331">Consider an example such as the route templates `/{message:alpha}` and `/{message:int}`:</span></span>

* <span data-ttu-id="85187-332">Ograniczenie `alpha` jest zgodne tylko z znakami alfabetycznymi.</span><span class="sxs-lookup"><span data-stu-id="85187-332">The `alpha` constraint matches only alphabetic characters.</span></span>
* <span data-ttu-id="85187-333">Ograniczenie `int` jest zgodne tylko z liczbami.</span><span class="sxs-lookup"><span data-stu-id="85187-333">The `int` constraint matches only numbers.</span></span>
* <span data-ttu-id="85187-334">Te szablony mają ten sam priorytet trasy, ale nie ma jednego adresu URL, który są zgodne.</span><span class="sxs-lookup"><span data-stu-id="85187-334">These templates have the same route precedence, but there's no single URL they both match.</span></span>
* <span data-ttu-id="85187-335">Jeśli system routingu zgłosił błąd niejednoznaczności podczas uruchamiania, zablokuje ten prawidłowy przypadek użycia.</span><span class="sxs-lookup"><span data-stu-id="85187-335">If the routing system reported an ambiguity error at startup, it would block this valid use case.</span></span>

> [!WARNING]
>
> <span data-ttu-id="85187-336">Kolejność operacji wewnątrz <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> nie wpływa na zachowanie routingu, z jednym wyjątkiem.</span><span class="sxs-lookup"><span data-stu-id="85187-336">The order of operations inside <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> doesn't influence the behavior of routing, with one exception.</span></span> <span data-ttu-id="85187-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*>i <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatycznie przypisać wartość zamówienia do swoich punktów końcowych na podstawie kolejności, w jakiej są wywoływane.</span><span class="sxs-lookup"><span data-stu-id="85187-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> and <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatically assign an order value to their endpoints based on the order they are invoked.</span></span> <span data-ttu-id="85187-338">Symuluje to długotrwałe zachowanie kontrolerów bez systemu routingu, zapewniając takie same gwarancje jak starsze implementacje routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-338">This simulates long-time behavior of controllers without the routing system providing the same guarantees as older routing implementations.</span></span>
>
> <span data-ttu-id="85187-339">W starszej implementacji routingu jest możliwe do zaimplementowania rozszerzalności routingu, który ma zależność od kolejności, w której trasy są przetwarzane.</span><span class="sxs-lookup"><span data-stu-id="85187-339">In the legacy implementation of routing, it's possible to implement routing extensibility that has a dependency on the order in which routes are processed.</span></span> <span data-ttu-id="85187-340">Routing punktu końcowego w ASP.NET Core 3.0 i nowszych:</span><span class="sxs-lookup"><span data-stu-id="85187-340">Endpoint routing in ASP.NET Core 3.0 and later:</span></span>
> 
> * <span data-ttu-id="85187-341">Nie ma pojęcia tras.</span><span class="sxs-lookup"><span data-stu-id="85187-341">Doesn't have a concept of routes.</span></span>
> * <span data-ttu-id="85187-342">Nie zapewnia gwarancji zamawiania.</span><span class="sxs-lookup"><span data-stu-id="85187-342">Doesn't provide ordering guarantees.</span></span> <span data-ttu-id="85187-343">Wszystkie punkty końcowe są przetwarzane jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="85187-343">All endpoints are processed at once.</span></span>
>
> <span data-ttu-id="85187-344">Jeśli oznacza to, że utkniesz przy użyciu starszego systemu routingu, [otwórz problem z githubem, aby uzyskać pomoc.](https://github.com/dotnet/aspnetcore/issues)</span><span class="sxs-lookup"><span data-stu-id="85187-344">If this means you're stuck using the legacy routing system, [open a GitHub issue for assistance](https://github.com/dotnet/aspnetcore/issues).</span></span>

<a name="rtp"></a>

### <a name="route-template-precedence-and-endpoint-selection-order"></a><span data-ttu-id="85187-345">Pierwszeństwo szablonu marszruty i kolejność wyboru punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="85187-345">Route template precedence and endpoint selection order</span></span>

<span data-ttu-id="85187-346">[Pierwszeństwo szablonu trasy](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) to system, który przypisuje każdemu szablonowi trasy wartość na podstawie jego specyfiki.</span><span class="sxs-lookup"><span data-stu-id="85187-346">[Route template precedence](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) is a system that assigns each route template a value based on how specific it is.</span></span> <span data-ttu-id="85187-347">Pierwszeństwo szablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-347">Route template precedence:</span></span>

* <span data-ttu-id="85187-348">Pozwala uniknąć konieczności dostosowywania kolejności punktów końcowych w typowych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="85187-348">Avoids the need to adjust the order of endpoints in common cases.</span></span>
* <span data-ttu-id="85187-349">Próbuje dopasować oczekiwania zdrowego rozsądku zachowania routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-349">Attempts to match the common-sense expectations of routing behavior.</span></span>

<span data-ttu-id="85187-350">Rozważmy na przykład `/Products/List` `/Products/{id}`szablony i .</span><span class="sxs-lookup"><span data-stu-id="85187-350">For example, consider templates `/Products/List` and `/Products/{id}`.</span></span> <span data-ttu-id="85187-351">Byłoby rozsądne, aby `/Products/List` założyć, że `/Products/{id}` jest lepsze `/Products/List`dopasowanie niż dla ścieżki adresu URL .</span><span class="sxs-lookup"><span data-stu-id="85187-351">It would be reasonable to assume that `/Products/List` is a better match than `/Products/{id}` for the URL path `/Products/List`.</span></span> <span data-ttu-id="85187-352">Działa, ponieważ segment `/List` dosłowny jest uważany za `/{id}`lepszy niż segment parametru .</span><span class="sxs-lookup"><span data-stu-id="85187-352">The works because the literal segment `/List` is considered to have better precedence than the parameter segment `/{id}`.</span></span>

<span data-ttu-id="85187-353">Szczegóły dotyczące funkcjonowania pierwszeństwa są powiązane ze sposobu definiowania szablonów tras:</span><span class="sxs-lookup"><span data-stu-id="85187-353">The details of how precedence works are coupled to how route templates are defined:</span></span>

* <span data-ttu-id="85187-354">Szablony z większą liczesz segmentami są uważane za bardziej szczegółowe.</span><span class="sxs-lookup"><span data-stu-id="85187-354">Templates with more segments are considered more specific.</span></span>
* <span data-ttu-id="85187-355">Segment z tekstem dosłownym jest uważany za bardziej specyficzny niż segment parametrów.</span><span class="sxs-lookup"><span data-stu-id="85187-355">A segment with literal text is considered more specific than a parameter segment.</span></span>
* <span data-ttu-id="85187-356">Segment parametrów z ograniczeniem jest uważany za bardziej szczegółowy niż jeden bez.</span><span class="sxs-lookup"><span data-stu-id="85187-356">A parameter segment with a constraint is considered more specific than one without.</span></span>
* <span data-ttu-id="85187-357">Segment złożony jest uważany za specyficzny jako segment parametrów z ograniczeniem.</span><span class="sxs-lookup"><span data-stu-id="85187-357">A complex segment is considered as specific as a parameter segment with a constraint.</span></span>
* <span data-ttu-id="85187-358">Catch wszystkie parametry są najmniej specyficzne.</span><span class="sxs-lookup"><span data-stu-id="85187-358">Catch all parameters are the least specific.</span></span>

<span data-ttu-id="85187-359">Zobacz [kod źródłowy w usłudze GitHub,](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) aby uzyskać odwołanie do dokładnych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-359">See the [source code on GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) for a reference of exact values.</span></span>

<a name="lg"></a>

### <a name="url-generation-concepts"></a><span data-ttu-id="85187-360">Pojęcia generowania adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-360">URL generation concepts</span></span>

<span data-ttu-id="85187-361">Generowanie adresu URL:</span><span class="sxs-lookup"><span data-stu-id="85187-361">URL generation:</span></span>

* <span data-ttu-id="85187-362">Jest to proces, w którym routing może utworzyć ścieżkę adresu URL na podstawie zestawu wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-362">Is the process by which routing can create a URL path based on a set of route values.</span></span>
* <span data-ttu-id="85187-363">Umożliwia logiczne oddzielenie między punktami końcowymi i adresami URL, które do nich uzyskują dostęp.</span><span class="sxs-lookup"><span data-stu-id="85187-363">Allows for a logical separation between endpoints and the URLs that access them.</span></span>

<span data-ttu-id="85187-364">Routing punktu końcowego obejmuje interfejs <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span><span class="sxs-lookup"><span data-stu-id="85187-364">Endpoint routing includes the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span></span> <span data-ttu-id="85187-365">`LinkGenerator`jest usługą singleton dostępną w [DI.](xref:fundamentals/dependency-injection)</span><span class="sxs-lookup"><span data-stu-id="85187-365">`LinkGenerator` is a singleton service available from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="85187-366">Interfejs `LinkGenerator` API może służyć poza kontekstem żądania wykonywania.</span><span class="sxs-lookup"><span data-stu-id="85187-366">The `LinkGenerator` API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="85187-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) i scenariusze, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>na których opierają się , takie jak [Pomocnicy tagów,](xref:mvc/views/tag-helpers/intro)Pomocnicy HTML i [Wyniki akcji,](xref:mvc/controllers/actions)używają `LinkGenerator` interfejsu API wewnętrznie, aby zapewnić możliwości generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the `LinkGenerator` API internally to provide link generating capabilities.</span></span>

<span data-ttu-id="85187-368">Generator łączy jest wspierany przez koncepcję systemów **adresów** i **adresów**.</span><span class="sxs-lookup"><span data-stu-id="85187-368">The link generator is backed by the concept of an **address** and **address schemes**.</span></span> <span data-ttu-id="85187-369">Schemat adresów jest sposobem określania punktów końcowych, które powinny być brane pod uwagę dla generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-369">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="85187-370">Na przykład scenariusze wartości nazwy trasy i trasy, które wielu użytkowników zna z kontrolerów, a strony Razor są implementowane jako schemat adresów.</span><span class="sxs-lookup"><span data-stu-id="85187-370">For example, the route name and route values scenarios many users are familiar with from controllers and Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="85187-371">Generator łączy może łączyć się z kontrolerami i stronami razor za pomocą następujących metod rozszerzenia:</span><span class="sxs-lookup"><span data-stu-id="85187-371">The link generator can link to controllers and Razor Pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="85187-372">Przeciążenia tych metod akceptują `HttpContext`argumenty, które obejmują .</span><span class="sxs-lookup"><span data-stu-id="85187-372">Overloads of these methods accept arguments that include the `HttpContext`.</span></span> <span data-ttu-id="85187-373">Metody te są funkcjonalnie równoważne [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) i [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), ale oferują dodatkową elastyczność i opcje.</span><span class="sxs-lookup"><span data-stu-id="85187-373">These methods are functionally equivalent to [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) and [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), but offer additional flexibility and options.</span></span>

<span data-ttu-id="85187-374">Metody `GetPath*` są najbardziej `Url.Action` podobne `Url.Page`do i , w tym generują identyfikator URI zawierający ścieżkę bezwzględną.</span><span class="sxs-lookup"><span data-stu-id="85187-374">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page`, in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="85187-375">Metody `GetUri*` zawsze generują bezwzględny identyfikator URI zawierający schemat i host.</span><span class="sxs-lookup"><span data-stu-id="85187-375">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="85187-376">Metody, które `HttpContext` akceptują generowanie identyfikatora URI w kontekście żądania wykonywania.</span><span class="sxs-lookup"><span data-stu-id="85187-376">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="85187-377">Wartości trasy [otoczenia,](#ambient) ścieżka bazowa adresu URL, schemat i host z żądania wykonywania są używane, chyba że zostaną zastąpione.</span><span class="sxs-lookup"><span data-stu-id="85187-377">The [ambient](#ambient) route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="85187-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator>nazywa się z adresem.</span><span class="sxs-lookup"><span data-stu-id="85187-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="85187-379">Generowanie identyfikatora URI odbywa się w dwóch etapach:</span><span class="sxs-lookup"><span data-stu-id="85187-379">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="85187-380">Adres jest powiązany z listą punktów końcowych, które pasują do adresu.</span><span class="sxs-lookup"><span data-stu-id="85187-380">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="85187-381">Każdy punkt końcowy <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> jest obliczany, dopóki nie zostanie znaleziony wzorzec trasy, który pasuje do podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-381">Each endpoint's <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="85187-382">Wynikowe wyjście jest łączone z innymi częściami URI dostarczonymi do generatora łączy i zwróconymi.</span><span class="sxs-lookup"><span data-stu-id="85187-382">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="85187-383">Metody zapewniane <xref:Microsoft.AspNetCore.Routing.LinkGenerator> przez obsługę standardowych możliwości generowania łączy dla dowolnego typu adresu.</span><span class="sxs-lookup"><span data-stu-id="85187-383">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="85187-384">Najwygodniejszym sposobem użycia generatora łączy są metody rozszerzenia, które wykonują operacje dla określonego typu adresu:</span><span class="sxs-lookup"><span data-stu-id="85187-384">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type:</span></span>

| <span data-ttu-id="85187-385">Metoda rozszerzenia</span><span class="sxs-lookup"><span data-stu-id="85187-385">Extension Method</span></span> | <span data-ttu-id="85187-386">Opis</span><span class="sxs-lookup"><span data-stu-id="85187-386">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="85187-387">Generuje identyfikator URI ze ścieżką bezwzględną na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-387">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="85187-388">Generuje bezwzględny identyfikator URI na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-388">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="85187-389">Należy zwrócić uwagę na następujące <xref:Microsoft.AspNetCore.Routing.LinkGenerator> implikacje metod wywoływania:</span><span class="sxs-lookup"><span data-stu-id="85187-389">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="85187-390">Użyj `GetUri*` metod rozszerzenia z ostrożnością w konfiguracji aplikacji, która nie sprawdza poprawności `Host` nagłówka żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="85187-390">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="85187-391">Jeśli `Host` nagłówek żądań przychodzących nie jest zweryfikowany, niezaufane dane wejściowe żądania mogą być wysyłane z powrotem do klienta w identyfikatorach URI w widoku lub na stronie.</span><span class="sxs-lookup"><span data-stu-id="85187-391">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view or page.</span></span> <span data-ttu-id="85187-392">Zaleca się, aby wszystkie aplikacje produkcyjne `Host` skonfigurować swój serwer, aby sprawdzić poprawność nagłówka względem znanych prawidłowych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-392">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="85187-393">Należy <xref:Microsoft.AspNetCore.Routing.LinkGenerator> zachować ostrożność w `Map` oprogramowaniu pośredniczącym w połączeniu z programem lub . `MapWhen`</span><span class="sxs-lookup"><span data-stu-id="85187-393">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="85187-394">`Map*`zmienia ścieżkę podstawową żądania wykonywania, co wpływa na dane wyjściowe generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-394">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="85187-395">Wszystkie interfejsy <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API umożliwiają określanie ścieżki podstawowej.</span><span class="sxs-lookup"><span data-stu-id="85187-395">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="85187-396">Określ pustą ścieżkę `Map*` podstawową, aby cofnąć wpływ na generowanie łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-396">Specify an empty base path to undo the `Map*` affect on link generation.</span></span>

### <a name="middleware-example"></a><span data-ttu-id="85187-397">Przykład oprogramowania pośredniczącego</span><span class="sxs-lookup"><span data-stu-id="85187-397">Middleware example</span></span>

<span data-ttu-id="85187-398">W poniższym przykładzie oprogramowanie pośredniczące używa <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejsu API do utworzenia łącza do metody akcji, która zawiera listę produktów magazynu.</span><span class="sxs-lookup"><span data-stu-id="85187-398">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create a link to an action method that lists store products.</span></span> <span data-ttu-id="85187-399">Korzystanie z generatora łączy przez wstrzyknięcie `GenerateLink` go do klasy i wywołanie jest dostępna dla każdej klasy w aplikacji:</span><span class="sxs-lookup"><span data-stu-id="85187-399">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Middleware/ProductsLinkMiddleware.cs?name=snippet)]

<a name="rtr"></a>

## <a name="route-template-reference"></a><span data-ttu-id="85187-400">Odwołanie do szablonu trasy</span><span class="sxs-lookup"><span data-stu-id="85187-400">Route template reference</span></span>

<span data-ttu-id="85187-401">Tokeny `{}` w ramach definiowania parametrów trasy, które są powiązane, jeśli trasa jest dopasowana.</span><span class="sxs-lookup"><span data-stu-id="85187-401">Tokens within `{}` define route parameters that are bound if the route is matched.</span></span> <span data-ttu-id="85187-402">W segmencie trasy można zdefiniować więcej niż jeden parametr trasy, ale parametry trasy muszą być oddzielone wartością literału.</span><span class="sxs-lookup"><span data-stu-id="85187-402">More than one route parameter can be defined in a route segment, but route parameters  must be separated by a literal value.</span></span> <span data-ttu-id="85187-403">Na przykład `{controller=Home}{action=Index}` nie jest prawidłową trasą, ponieważ nie `{controller}` ma `{action}`wartości literału między i .</span><span class="sxs-lookup"><span data-stu-id="85187-403">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span>  <span data-ttu-id="85187-404">Parametry trasy muszą mieć nazwę i mogą mieć określone dodatkowe atrybuty.</span><span class="sxs-lookup"><span data-stu-id="85187-404">Route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="85187-405">Tekst dosłowny inny niż `{id}`parametry trasy (na `/` przykład) i separator ścieżki muszą być zgodne z tekstem w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="85187-405">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="85187-406">Dopasowanie tekstu jest niewrażliwe na rozmiary i opiera się na zdekodowanym reprezentacji ścieżki adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-406">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="85187-407">Aby dopasować dosłowny `{` parametr `}`trasy ogranicznik lub , uciec ogranicznika, powtarzając znak.</span><span class="sxs-lookup"><span data-stu-id="85187-407">To match a literal route parameter delimiter `{` or `}`, escape the delimiter by repeating the character.</span></span> <span data-ttu-id="85187-408">Na `{{` przykład `}}`lub .</span><span class="sxs-lookup"><span data-stu-id="85187-408">For example `{{` or `}}`.</span></span>

<span data-ttu-id="85187-409">Gwiazdka `*` lub podwójna `**`gwiazdka:</span><span class="sxs-lookup"><span data-stu-id="85187-409">Asterisk `*` or double asterisk `**`:</span></span>

* <span data-ttu-id="85187-410">Może służyć jako prefiks do parametru trasy do powiązania z resztą identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="85187-410">Can be used as a prefix to a route parameter to bind to the rest of the URI.</span></span>
* <span data-ttu-id="85187-411">Są nazywane **catch-all** parametrów.</span><span class="sxs-lookup"><span data-stu-id="85187-411">Are called a **catch-all** parameters.</span></span> <span data-ttu-id="85187-412">Na przykład: `blog/{**slug}`</span><span class="sxs-lookup"><span data-stu-id="85187-412">For example, `blog/{**slug}`:</span></span>
  * <span data-ttu-id="85187-413">Dopasowuje dowolny identyfikator `/blog` URI, który rozpoczyna się od i ma dowolną wartość po nim.</span><span class="sxs-lookup"><span data-stu-id="85187-413">Matches any URI that starts with `/blog` and has any value following it.</span></span>
  * <span data-ttu-id="85187-414">Następująca `/blog` wartość jest przypisywana do wartości trasy [ślimaka.](https://developer.mozilla.org/docs/Glossary/Slug)</span><span class="sxs-lookup"><span data-stu-id="85187-414">The value following `/blog` is assigned to the [slug](https://developer.mozilla.org/docs/Glossary/Slug) route value.</span></span>

<span data-ttu-id="85187-415">Catch-all parametry mogą również odpowiadać pusty ciąg.</span><span class="sxs-lookup"><span data-stu-id="85187-415">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="85187-416">Parametr catch-all unika odpowiednich znaków, gdy trasa jest używana do generowania adresu URL, w tym znaków separatora `/` ścieżki.</span><span class="sxs-lookup"><span data-stu-id="85187-416">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator `/` characters.</span></span> <span data-ttu-id="85187-417">Na przykład trasa `foo/{*path}` z `{ path = "my/path" }` wartościami `foo/my%2Fpath`trasy generuje .</span><span class="sxs-lookup"><span data-stu-id="85187-417">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="85187-418">Zwróć uwagę na ukucie do przodu.</span><span class="sxs-lookup"><span data-stu-id="85187-418">Note the escaped forward slash.</span></span> <span data-ttu-id="85187-419">Aby znaki separatora ścieżki w `**` obie strony, należy użyć prefiksu parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-419">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="85187-420">Trasa `foo/{**path}` z `{ path = "my/path" }` generuje `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="85187-420">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="85187-421">Wzorce adresów URL, które próbują przechwycić nazwę pliku z opcjonalnym rozszerzeniem pliku, mają dodatkowe uwagi.</span><span class="sxs-lookup"><span data-stu-id="85187-421">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="85187-422">Rozważmy na przykład `files/{filename}.{ext?}`szablon .</span><span class="sxs-lookup"><span data-stu-id="85187-422">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="85187-423">Gdy wartości `filename` dla `ext` obu i istnieją, obie wartości są wypełniane.</span><span class="sxs-lookup"><span data-stu-id="85187-423">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="85187-424">Jeśli w adresie URL `filename` istnieje tylko wartość, trasa `.` jest zgodna, ponieważ końcowe jest opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="85187-424">If only a value for `filename` exists in the URL, the route matches because the trailing `.` is  optional.</span></span> <span data-ttu-id="85187-425">Następujące adresy URL są zgodne z tą trasą:</span><span class="sxs-lookup"><span data-stu-id="85187-425">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="85187-426">Parametry trasy mogą mieć **wartości domyślne** wyznaczone przez określenie wartości domyślnej po`=`nazwie parametru oddzielonej znakiem równości ( ).</span><span class="sxs-lookup"><span data-stu-id="85187-426">Route parameters may have **default values** designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="85187-427">Na przykład `{controller=Home}` definiuje `Home` jako wartość `controller`domyślną dla .</span><span class="sxs-lookup"><span data-stu-id="85187-427">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="85187-428">Wartość domyślna jest używana, jeśli w adresie URL parametru nie ma żadnej wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-428">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="85187-429">Parametry trasy są opcjonalne przez dołączenie`?`znaku zapytania ( ) na końcu nazwy parametru.</span><span class="sxs-lookup"><span data-stu-id="85187-429">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name.</span></span> <span data-ttu-id="85187-430">Na przykład `id?`.</span><span class="sxs-lookup"><span data-stu-id="85187-430">For example, `id?`.</span></span> <span data-ttu-id="85187-431">Różnica między wartościami opcjonalnymi a domyślnymi parametrami trasy wynosi:</span><span class="sxs-lookup"><span data-stu-id="85187-431">The difference between optional values and default route parameters is:</span></span>

* <span data-ttu-id="85187-432">Parametr trasy z wartością domyślną zawsze generuje wartość.</span><span class="sxs-lookup"><span data-stu-id="85187-432">A route parameter with a default value always produces a value.</span></span>
* <span data-ttu-id="85187-433">Parametr opcjonalny ma wartość tylko wtedy, gdy wartość jest dostarczana przez adres URL żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-433">An optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="85187-434">Parametry trasy mogą mieć ograniczenia, które muszą odpowiadać wartości trasy powiązanej z adresem URL.</span><span class="sxs-lookup"><span data-stu-id="85187-434">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="85187-435">Dodanie `:` i nazwa ograniczenia po nazwie parametru trasy określa ograniczenie wbudowane dla parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-435">Adding `:` and constraint name after the route parameter name specifies an inline constraint on a route parameter.</span></span> <span data-ttu-id="85187-436">Jeśli ograniczenie wymaga argumentów, są one ujęte w nawiasy `(...)` po nazwie ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-436">If the constraint requires arguments, they're enclosed in parentheses `(...)` after the constraint name.</span></span> <span data-ttu-id="85187-437">Wiele *ograniczeń wbudowanych* można określić, `:` dołączając inną nazwę i nazwę ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-437">Multiple *inline constraints* can be specified by appending another `:` and constraint name.</span></span>

<span data-ttu-id="85187-438">Nazwa ograniczenia i argumenty są <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> przekazywane do usługi, aby utworzyć wystąpienie do użycia w przetwarzaniu adresów <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> URL.</span><span class="sxs-lookup"><span data-stu-id="85187-438">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="85187-439">Na przykład szablon `blog/{article:minlength(10)}` trasy określa `minlength` ograniczenie z `10`argumentem .</span><span class="sxs-lookup"><span data-stu-id="85187-439">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="85187-440">Aby uzyskać więcej informacji na temat ograniczeń trasy i listy ograniczeń przewidzianych przez strukturę, zobacz [sekcja Odwołanie do ograniczenia trasy.](#route-constraint-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-440">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="85187-441">Parametry trasy mogą również mieć transformatory parametrów.</span><span class="sxs-lookup"><span data-stu-id="85187-441">Route parameters may also have parameter transformers.</span></span> <span data-ttu-id="85187-442">Transformatory parametrów przekształcają wartość parametru podczas generowania łączy i dopasowywania akcji i stron do adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-442">Parameter transformers transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="85187-443">Podobnie jak wiązania, transformatory parametrów można dodać w `:` linii do parametru trasy, dodając nazwę a i transformatora po nazwie parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-443">Like constraints, parameter transformers can be added inline to a route parameter by adding a `:` and transformer name after the route parameter name.</span></span> <span data-ttu-id="85187-444">Na przykład szablon `blog/{article:slugify}` trasy określa `slugify` transformator.</span><span class="sxs-lookup"><span data-stu-id="85187-444">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="85187-445">Aby uzyskać więcej informacji na temat transformatorów parametrów, zobacz [sekcję Odwołanie do transformatora parametrów.](#parameter-transformer-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-445">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="85187-446">W poniższej tabeli przedstawiono przykładowe szablony tras i ich zachowanie:</span><span class="sxs-lookup"><span data-stu-id="85187-446">The following table demonstrates example route templates and their behavior:</span></span>

| <span data-ttu-id="85187-447">Szablon trasy</span><span class="sxs-lookup"><span data-stu-id="85187-447">Route Template</span></span>                           | <span data-ttu-id="85187-448">Przykładowy pasujący identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="85187-448">Example Matching URI</span></span>    | <span data-ttu-id="85187-449">Identyfikator URI żądania&hellip;</span><span class="sxs-lookup"><span data-stu-id="85187-449">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="85187-450">Pasuje tylko do `/hello`pojedynczej ścieżki .</span><span class="sxs-lookup"><span data-stu-id="85187-450">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="85187-451">Dopasowuje `Page` `Home`i ustawia na .</span><span class="sxs-lookup"><span data-stu-id="85187-451">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="85187-452">Dopasowuje `Page` `Contact`i ustawia na .</span><span class="sxs-lookup"><span data-stu-id="85187-452">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="85187-453">Mapy do `Products` kontrolera i `List` akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-453">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="85187-454">Mapy do `Products` kontrolera `Details` `id` i akcji z zestawem 123.</span><span class="sxs-lookup"><span data-stu-id="85187-454">Maps to the `Products` controller and  `Details` action with`id` set to 123.</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="85187-455">Mapy do `Home` kontrolera i `Index` metody.</span><span class="sxs-lookup"><span data-stu-id="85187-455">Maps to the `Home` controller and `Index` method.</span></span> <span data-ttu-id="85187-456">Parametr `id` jest ignorowany.</span><span class="sxs-lookup"><span data-stu-id="85187-456">`id` is ignored.</span></span>        |
| `{controller=Home}/{action=Index}/{id?}` | `/Products`         | <span data-ttu-id="85187-457">Mapy do `Products` kontrolera i `Index` metody.</span><span class="sxs-lookup"><span data-stu-id="85187-457">Maps to the `Products` controller and `Index` method.</span></span> <span data-ttu-id="85187-458">Parametr `id` jest ignorowany.</span><span class="sxs-lookup"><span data-stu-id="85187-458">`id` is ignored.</span></span>        |

<span data-ttu-id="85187-459">Korzystanie z szablonu jest zazwyczaj najprostszym podejściem do routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-459">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="85187-460">Ograniczenia i wartości domyślne można również określić poza szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-460">Constraints and defaults can also be specified outside the route template.</span></span>

### <a name="complex-segments"></a><span data-ttu-id="85187-461">Segmenty złożone</span><span class="sxs-lookup"><span data-stu-id="85187-461">Complex segments</span></span>

<span data-ttu-id="85187-462">Złożone segmenty są przetwarzane przez dopasowanie do literału ograniczników od prawej do lewej w sposób [niechciwy.](#greedy)</span><span class="sxs-lookup"><span data-stu-id="85187-462">Complex segments are processed by matching up literal delimiters from right to left in a [non-greedy](#greedy) way.</span></span> <span data-ttu-id="85187-463">Na przykład `[Route("/a{b}c{d}")]` jest segmentem złożonym.</span><span class="sxs-lookup"><span data-stu-id="85187-463">For example, `[Route("/a{b}c{d}")]` is a complex segment.</span></span>
<span data-ttu-id="85187-464">Złożone segmenty działają w określony sposób, który musi być rozumiany jako z powodzeniem z nich korzystać.</span><span class="sxs-lookup"><span data-stu-id="85187-464">Complex segments work in a particular way that must be understood to use them successfully.</span></span> <span data-ttu-id="85187-465">W przykładzie w tej sekcji pokazano, dlaczego złożone segmenty działają tylko dobrze, gdy tekst ogranicznika nie pojawia się wewnątrz wartości parametrów.</span><span class="sxs-lookup"><span data-stu-id="85187-465">The example in this section demonstrates why complex segments only really work well when the delimiter text doesn't appear inside the parameter values.</span></span> <span data-ttu-id="85187-466">Przy użyciu [wyrażenia regularnego,](/dotnet/standard/base-types/regular-expressions) a następnie ręcznie wyodrębnianie wartości jest potrzebne w bardziej złożonych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="85187-466">Using a [regex](/dotnet/standard/base-types/regular-expressions) and then manually extracting the values is needed for more complex cases.</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="85187-467">Jest to podsumowanie kroków, które routing `/a{b}c{d}` wykonuje z `/abcd`szablonem i ścieżką adresu URL .</span><span class="sxs-lookup"><span data-stu-id="85187-467">This is a summary of the steps that routing performs with the template `/a{b}c{d}` and the URL path `/abcd`.</span></span> <span data-ttu-id="85187-468">Służy `|` do wizualizacji, jak działa algorytm:</span><span class="sxs-lookup"><span data-stu-id="85187-468">The `|` is used to help visualize how the algorithm works:</span></span>

* <span data-ttu-id="85187-469">Pierwszym dosłownym, od `c`prawej do lewej, jest .</span><span class="sxs-lookup"><span data-stu-id="85187-469">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="85187-470">Tak `/abcd` jest wyszukiwany od `/ab|c|d`prawej i znajduje .</span><span class="sxs-lookup"><span data-stu-id="85187-470">So `/abcd` is searched from right and finds `/ab|c|d`.</span></span>
* <span data-ttu-id="85187-471">Wszystko po prawej`d`stronie ( ) jest `{d}`teraz dopasowane do parametru trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-471">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="85187-472">Następny dosłowny, od `a`prawej do lewej, to .</span><span class="sxs-lookup"><span data-stu-id="85187-472">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="85187-473">Tak `/ab|c|d` jest przeszukiwany, począwszy `a` od `/|a|b|c|d`miejsca, w którym po zostało przerwane, a następnie znajduje się .</span><span class="sxs-lookup"><span data-stu-id="85187-473">So `/ab|c|d` is searched starting where we left off, then `a` is found `/|a|b|c|d`.</span></span>
* <span data-ttu-id="85187-474">Wartość po prawej`b`stronie ( ) jest teraz `{b}`dopasowywać do parametru trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-474">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="85187-475">Nie ma pozostałego tekstu ani pozostałego szablonu trasy, więc jest to dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-475">There is no remaining text and no remaining route template, so this is a match.</span></span>

<span data-ttu-id="85187-476">Oto przykład negatywnego przypadku przy użyciu `/a{b}c{d}` tego samego `/aabcd`szablonu i ścieżki adresu URL .</span><span class="sxs-lookup"><span data-stu-id="85187-476">Here's an example of a negative case using the same template `/a{b}c{d}` and the URL path `/aabcd`.</span></span> <span data-ttu-id="85187-477">Służy `|` do wizualizacji, jak działa algorytm.</span><span class="sxs-lookup"><span data-stu-id="85187-477">The `|` is used to help visualize how the algorithm works.</span></span> <span data-ttu-id="85187-478">Ten przypadek nie jest dopasowaniem, co jest wyjaśnione przez ten sam algorytm:</span><span class="sxs-lookup"><span data-stu-id="85187-478">This case isn't a match, which is explained by the same algorithm:</span></span>
* <span data-ttu-id="85187-479">Pierwszym dosłownym, od `c`prawej do lewej, jest .</span><span class="sxs-lookup"><span data-stu-id="85187-479">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="85187-480">Tak `/aabcd` jest wyszukiwany od `/aab|c|d`prawej i znajduje .</span><span class="sxs-lookup"><span data-stu-id="85187-480">So `/aabcd` is searched from right and finds `/aab|c|d`.</span></span>
* <span data-ttu-id="85187-481">Wszystko po prawej`d`stronie ( ) jest `{d}`teraz dopasowane do parametru trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-481">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="85187-482">Następny dosłowny, od `a`prawej do lewej, to .</span><span class="sxs-lookup"><span data-stu-id="85187-482">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="85187-483">Tak `/aab|c|d` jest przeszukiwany, począwszy `a` od `/a|a|b|c|d`miejsca, w którym po zostało przerwane, a następnie znajduje się .</span><span class="sxs-lookup"><span data-stu-id="85187-483">So `/aab|c|d` is searched starting where we left off, then `a` is found `/a|a|b|c|d`.</span></span>
* <span data-ttu-id="85187-484">Wartość po prawej`b`stronie ( ) jest teraz `{b}`dopasowywać do parametru trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-484">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="85187-485">W tym momencie `a`jest pozostały tekst , ale algorytm zabrakło szablonu trasy do analizy, więc nie jest to dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-485">At this point there is remaining text `a`, but the algorithm has run out of route template to parse, so this is not a match.</span></span>

<span data-ttu-id="85187-486">Ponieważ algorytm dopasowania jest [niechciwy:](#greedy)</span><span class="sxs-lookup"><span data-stu-id="85187-486">Since the matching algorithm is [non-greedy](#greedy):</span></span>

* <span data-ttu-id="85187-487">Odpowiada najmniejszej możliwej ilości tekstu w każdym kroku.</span><span class="sxs-lookup"><span data-stu-id="85187-487">It matches the smallest amount of text possible in each step.</span></span>
* <span data-ttu-id="85187-488">W każdym przypadku, gdy wartość ogranicznika pojawia się wewnątrz wartości parametrów powoduje, że nie pasujące.</span><span class="sxs-lookup"><span data-stu-id="85187-488">Any case where the delimiter value appears inside the parameter values results in not matching.</span></span>

<span data-ttu-id="85187-489">Wyrażenia regularne zapewniają znacznie większą kontrolę nad ich zachowaniem dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-489">Regular expressions provide much more control over their matching behavior.</span></span>

<a name="greedy"></a>

<span data-ttu-id="85187-490">Chciwy dopasowywanie, znany również jako [leniwy dopasowania,](https://wikipedia.org/wiki/Regular_expression#Lazy_matching)pasuje do największego możliwego ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-490">Greedy matching, also know as [lazy matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), matches the largest possible string.</span></span> <span data-ttu-id="85187-491">Non-chciwy pasuje do najmniejszego możliwego ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-491">Non-greedy matches the smallest possible string.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="85187-492">Odwołanie do ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="85187-492">Route constraint reference</span></span>

<span data-ttu-id="85187-493">Ograniczenia trasy są wykonywane, gdy dopasowanie wystąpiło z przychodzącym adresem URL, a ścieżka adresu URL jest tokenizowana na wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-493">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="85187-494">Ograniczenia trasy zazwyczaj sprawdzają wartość trasy skojarzoną za pośrednictwem szablonu trasy i podejmują prawdziwą lub fałszywą decyzję o tym, czy wartość jest dopuszczalna.</span><span class="sxs-lookup"><span data-stu-id="85187-494">Route constraints generally inspect the route value associated via the route template and make a true or false decision about whether the value is acceptable.</span></span> <span data-ttu-id="85187-495">Niektóre ograniczenia trasy używają danych poza wartością trasy, aby rozważyć, czy żądanie może być kierowane.</span><span class="sxs-lookup"><span data-stu-id="85187-495">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="85187-496">Na przykład <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> można zaakceptować lub odrzucić żądanie na podstawie jego zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-496">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="85187-497">Ograniczenia są używane w żądaniach routingu i generowaniu łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-497">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="85187-498">Nie używaj ograniczeń do sprawdzania poprawności danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="85187-498">Don't use constraints for input validation.</span></span> <span data-ttu-id="85187-499">Jeśli ograniczenia są używane do sprawdzania poprawności `404` danych wejściowych, nieprawidłowe wyniki wejściowe w odpowiedzi nie znaleziono.</span><span class="sxs-lookup"><span data-stu-id="85187-499">If constraints are used for input validation, invalid input results in a `404` Not Found response.</span></span> <span data-ttu-id="85187-500">Nieprawidłowe dane `400` wejściowe powinny spowodować nieprawidłowe żądanie z odpowiednim komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="85187-500">Invalid input should produce a `400` Bad Request with an appropriate error message.</span></span> <span data-ttu-id="85187-501">Ograniczenia trasy są używane do rozróżniania podobnych tras, a nie do sprawdzania poprawności danych wejściowych dla określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-501">Route constraints are used to disambiguate similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="85187-502">W poniższej tabeli przedstawiono przykładowe ograniczenia trasy i ich oczekiwane zachowanie:</span><span class="sxs-lookup"><span data-stu-id="85187-502">The following table demonstrates example route constraints and their expected behavior:</span></span>

| <span data-ttu-id="85187-503">ograniczenie</span><span class="sxs-lookup"><span data-stu-id="85187-503">constraint</span></span> | <span data-ttu-id="85187-504">Przykład</span><span class="sxs-lookup"><span data-stu-id="85187-504">Example</span></span> | <span data-ttu-id="85187-505">Przykładowe dopasowania</span><span class="sxs-lookup"><span data-stu-id="85187-505">Example Matches</span></span> | <span data-ttu-id="85187-506">Uwagi</span><span class="sxs-lookup"><span data-stu-id="85187-506">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="85187-507">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="85187-507">`123456789`, `-123456789`</span></span> | <span data-ttu-id="85187-508">Dopasowuje dowolną całkowitą</span><span class="sxs-lookup"><span data-stu-id="85187-508">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="85187-509">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="85187-509">`true`, `FALSE`</span></span> | <span data-ttu-id="85187-510">Pasuje `true` `false`lub .</span><span class="sxs-lookup"><span data-stu-id="85187-510">Matches `true` or `false`.</span></span> <span data-ttu-id="85187-511">Bez uwzględniania wielkości liter</span><span class="sxs-lookup"><span data-stu-id="85187-511">Case-insensitive</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="85187-512">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="85187-512">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="85187-513">Pasuje do `DateTime` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-513">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="85187-514">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-514">See preceding warning.</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="85187-515">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="85187-515">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="85187-516">Pasuje do `decimal` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-516">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="85187-517">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-517">See preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="85187-518">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="85187-518">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="85187-519">Pasuje do `double` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-519">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="85187-520">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-520">See preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="85187-521">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="85187-521">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="85187-522">Pasuje do `float` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-522">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="85187-523">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-523">See preceding warning.</span></span>|
| `guid` | `{id:guid}` | `CD2C1638-1638-72D5-1638-DEADBEEF1638` | <span data-ttu-id="85187-524">Dopasowuje `Guid` prawidłową wartość</span><span class="sxs-lookup"><span data-stu-id="85187-524">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="85187-525">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="85187-525">`123456789`, `-123456789`</span></span> | <span data-ttu-id="85187-526">Dopasowuje `long` prawidłową wartość</span><span class="sxs-lookup"><span data-stu-id="85187-526">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="85187-527">Ciąg musi zawierać co najmniej 4 znaki</span><span class="sxs-lookup"><span data-stu-id="85187-527">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="85187-528">Ciąg nie może zawierać więcej niż 8 znaków</span><span class="sxs-lookup"><span data-stu-id="85187-528">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="85187-529">Ciąg musi mieć dokładnie 12 znaków</span><span class="sxs-lookup"><span data-stu-id="85187-529">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="85187-530">Ciąg musi mieć co najmniej 8 znaków i nie więcej niż 16 znaków</span><span class="sxs-lookup"><span data-stu-id="85187-530">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="85187-531">Wartość całkowita musi wynosić co najmniej 18</span><span class="sxs-lookup"><span data-stu-id="85187-531">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="85187-532">Wartość całkowita nie może być większa niż 120</span><span class="sxs-lookup"><span data-stu-id="85187-532">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="85187-533">Wartość całkowita musi wynosić co najmniej 18, ale nie więcej niż 120</span><span class="sxs-lookup"><span data-stu-id="85187-533">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="85187-534">Ciąg musi składać się z jednego `a` - `z` lub więcej znaków alfabetycznych i bez uwzględniania wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="85187-534">String must consist of one or more alphabetical characters, `a`-`z` and case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="85187-535">Ciąg musi być zgodny z wyrażeniem regularnym.</span><span class="sxs-lookup"><span data-stu-id="85187-535">String must match the regular expression.</span></span> <span data-ttu-id="85187-536">Zobacz wskazówki dotyczące definiowania wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="85187-536">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="85187-537">Służy do wymuszania obecności wartości nieparametryjnej podczas generowania adresu URL</span><span class="sxs-lookup"><span data-stu-id="85187-537">Used to enforce that a non-parameter value is present during URL generation</span></span> |

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="85187-538">Wiele ograniczeń rozdzielanych dwukropek można zastosować do pojedynczego parametru.</span><span class="sxs-lookup"><span data-stu-id="85187-538">Multiple, colon delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="85187-539">Na przykład następujące ograniczenie ogranicza parametr do wartości całkowitej 1 lub większej:</span><span class="sxs-lookup"><span data-stu-id="85187-539">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="85187-540">Ograniczenia trasy, które weryfikują adres URL i są konwertowane na typ CLR, zawsze używają kultury niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-540">Route constraints that verify the URL and are converted to a CLR type always use the invariant culture.</span></span> <span data-ttu-id="85187-541">Na przykład konwersja na `int` typ `DateTime`CLR lub .</span><span class="sxs-lookup"><span data-stu-id="85187-541">For example, conversion to the CLR type `int` or `DateTime`.</span></span> <span data-ttu-id="85187-542">Te ograniczenia zakładają, że adres URL nie jest zlokalizowany.</span><span class="sxs-lookup"><span data-stu-id="85187-542">These constraints assume that the URL is not localizable.</span></span> <span data-ttu-id="85187-543">Ograniczenia trasy dostarczone przez strukturę nie modyfikują wartości przechowywanych w wartościach marszruty.</span><span class="sxs-lookup"><span data-stu-id="85187-543">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="85187-544">Wszystkie wartości trasy analizowane z adresu URL są przechowywane jako ciągi.</span><span class="sxs-lookup"><span data-stu-id="85187-544">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="85187-545">Na przykład `float` ograniczenie próbuje przekonwertować wartość trasy na float, ale przekonwertowana wartość jest używana tylko do sprawdzenia, czy można ją przekonwertować na float.</span><span class="sxs-lookup"><span data-stu-id="85187-545">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

### <a name="regular-expressions-in-constraints"></a><span data-ttu-id="85187-546">Wyrażenia regularne w ograniczeniach</span><span class="sxs-lookup"><span data-stu-id="85187-546">Regular expressions in constraints</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="85187-547">Wyrażenia regularne można określić jako ograniczenia `regex(...)` wbudowane przy użyciu ograniczenia trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-547">Regular expressions can be specified as inline constraints using the `regex(...)` route constraint.</span></span> <span data-ttu-id="85187-548">Metody w <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> rodzinie również zaakceptować obiekt literał ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="85187-548">Methods in the <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> family also accept an object literal of constraints.</span></span> <span data-ttu-id="85187-549">Jeśli ten formularz jest używany, wartości ciągu są interpretowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="85187-549">If that form is used, string values are interpreted as regular expressions.</span></span>

<span data-ttu-id="85187-550">Poniższy kod używa ograniczenia wyrażenia regularnego w linii wbudowanej:</span><span class="sxs-lookup"><span data-stu-id="85187-550">The following code uses an inline regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex.cs?name=snippet)]

<span data-ttu-id="85187-551">Poniższy kod używa literału obiektu do określenia ograniczenia wyrażenia regularnego:</span><span class="sxs-lookup"><span data-stu-id="85187-551">The following code uses an object literal to specify a regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex2.cs?name=snippet)]

<span data-ttu-id="85187-552">Struktura ASP.NET Core dodaje `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktora wyrażeń regularnych.</span><span class="sxs-lookup"><span data-stu-id="85187-552">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="85187-553">Opis <xref:System.Text.RegularExpressions.RegexOptions> tych członków można znaleźć w części.</span><span class="sxs-lookup"><span data-stu-id="85187-553">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="85187-554">Wyrażenia regularne używają ograniczników i tokenów podobnych do tych używanych przez routing i język C#.</span><span class="sxs-lookup"><span data-stu-id="85187-554">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="85187-555">Tokeny wyrażenia regularnego muszą zostać zmienione.</span><span class="sxs-lookup"><span data-stu-id="85187-555">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="85187-556">Aby użyć wyrażenia `^\d{3}-\d{2}-\d{4}$` regularnego w ograniczeniu wbudowanym, należy użyć jednej z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="85187-556">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in an inline constraint, use one of the following:</span></span>

* <span data-ttu-id="85187-557">Zastąp `\` znaki `\\` podane w ciągu jako znaki w `\` pliku źródłowym języka C#, aby uniknąć znaku ucieczki ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-557">Replace `\` characters provided in the string as `\\` characters in the C# source file in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="85187-558">[Dosłownie literały ciąg .](/dotnet/csharp/language-reference/keywords/string)</span><span class="sxs-lookup"><span data-stu-id="85187-558">[Verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="85187-559">Aby uniknąć znaków ogranicznika `}` `[`parametru marszruty `]` `{`, , , `{{` `}}`podwoić znaki w wyrażeniu, na przykład , , `[[`, `]]`.</span><span class="sxs-lookup"><span data-stu-id="85187-559">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression, for example, `{{`, `}}`, `[[`, `]]`.</span></span> <span data-ttu-id="85187-560">W poniższej tabeli przedstawiono wyrażenie regularne i jego wersję odstępstki:</span><span class="sxs-lookup"><span data-stu-id="85187-560">The following table shows a regular expression and its escaped version:</span></span>

| <span data-ttu-id="85187-561">Wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="85187-561">Regular expression</span></span>    | <span data-ttu-id="85187-562">Wysunęło się wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="85187-562">Escaped regular expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="85187-563">Wyrażenia regularne używane w routingu `^` często zaczynają się od znaku i odpowiadają pozycji początkowej ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-563">Regular expressions used in routing often start with the `^` character and match the starting position of the string.</span></span> <span data-ttu-id="85187-564">Wyrażenia często kończą się `$` znakiem i pasują do końca ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-564">The expressions often end with the `$` character and match the end of the string.</span></span> <span data-ttu-id="85187-565">Znaki `^` `$` i upewnij się, że wyrażenie regularne pasuje do wartości całego parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-565">The `^` and `$` characters ensure that the regular expression matches the entire route parameter value.</span></span> <span data-ttu-id="85187-566">Bez `^` znaków `$` i wyrażenie regularne pasuje do dowolnego podciągu w ciągu, który jest często niepożądane.</span><span class="sxs-lookup"><span data-stu-id="85187-566">Without the `^` and `$` characters, the regular expression matches any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="85187-567">W poniższej tabeli przedstawiono przykłady i wyjaśniono, dlaczego są zgodne lub nie pasują do siebie:</span><span class="sxs-lookup"><span data-stu-id="85187-567">The following table provides examples and explains why they match or fail to match:</span></span>

| <span data-ttu-id="85187-568">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="85187-568">Expression</span></span>   | <span data-ttu-id="85187-569">Ciąg</span><span class="sxs-lookup"><span data-stu-id="85187-569">String</span></span>    | <span data-ttu-id="85187-570">Dopasowanie</span><span class="sxs-lookup"><span data-stu-id="85187-570">Match</span></span> | <span data-ttu-id="85187-571">Komentarz</span><span class="sxs-lookup"><span data-stu-id="85187-571">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="85187-572">hello</span><span class="sxs-lookup"><span data-stu-id="85187-572">hello</span></span>     | <span data-ttu-id="85187-573">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-573">Yes</span></span>   | <span data-ttu-id="85187-574">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="85187-574">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="85187-575">123abc456</span><span class="sxs-lookup"><span data-stu-id="85187-575">123abc456</span></span> | <span data-ttu-id="85187-576">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-576">Yes</span></span>   | <span data-ttu-id="85187-577">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="85187-577">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="85187-578">Mz</span><span class="sxs-lookup"><span data-stu-id="85187-578">mz</span></span>        | <span data-ttu-id="85187-579">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-579">Yes</span></span>   | <span data-ttu-id="85187-580">Dopasowuje wyrażenie</span><span class="sxs-lookup"><span data-stu-id="85187-580">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="85187-581">MZ</span><span class="sxs-lookup"><span data-stu-id="85187-581">MZ</span></span>        | <span data-ttu-id="85187-582">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-582">Yes</span></span>   | <span data-ttu-id="85187-583">Nie z uwzględnieniem wielkości liter</span><span class="sxs-lookup"><span data-stu-id="85187-583">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="85187-584">hello</span><span class="sxs-lookup"><span data-stu-id="85187-584">hello</span></span>     | <span data-ttu-id="85187-585">Nie</span><span class="sxs-lookup"><span data-stu-id="85187-585">No</span></span>    | <span data-ttu-id="85187-586">Zobacz `^` `$` i powyżej</span><span class="sxs-lookup"><span data-stu-id="85187-586">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="85187-587">123abc456</span><span class="sxs-lookup"><span data-stu-id="85187-587">123abc456</span></span> | <span data-ttu-id="85187-588">Nie</span><span class="sxs-lookup"><span data-stu-id="85187-588">No</span></span>    | <span data-ttu-id="85187-589">Zobacz `^` `$` i powyżej</span><span class="sxs-lookup"><span data-stu-id="85187-589">See `^` and `$` above</span></span> |

<span data-ttu-id="85187-590">Aby uzyskać więcej informacji na temat składni wyrażeń regularnych, zobacz [.NET Framework Wyrażenia regularne](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="85187-590">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="85187-591">Aby ograniczyć parametr do znanego zestawu możliwych wartości, należy użyć wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="85187-591">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="85187-592">Na przykład `{action:regex(^(list|get|create)$)}` tylko `action` dopasowuje `list` `get`wartość `create`trasy do , lub .</span><span class="sxs-lookup"><span data-stu-id="85187-592">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="85187-593">Jeśli przekazywane do słownika ograniczeń, `^(list|get|create)$` ciąg jest równoważne.</span><span class="sxs-lookup"><span data-stu-id="85187-593">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="85187-594">Ograniczenia, które są przekazywane w słowniku ograniczeń, które nie pasują do jednego ze znanych ograniczeń są również traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="85187-594">Constraints that are passed in the constraints dictionary that don't match one of the known constraints are also treated as regular expressions.</span></span> <span data-ttu-id="85187-595">Ograniczenia przekazywane w szablonie, które nie pasują do jednego ze znanych ograniczeń, nie są traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="85187-595">Constraints that are passed  within a template that don't match one of the known constraints are not treated as regular expressions.</span></span>

### <a name="custom-route-constraints"></a><span data-ttu-id="85187-596">Niestandardowe ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="85187-596">Custom route constraints</span></span>

<span data-ttu-id="85187-597">Niestandardowe ograniczenia trasy można utworzyć <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> przez implementowanie interfejsu.</span><span class="sxs-lookup"><span data-stu-id="85187-597">Custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="85187-598">Interfejs `IRouteConstraint` zawiera <xref:System.Web.Routing.IRouteConstraint.Match*>, `true` który zwraca, jeśli `false` ograniczenie jest spełnione i w inny sposób.</span><span class="sxs-lookup"><span data-stu-id="85187-598">The `IRouteConstraint` interface contains <xref:System.Web.Routing.IRouteConstraint.Match*>, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="85187-599">Niestandardowe ograniczenia trasy są rzadko potrzebne.</span><span class="sxs-lookup"><span data-stu-id="85187-599">Custom route constraints are rarely needed.</span></span> <span data-ttu-id="85187-600">Przed zaimplementowanie ograniczenia trasy niestandardowej należy wziąć pod uwagę alternatywy, takie jak powiązanie modelu.</span><span class="sxs-lookup"><span data-stu-id="85187-600">Before implementing a custom route constraint, consider alternatives, such as model binding.</span></span>

<span data-ttu-id="85187-601">Aby użyć `IRouteConstraint`niestandardowego, typ ograniczenia trasy musi być <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> zarejestrowany w aplikacji w kontenerze usługi.</span><span class="sxs-lookup"><span data-stu-id="85187-601">To use a custom `IRouteConstraint`, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the service container.</span></span> <span data-ttu-id="85187-602">A `ConstraintMap` to słownik, który mapuje `IRouteConstraint` klucze ograniczenia trasy do implementacji, które sprawdzają te ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-602">A `ConstraintMap` is a dictionary that maps route constraint keys to `IRouteConstraint` implementations that validate those constraints.</span></span> <span data-ttu-id="85187-603">Aplikacja może `ConstraintMap` być aktualizowana `Startup.ConfigureServices` w ramach [usługi. Wywołanie AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) lub <xref:Microsoft.AspNetCore.Routing.RouteOptions> konfiguracja `services.Configure<RouteOptions>`bezpośrednio z programem .</span><span class="sxs-lookup"><span data-stu-id="85187-603">An app's `ConstraintMap` can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="85187-604">Przykład:</span><span class="sxs-lookup"><span data-stu-id="85187-604">For example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet)]

<span data-ttu-id="85187-605">Poprzednie ograniczenie jest stosowane w następującym kodzie:</span><span class="sxs-lookup"><span data-stu-id="85187-605">The preceding constraint is applied in the following code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet&highlight=6,13)]

[!INCLUDE[](~/includes/MyDisplayRouteInfo.md)]

<span data-ttu-id="85187-606">Implementacja `MyCustomConstraint` zapobiega `0` stosowania do parametru trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-606">The implementation of `MyCustomConstraint` prevents `0` being applied to a route parameter:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet2)]

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="85187-607">Powyższy kod ma następujące działanie:</span><span class="sxs-lookup"><span data-stu-id="85187-607">The preceding code:</span></span>

* <span data-ttu-id="85187-608">Zapobiega `0` w `{id}` segmencie trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-608">Prevents `0` in the `{id}` segment of the route.</span></span>
* <span data-ttu-id="85187-609">Pokazano, aby zapewnić podstawowy przykład implementacji ograniczenia niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="85187-609">Is shown to provide a basic example of implementing a custom constraint.</span></span> <span data-ttu-id="85187-610">Nie należy go używać w aplikacji produkcyjnej.</span><span class="sxs-lookup"><span data-stu-id="85187-610">It should not be used in a production app.</span></span>

<span data-ttu-id="85187-611">Poniższy kod jest lepszym podejściem `id` do `0` zapobiegania przetwarzania zawierającego:</span><span class="sxs-lookup"><span data-stu-id="85187-611">The following code is a better approach to preventing an `id` containing a `0` from being processed:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet2)]

<span data-ttu-id="85187-612">Poprzedni kod ma następujące zalety `MyCustomConstraint` w stosunku do podejścia:</span><span class="sxs-lookup"><span data-stu-id="85187-612">The preceding code has the following advantages over the `MyCustomConstraint` approach:</span></span>

* <span data-ttu-id="85187-613">Nie wymaga ograniczenia niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="85187-613">It doesn't require a custom constraint.</span></span>
* <span data-ttu-id="85187-614">Zwraca bardziej opisowy błąd, gdy parametr `0`trasy zawiera .</span><span class="sxs-lookup"><span data-stu-id="85187-614">It returns a more descriptive error when the route parameter includes `0`.</span></span>

## <a name="parameter-transformer-reference"></a><span data-ttu-id="85187-615">Odwołanie do transformatora parametrów</span><span class="sxs-lookup"><span data-stu-id="85187-615">Parameter transformer reference</span></span>

<span data-ttu-id="85187-616">Transformatory parametrów:</span><span class="sxs-lookup"><span data-stu-id="85187-616">Parameter transformers:</span></span>

* <span data-ttu-id="85187-617">Wykonywanie podczas generowania <xref:Microsoft.AspNetCore.Routing.LinkGenerator>łącza przy użyciu programu .</span><span class="sxs-lookup"><span data-stu-id="85187-617">Execute when generating a link using <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span></span>
* <span data-ttu-id="85187-618">Zaimplementuj <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>plik .</span><span class="sxs-lookup"><span data-stu-id="85187-618">Implement <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span></span>
* <span data-ttu-id="85187-619">Są konfigurowane przy użyciu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>programu .</span><span class="sxs-lookup"><span data-stu-id="85187-619">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="85187-620">Należy wziąć wartość trasy parametru i przekształcić go w nową wartość ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-620">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="85187-621">Wynik przy użyciu wartości przekształcone w wygenerowanym łączu.</span><span class="sxs-lookup"><span data-stu-id="85187-621">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="85187-622">`slugify` Na przykład niestandardowy transformator parametrów we wzorcu `blog\{article:slugify}` trasy z `Url.Action(new { article = "MyTestArticle" })` generuje `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="85187-622">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="85187-623">Należy wziąć `IOutboundParameterTransformer` pod uwagę następujące implementacji:</span><span class="sxs-lookup"><span data-stu-id="85187-623">Consider the following `IOutboundParameterTransformer` implementation:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet2)]

<span data-ttu-id="85187-624">Aby użyć transformatora parametrów we wzorcu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> `Startup.ConfigureServices`trasy, skonfiguruj go za pomocą:</span><span class="sxs-lookup"><span data-stu-id="85187-624">To use a parameter transformer in a route pattern, configure it using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet)]

<span data-ttu-id="85187-625">ASP.NET Core framework używa transformatorów parametrów do przekształcania identyfikatora URI, gdzie punkt końcowy jest rozpoznawany.</span><span class="sxs-lookup"><span data-stu-id="85187-625">The ASP.NET Core framework uses parameter transformers to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="85187-626">Na przykład transformatory parametrów przekształcają `area`wartości `controller` `action`trasy `page`używane do dopasowania , , i .</span><span class="sxs-lookup"><span data-stu-id="85187-626">For example, parameter transformers transform the route values used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapControllerRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="85187-627">W poprzednim szablonie trasy `SubscriptionManagementController.GetAll` akcja jest dopasowywała się do identyfikatora URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="85187-627">With the preceding route template, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="85187-628">Transformator parametrów nie zmienia wartości trasy używanej do generowania łącza.</span><span class="sxs-lookup"><span data-stu-id="85187-628">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="85187-629">Na przykład `Url.Action("GetAll", "SubscriptionManagement")` wyjścia `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="85187-629">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="85187-630">ASP.NET Core udostępnia konwencje interfejsu API do używania transformatorów parametrów z wygenerowanymi trasami:</span><span class="sxs-lookup"><span data-stu-id="85187-630">ASP.NET Core provides API conventions for using parameter transformers with generated routes:</span></span>

* <span data-ttu-id="85187-631">Konwencja <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC stosuje określony transformator parametrów do wszystkich tras atrybutów w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-631">The <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="85187-632">Transformator parametrów przekształca tokeny trasy atrybutu, ponieważ są one zastępowane.</span><span class="sxs-lookup"><span data-stu-id="85187-632">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="85187-633">Aby uzyskać więcej informacji, zobacz [Używanie transformatora parametrów w celu dostosowania zastępowania tokenów](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="85187-633">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="85187-634">Razor Pages używa <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> konwencji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="85187-634">Razor Pages uses the <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> API convention.</span></span> <span data-ttu-id="85187-635">Ta konwencja stosuje określony transformator parametrów do wszystkich automatycznie odnalezionych stron Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-635">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="85187-636">Transformator parametrów przekształca segmenty folderów i nazw plików tras Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="85187-636">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="85187-637">Aby uzyskać więcej informacji, zobacz [Dostosowywanie tras stron za pomocą transformatora parametrów](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="85187-637">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

<a name="ugr"></a>

## <a name="url-generation-reference"></a><span data-ttu-id="85187-638">Odwołanie do generowania adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-638">URL generation reference</span></span>

<span data-ttu-id="85187-639">Ta sekcja zawiera odwołanie do algorytmu zaimplementowanego przez generowanie adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-639">This section contains a reference for the algorithm implemented by URL generation.</span></span> <span data-ttu-id="85187-640">W praktyce większość złożonych przykładów generowania adresów URL używa kontrolerów lub stron Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-640">In practice, most complex examples of URL generation use controllers or Razor Pages.</span></span> <span data-ttu-id="85187-641">Zobacz [routing w kontrolerach,](xref:mvc/controllers/routing) aby uzyskać dodatkowe informacje.</span><span class="sxs-lookup"><span data-stu-id="85187-641">See  [routing in controllers](xref:mvc/controllers/routing) for additional information.</span></span>

<span data-ttu-id="85187-642">Proces generowania adresu URL rozpoczyna się od wywołania [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) lub podobnej metody.</span><span class="sxs-lookup"><span data-stu-id="85187-642">The URL generation process begins with a call to [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) or a similar method.</span></span> <span data-ttu-id="85187-643">Metoda jest dostarczana z adresem, zestawem wartości trasy i opcjonalnie `HttpContext`informacjami o bieżącym żądaniu od .</span><span class="sxs-lookup"><span data-stu-id="85187-643">The method is provided with an address, a set of route values, and optionally information about the current request from `HttpContext`.</span></span>

<span data-ttu-id="85187-644">Pierwszym krokiem jest użycie adresu do rozpoznania zestawu punktów [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) końcowych kandydata przy użyciu tego, który pasuje do typu adresu.</span><span class="sxs-lookup"><span data-stu-id="85187-644">The first step is to use the address to resolve a set of candidate endpoints using an [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) that matches the address's type.</span></span>

<span data-ttu-id="85187-645">Gdy zestaw kandydatów zostanie znaleziony przez schemat adresowy, punkty końcowe są uporządkowane i przetwarzane iteratively do czasu zakończenia operacji generowania adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-645">Once of set of candidates is found by the address scheme, the endpoints are ordered and processed iteratively until a URL generation operation succeeds.</span></span> <span data-ttu-id="85187-646">Generowanie adresu URL **nie** sprawdza niejednoznaczności, pierwszy zwrócony wynik jest wynikiem końcowym.</span><span class="sxs-lookup"><span data-stu-id="85187-646">URL generation does **not** check for ambiguities, the first result returned is the final result.</span></span>

### <a name="troubleshooting-url-generation-with-logging"></a><span data-ttu-id="85187-647">Rozwiązywanie problemów z generowaniem adresów URL za pomocą rejestrowania</span><span class="sxs-lookup"><span data-stu-id="85187-647">Troubleshooting URL generation with logging</span></span>

<span data-ttu-id="85187-648">Pierwszym krokiem w rozwiązywaniu problemów z generowaniem adresów `Microsoft.AspNetCore.Routing` URL jest ustawienie poziomu rejestrowania na `TRACE`.</span><span class="sxs-lookup"><span data-stu-id="85187-648">The first step in troubleshooting URL generation is setting the logging level of `Microsoft.AspNetCore.Routing` to `TRACE`.</span></span> <span data-ttu-id="85187-649">`LinkGenerator`rejestruje wiele szczegółów na temat jego przetwarzania, które mogą być przydatne do rozwiązywania problemów.</span><span class="sxs-lookup"><span data-stu-id="85187-649">`LinkGenerator` logs many details about its processing which can be useful to troubleshoot problems.</span></span>

<span data-ttu-id="85187-650">Szczegółowe informacje [na temat](#ugr) generowania adresów URL można znaleźć w informacji o generowaniu adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-650">See [URL generation reference](#ugr) for details on URL generation.</span></span>

### <a name="addresses"></a><span data-ttu-id="85187-651">Adresy</span><span class="sxs-lookup"><span data-stu-id="85187-651">Addresses</span></span>

<span data-ttu-id="85187-652">Adresy są pojęciem generowania adresów URL używane do powiązania wywołania do generatora łączy z zestawem punktów końcowych kandydata.</span><span class="sxs-lookup"><span data-stu-id="85187-652">Addresses are the concept in URL generation used to bind a call into the link generator to a set of candidate endpoints.</span></span>

<span data-ttu-id="85187-653">Adresy są rozszerzalne koncepcji, które są dostarczane z dwóch implementacji domyślnie:</span><span class="sxs-lookup"><span data-stu-id="85187-653">Addresses are an extensible concept that come with two implementations by default:</span></span>

* <span data-ttu-id="85187-654">Używanie nazwy punktu`string` *końcowego* ( ) jako adresu:</span><span class="sxs-lookup"><span data-stu-id="85187-654">Using *endpoint name* (`string`) as the address:</span></span>
    * <span data-ttu-id="85187-655">Zapewnia podobną funkcjonalność do nazwy trasy MVC.</span><span class="sxs-lookup"><span data-stu-id="85187-655">Provides similar functionality to MVC's route name.</span></span>
    * <span data-ttu-id="85187-656">Używa typu <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadanych.</span><span class="sxs-lookup"><span data-stu-id="85187-656">Uses the <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadata type.</span></span>
    * <span data-ttu-id="85187-657">Rozwiązuje podany ciąg względem metadanych wszystkich zarejestrowanych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-657">Resolves the provided string against the metadata of all registered endpoints.</span></span>
    * <span data-ttu-id="85187-658">Zgłasza wyjątek podczas uruchamiania, jeśli wiele punktów końcowych używa tej samej nazwy.</span><span class="sxs-lookup"><span data-stu-id="85187-658">Throws an exception on startup if multiple endpoints use the same name.</span></span>
    * <span data-ttu-id="85187-659">Zalecane do użytku ogólnego poza kontrolerami i stronami Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-659">Recommended for general-purpose use outside of controllers and Razor Pages.</span></span>
* <span data-ttu-id="85187-660">Używanie *wartości* <xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>trasy ( ) jako adresu:</span><span class="sxs-lookup"><span data-stu-id="85187-660">Using *route values* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) as the address:</span></span>
    * <span data-ttu-id="85187-661">Zapewnia podobne funkcje do kontrolerów i razor Pages generowania starszych adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-661">Provides similar functionality to controllers and Razor Pages legacy URL generation.</span></span>
    * <span data-ttu-id="85187-662">Bardzo skomplikowane, aby rozszerzyć i debugować.</span><span class="sxs-lookup"><span data-stu-id="85187-662">Very complex to extend and debug.</span></span>
    * <span data-ttu-id="85187-663">Zapewnia implementację `IUrlHelper`używaną przez , Pomocników tagów, pomocników HTML, wyniki akcji itp.</span><span class="sxs-lookup"><span data-stu-id="85187-663">Provides the implementation used by `IUrlHelper`, Tag Helpers, HTML Helpers, Action Results, etc.</span></span>

<span data-ttu-id="85187-664">Rolą schematu adresów jest uczynienie skojarzenia między adresem a pasującymi punktami końcowymi według dowolnych kryteriów:</span><span class="sxs-lookup"><span data-stu-id="85187-664">The role of the address scheme is to make the association between the address and matching endpoints by arbitrary criteria:</span></span>

* <span data-ttu-id="85187-665">Schemat nazwy punktu końcowego wykonuje podstawowe wyszukiwanie słownika.</span><span class="sxs-lookup"><span data-stu-id="85187-665">The endpoint name scheme performs a basic dictionary lookup.</span></span>
* <span data-ttu-id="85187-666">Schemat wartości trasy ma złożony najlepszy podzbiór algorytmu zestawu.</span><span class="sxs-lookup"><span data-stu-id="85187-666">The route values scheme has a complex best subset of set algorithm.</span></span>

<a name="ambient"></a>

### <a name="ambient-values-and-explicit-values"></a><span data-ttu-id="85187-667">Wartości otoczenia i wartości jawne</span><span class="sxs-lookup"><span data-stu-id="85187-667">Ambient values and explicit values</span></span>

<span data-ttu-id="85187-668">Z bieżącego żądania routing uzyskuje dostęp do `HttpContext.Request.RouteValues`wartości trasy bieżącego żądania .</span><span class="sxs-lookup"><span data-stu-id="85187-668">From the current request, routing accesses the route values of the current request `HttpContext.Request.RouteValues`.</span></span> <span data-ttu-id="85187-669">Wartości skojarzone z bieżącym żądaniem są określane jako **wartości otoczenia**.</span><span class="sxs-lookup"><span data-stu-id="85187-669">The values associated with the current request are referred to as the **ambient values**.</span></span> <span data-ttu-id="85187-670">Dla zapewnienia przejrzystości dokumentacja odnosi się do wartości trasy przekazywanych do metod jako **wartości jawne**.</span><span class="sxs-lookup"><span data-stu-id="85187-670">For the purpose of clarity, the documentation refers to the route values passed in to methods as **explicit values**.</span></span>

<span data-ttu-id="85187-671">Poniższy przykład pokazuje wartości otoczenia i jawne wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-671">The following example shows ambient values and explicit values.</span></span> <span data-ttu-id="85187-672">Zawiera wartości otoczenia z bieżącego `{ id = 17, }`żądania i wartości jawne: :</span><span class="sxs-lookup"><span data-stu-id="85187-672">It provides ambient values from the current request and explicit values: `{ id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet)]

<span data-ttu-id="85187-673">Powyższy kod ma następujące działanie:</span><span class="sxs-lookup"><span data-stu-id="85187-673">The preceding code:</span></span>

* <span data-ttu-id="85187-674">Zwraca`/Widget/Index/17`</span><span class="sxs-lookup"><span data-stu-id="85187-674">Returns `/Widget/Index/17`</span></span>
* <span data-ttu-id="85187-675">Pobiera <xref:Microsoft.AspNetCore.Routing.LinkGenerator> przez [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="85187-675">Gets <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="85187-676">Poniższy kod nie zawiera wartości `{ controller = "Home", action = "Subscribe", id = 17, }`otoczenia i wartości jawnych: :</span><span class="sxs-lookup"><span data-stu-id="85187-676">The following code provides no ambient values and explicit values: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet2)]

<span data-ttu-id="85187-677">Poprzednia metoda zwraca`/Home/Subscribe/17`</span><span class="sxs-lookup"><span data-stu-id="85187-677">The preceding  method returns `/Home/Subscribe/17`</span></span>

<span data-ttu-id="85187-678">Następujący kod w `WidgetController` `/Widget/Subscribe/17`zwraca:</span><span class="sxs-lookup"><span data-stu-id="85187-678">The following code in the `WidgetController` returns `/Widget/Subscribe/17`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet3)]

<span data-ttu-id="85187-679">Poniższy kod zapewnia kontroler z wartości otoczenia w `{ action = "Edit", id = 17, }`bieżącym żądaniu i jawne wartości: :</span><span class="sxs-lookup"><span data-stu-id="85187-679">The following code provides the controller from ambient values in the current request and explicit values: `{ action = "Edit", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/GadgetController.cs?name=snippet)]

<span data-ttu-id="85187-680">Powyższy kod ma następujące działanie:</span><span class="sxs-lookup"><span data-stu-id="85187-680">In the preceding code:</span></span>

* <span data-ttu-id="85187-681">`/Gadget/Edit/17`zostanie zwrócona.</span><span class="sxs-lookup"><span data-stu-id="85187-681">`/Gadget/Edit/17` is returned.</span></span>
* <span data-ttu-id="85187-682"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url>dostaje <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span><span class="sxs-lookup"><span data-stu-id="85187-682"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> gets the <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span></span>
* <xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*>   
<span data-ttu-id="85187-683">generuje adres URL ze ścieżką bezwzględną dla metody akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-683">generates a URL with an absolute path for an action method.</span></span> <span data-ttu-id="85187-684">Adres URL zawiera `action` określoną nazwę i `route` wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-684">The URL contains the specified `action` name and `route` values.</span></span>

<span data-ttu-id="85187-685">Poniższy kod zawiera wartości otoczenia z `{ page = "./Edit, id = 17, }`bieżącego żądania i wartości jawne: :</span><span class="sxs-lookup"><span data-stu-id="85187-685">The following code provides ambient values from the current request and explicit values: `{ page = "./Edit, id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Pages/Index.cshtml.cs?name=snippet)]

<span data-ttu-id="85187-686">Poprzedni kod ustawia `url` `/Edit/17` się, gdy strona Edytuj razor zawiera następującą dyrektywę strony:</span><span class="sxs-lookup"><span data-stu-id="85187-686">The preceding code sets `url` to  `/Edit/17` when the Edit Razor Page contains the following page directive:</span></span>

 `@page "{id:int}"`

<span data-ttu-id="85187-687">Jeśli strona Edytuj nie zawiera `"{id:int}"` szablonu `url` `/Edit?id=17`trasy, jest .</span><span class="sxs-lookup"><span data-stu-id="85187-687">If the Edit page doesn't contain the `"{id:int}"` route template, `url` is `/Edit?id=17`.</span></span>

<span data-ttu-id="85187-688">Zachowanie MVC <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> dodaje warstwę złożoności oprócz reguł opisanych tutaj:</span><span class="sxs-lookup"><span data-stu-id="85187-688">The behavior of MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> adds a layer of complexity in addition to the rules described here:</span></span>

* <span data-ttu-id="85187-689">`IUrlHelper`zawsze podaje wartości trasy z bieżącego żądania jako wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-689">`IUrlHelper` always provides the route values from the current request as ambient values.</span></span>
* <span data-ttu-id="85187-690">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) zawsze kopiuje bieżące `action` i `controller` routsycy wartości jako jawne wartości, chyba że zastąpione przez dewelopera.</span><span class="sxs-lookup"><span data-stu-id="85187-690">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) always copies the current `action` and `controller` route values as explicit values unless overridden by the developer.</span></span>
* <span data-ttu-id="85187-691">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) zawsze kopiuje bieżącą `page` wartość trasy jako wartość jawną, chyba że zostanie zastąpiona.</span><span class="sxs-lookup"><span data-stu-id="85187-691">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) always copies the current `page` route value as an explicit value unless overridden.</span></span> <!--by the user-->
* <span data-ttu-id="85187-692">`IUrlHelper.Page`zawsze zastępuje bieżącą `handler` wartość `null` trasy jako wartości jawne, chyba że zostanie zastąpiona.</span><span class="sxs-lookup"><span data-stu-id="85187-692">`IUrlHelper.Page` always overrides the current `handler` route value with `null` as an explicit values unless overridden.</span></span>

<span data-ttu-id="85187-693">Użytkownicy są często zaskoczeni behawioralne szczegóły wartości otoczenia, ponieważ MVC nie wydaje się przestrzegać własnych zasad.</span><span class="sxs-lookup"><span data-stu-id="85187-693">Users are often surprised by the behavioral details of ambient values, because MVC doesn't seem to follow its own rules.</span></span> <span data-ttu-id="85187-694">Ze względów historycznych i zgodności niektóre `action`wartości `controller` `page`trasy, `handler` takie jak , , i mają własne zachowanie specjalnego przypadku.</span><span class="sxs-lookup"><span data-stu-id="85187-694">For historical and compatibility reasons, certain route values such as `action`, `controller`, `page`, and `handler` have their own special-case behavior.</span></span>

<span data-ttu-id="85187-695">Równoważne funkcje `LinkGenerator.GetPathByAction` dostarczone `LinkGenerator.GetPathByPage` przez i powiela te anomalie `IUrlHelper` dla zgodności.</span><span class="sxs-lookup"><span data-stu-id="85187-695">The equivalent functionality provided by `LinkGenerator.GetPathByAction` and `LinkGenerator.GetPathByPage` duplicates these anomalies of `IUrlHelper` for compatibility.</span></span>

### <a name="url-generation-process"></a><span data-ttu-id="85187-696">Proces generowania adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-696">URL generation process</span></span>

<span data-ttu-id="85187-697">Po znalezieniu zestawu punktów końcowych kandydata algorytm generowania adresów URL:</span><span class="sxs-lookup"><span data-stu-id="85187-697">Once the set of candidate endpoints are found, the URL generation algorithm:</span></span>

* <span data-ttu-id="85187-698">Przetwarza punkty końcowe iteratively.</span><span class="sxs-lookup"><span data-stu-id="85187-698">Processes the endpoints iteratively.</span></span>
* <span data-ttu-id="85187-699">Zwraca pierwszy pomyślny wynik.</span><span class="sxs-lookup"><span data-stu-id="85187-699">Returns the first successful result.</span></span>

<span data-ttu-id="85187-700">Pierwszy krok w tym procesie jest nazywany **unieważnienie wartości trasy**.</span><span class="sxs-lookup"><span data-stu-id="85187-700">The first step in this process is called **route value invalidation**.</span></span>  <span data-ttu-id="85187-701">Unieważnienie wartości trasy jest procesem, w którym routing decyduje, które wartości trasy z wartości otoczenia powinny być używane, a które powinny być ignorowane.</span><span class="sxs-lookup"><span data-stu-id="85187-701">Route value invalidation is the process by which routing decides which route values from the ambient values should be used and which should be ignored.</span></span> <span data-ttu-id="85187-702">Każda wartość otoczenia jest brana pod uwagę i łączona z jawnymi wartościami lub ignorowana.</span><span class="sxs-lookup"><span data-stu-id="85187-702">Each ambient value is considered and either combined with the explicit values, or ignored.</span></span>

<span data-ttu-id="85187-703">Najlepszym sposobem, aby myśleć o roli wartości otoczenia jest, że próbują zapisać deweloperów aplikacji wpisując, w niektórych typowych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="85187-703">The best way to think about the role of ambient values is that they attempt to save application developers typing, in some common cases.</span></span> <span data-ttu-id="85187-704">Tradycyjnie scenariusze, w których wartości otoczenia są pomocne są związane z MVC:</span><span class="sxs-lookup"><span data-stu-id="85187-704">Traditionally, the scenarios where ambient values are helpful are related to MVC:</span></span>

* <span data-ttu-id="85187-705">Podczas łączenia z inną akcją w tym samym kontrolerze nie trzeba określać nazwy kontrolera.</span><span class="sxs-lookup"><span data-stu-id="85187-705">When linking to another action in the same controller, the controller name doesn't need to be specified.</span></span>
* <span data-ttu-id="85187-706">Podczas łączenia z innym kontrolerem w tym samym obszarze nie trzeba określać nazwy obszaru.</span><span class="sxs-lookup"><span data-stu-id="85187-706">When linking to another controller in the same area, the area name doesn't need to be specified.</span></span>
* <span data-ttu-id="85187-707">Podczas łączenia z tą samą metodą akcji nie trzeba określać wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-707">When linking to the same action method, route values don't need to be specified.</span></span>
* <span data-ttu-id="85187-708">Podczas łączenia z inną częścią aplikacji nie chcesz przenosić wartości trasy, które nie mają znaczenia w tej części aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-708">When linking to another part of the app, you don't want to carry over route values that have no meaning in that part of the app.</span></span>

<span data-ttu-id="85187-709">Wywołania `LinkGenerator` `IUrlHelper` lub `null` że powrót są zwykle spowodowane przez nie zrozumienie unieważnienia wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-709">Calls to `LinkGenerator` or `IUrlHelper` that return `null` are usually caused by not understanding route value invalidation.</span></span> <span data-ttu-id="85187-710">Rozwiązywanie problemów z unieważnieniem wartości trasy, jawnie określając więcej wartości trasy, aby sprawdzić, czy to rozwiązuje problem.</span><span class="sxs-lookup"><span data-stu-id="85187-710">Troubleshoot route value invalidation by explicitly specifying more of the route values to see if that solves the problem.</span></span>

<span data-ttu-id="85187-711">Unieważnienie wartości trasy działa przy założeniu, że schemat adresu URL aplikacji jest hierarchiczny, z hierarchią utworzoną od lewej do prawej.</span><span class="sxs-lookup"><span data-stu-id="85187-711">Route value invalidation works on the assumption that the app's URL scheme is hierarchical, with a hierarchy formed from left-to-right.</span></span> <span data-ttu-id="85187-712">Należy wziąć pod `{controller}/{action}/{id?}` uwagę szablon trasy kontrolera podstawowe, aby uzyskać intuicyjne poczucie, jak to działa w praktyce.</span><span class="sxs-lookup"><span data-stu-id="85187-712">Consider the basic controller route template `{controller}/{action}/{id?}` to get an intuitive sense of how this works in practice.</span></span> <span data-ttu-id="85187-713">**Zmiana** wartości **unieważnia** wszystkie wartości trasy, które pojawiają się po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="85187-713">A **change** to a value **invalidates** all of the route values that appear to the right.</span></span> <span data-ttu-id="85187-714">Odzwierciedla to założenie dotyczące hierarchii.</span><span class="sxs-lookup"><span data-stu-id="85187-714">This reflects the assumption about hierarchy.</span></span> <span data-ttu-id="85187-715">Jeśli aplikacja ma wartość `id`otoczenia dla , a operacja `controller`określa inną wartość dla :</span><span class="sxs-lookup"><span data-stu-id="85187-715">If the app has an ambient value for `id`, and the operation specifies a different value for the `controller`:</span></span>

* <span data-ttu-id="85187-716">`id`nie będzie ponownie nadużywane, ponieważ `{controller}` jest `{id?}`po lewej stronie .</span><span class="sxs-lookup"><span data-stu-id="85187-716">`id` won't be reused because `{controller}` is to the left of `{id?}`.</span></span>

<span data-ttu-id="85187-717">Kilka przykładów demonstrujących tę zasadę:</span><span class="sxs-lookup"><span data-stu-id="85187-717">Some examples demonstrating this principle:</span></span>

* <span data-ttu-id="85187-718">Jeśli jawne wartości zawierają `id`wartość dla `id` , wartość otoczenia dla jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="85187-718">If the explicit values contain a value for `id`, the ambient value for `id` is ignored.</span></span> <span data-ttu-id="85187-719">Wartości otoczenia `controller` `action` dla i mogą być używane.</span><span class="sxs-lookup"><span data-stu-id="85187-719">The ambient values for `controller` and `action` can be used.</span></span>
* <span data-ttu-id="85187-720">Jeśli wartości jawne zawierają `action`wartość dla `action` , każda wartość otoczenia dla jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="85187-720">If the explicit values contain a value for `action`, any ambient value for `action` is ignored.</span></span> <span data-ttu-id="85187-721">`controller` Można użyć wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-721">The ambient values for `controller` can be used.</span></span> <span data-ttu-id="85187-722">Jeśli jawna `action` wartość dla różni się `action`od `id` wartości otoczenia dla , wartość nie będzie używana.</span><span class="sxs-lookup"><span data-stu-id="85187-722">If the explicit value for `action` is different from the ambient value for `action`, the `id` value won't be used.</span></span>  <span data-ttu-id="85187-723">Jeśli jawna `action` wartość dla jest taka `action`sama `id` jak wartość otoczenia dla , można użyć wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-723">If the explicit value for `action` is the same as the ambient value for `action`, the `id` value can be used.</span></span>
* <span data-ttu-id="85187-724">Jeśli wartości jawne zawierają `controller`wartość dla `controller` , każda wartość otoczenia dla jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="85187-724">If the explicit values contain a value for `controller`, any ambient value for `controller` is ignored.</span></span> <span data-ttu-id="85187-725">Jeśli jawna `controller` wartość dla różni się `controller`od `action` `id` wartości otoczenia dla , i wartości nie będą używane.</span><span class="sxs-lookup"><span data-stu-id="85187-725">If the explicit value for `controller` is different from the ambient value for `controller`, the `action` and `id` values won't be used.</span></span> <span data-ttu-id="85187-726">Jeśli jawna `controller` wartość dla jest taka `controller`sama `action` jak `id` wartość otoczenia dla , i wartości mogą być używane.</span><span class="sxs-lookup"><span data-stu-id="85187-726">If the explicit value for `controller` is the same as the ambient value for `controller`, the `action` and `id` values can be used.</span></span>

<span data-ttu-id="85187-727">Proces ten dodatkowo komplikuje istnienie tras atrybutów i dedykowanych tras konwencjonalnych.</span><span class="sxs-lookup"><span data-stu-id="85187-727">This process is further complicated by the existence of attribute routes and dedicated conventional routes.</span></span> <span data-ttu-id="85187-728">Kontroler konwencjonalnych `{controller}/{action}/{id?}` tras, takich jak określenie hierarchii przy użyciu parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-728">Controller conventional routes such as `{controller}/{action}/{id?}` specify a hierarchy using route parameters.</span></span> <span data-ttu-id="85187-729">W przypadku [dedykowanych tras konwencjonalnych](xref:mvc/controllers/routing#dcr) i [tras atrybutów](xref:mvc/controllers/routing#ar) do kontrolerów i stron Razor:</span><span class="sxs-lookup"><span data-stu-id="85187-729">For [dedicated conventional routes](xref:mvc/controllers/routing#dcr) and [attribute routes](xref:mvc/controllers/routing#ar) to controllers and Razor Pages:</span></span>

* <span data-ttu-id="85187-730">Istnieje hierarchia wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-730">There is a hierarchy of route values.</span></span>
* <span data-ttu-id="85187-731">Nie są one wyświetlane w szablonie.</span><span class="sxs-lookup"><span data-stu-id="85187-731">They don't appear in the template.</span></span>

<span data-ttu-id="85187-732">W takich przypadkach generowanie adresu URL definiuje pojęcie **wymaganych wartości.**</span><span class="sxs-lookup"><span data-stu-id="85187-732">For these cases, URL generation defines the **required values** concept.</span></span> <span data-ttu-id="85187-733">Punkty końcowe utworzone przez kontrolery i strony Razor mają określone wymagane wartości, które umożliwiają unieważnienie wartości trasy do pracy.</span><span class="sxs-lookup"><span data-stu-id="85187-733">Endpoints created by controllers and Razor Pages have required values specified that allow route value invalidation to work.</span></span>

<span data-ttu-id="85187-734">Algorytm unieważnienia wartości trasy w szczegółach:</span><span class="sxs-lookup"><span data-stu-id="85187-734">The route value invalidation algorithm in detail:</span></span>

* <span data-ttu-id="85187-735">Wymagane nazwy wartości są łączone z parametrami trasy, a następnie przetwarzane od lewej do prawej.</span><span class="sxs-lookup"><span data-stu-id="85187-735">The required value names are combined with the route parameters, then processed from left-to-right.</span></span>
* <span data-ttu-id="85187-736">Dla każdego parametru porównywana jest wartość otoczenia i wartość jawna:</span><span class="sxs-lookup"><span data-stu-id="85187-736">For each parameter, the ambient value and explicit value are compared:</span></span>
    * <span data-ttu-id="85187-737">Jeśli wartość otoczenia i jawne wartości są takie same, proces jest kontynuowany.</span><span class="sxs-lookup"><span data-stu-id="85187-737">If the ambient value and explicit value are the same, the process continues.</span></span>
    * <span data-ttu-id="85187-738">Jeśli wartość otoczenia jest obecny, a jawna wartość nie jest, wartość otoczenia jest używana podczas generowania adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-738">If the ambient value is present and the explicit value isn't, the ambient value is used when generating the URL.</span></span>
    * <span data-ttu-id="85187-739">Jeśli wartość otoczenia nie jest obecny, a jawna wartość jest, odrzucić wartość otoczenia i wszystkie kolejne wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-739">If the ambient value isn't present and the explicit value is, reject the ambient value and all subsequent ambient values.</span></span>
    * <span data-ttu-id="85187-740">Jeśli wartość otoczenia i jawna wartość są obecne, a dwie wartości są różne, odrzucić wartość otoczenia i wszystkie kolejne wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-740">If the ambient value and the explicit value are present, and the two values are different, reject the ambient value and all subsequent ambient values.</span></span>

<span data-ttu-id="85187-741">W tym momencie operacja generowania adresów URL jest gotowa do oceny ograniczeń trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-741">At this point, the URL generation operation is ready to evaluate route constraints.</span></span> <span data-ttu-id="85187-742">Zestaw zaakceptowanych wartości jest łączony z wartościami domyślnymi parametru, który jest dostarczany do ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="85187-742">The set of accepted values is combined with the parameter default values, which is provided to constraints.</span></span> <span data-ttu-id="85187-743">Jeśli wszystkie ograniczenia przechodzą, operacja jest kontynuowana.</span><span class="sxs-lookup"><span data-stu-id="85187-743">If the constraints all pass, the operation continues.</span></span>

<span data-ttu-id="85187-744">Następnie **zaakceptowane wartości** mogą służyć do rozwijania szablonu trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-744">Next, the **accepted values** can be used to expand the route template.</span></span> <span data-ttu-id="85187-745">Szablon trasy jest przetwarzany:</span><span class="sxs-lookup"><span data-stu-id="85187-745">The route template is processed:</span></span>

* <span data-ttu-id="85187-746">Od lewej do prawej.</span><span class="sxs-lookup"><span data-stu-id="85187-746">From left-to-right.</span></span>
* <span data-ttu-id="85187-747">Każdy parametr ma swoją zaakceptowaną wartość podstawioną.</span><span class="sxs-lookup"><span data-stu-id="85187-747">Each parameter has its accepted value substituted.</span></span>
* <span data-ttu-id="85187-748">W następujących szczególnych przypadkach:</span><span class="sxs-lookup"><span data-stu-id="85187-748">With the following special cases:</span></span>
  * <span data-ttu-id="85187-749">Jeśli wartości akceptowane brakuje wartości i parametr ma wartość domyślną, używana jest wartość domyślna.</span><span class="sxs-lookup"><span data-stu-id="85187-749">If the accepted values is missing a value and the parameter has a default value, the default value is used.</span></span>
  * <span data-ttu-id="85187-750">Jeśli akceptowane wartości brakuje wartości i parametr jest opcjonalny, przetwarzanie jest kontynuowane.</span><span class="sxs-lookup"><span data-stu-id="85187-750">If the accepted values is missing a value and the parameter is optional, processing continues.</span></span>
  * <span data-ttu-id="85187-751">Jeśli dowolny parametr trasy po prawej stronie brakującego parametru opcjonalnego ma wartość, operacja zakończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="85187-751">If any route parameter to the right of a missing optional parameter has a value, the operation fails.</span></span>
  * <!-- review default-valued parameters optional parameters --> <span data-ttu-id="85187-752">Ciągłe parametry o wartości domyślnej i parametry opcjonalne są zwinięte tam, gdzie to możliwe.</span><span class="sxs-lookup"><span data-stu-id="85187-752">Contiguous default-valued parameters and optional parameters are collapsed where possible.</span></span>

<span data-ttu-id="85187-753">Wartości jawnie pod warunkiem, że nie pasują do segmentu trasy są dodawane do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="85187-753">Values explicitly provided that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="85187-754">W poniższej tabeli przedstawiono `{controller}/{action}/{id?}`wynik podczas korzystania z szablonu trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-754">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="85187-755">Wartości otoczenia</span><span class="sxs-lookup"><span data-stu-id="85187-755">Ambient Values</span></span>                     | <span data-ttu-id="85187-756">Wartości jawne</span><span class="sxs-lookup"><span data-stu-id="85187-756">Explicit Values</span></span>                        | <span data-ttu-id="85187-757">Wynik</span><span class="sxs-lookup"><span data-stu-id="85187-757">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="85187-758">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-758">controller = "Home"</span></span>                | <span data-ttu-id="85187-759">akcja = "Informacje"</span><span class="sxs-lookup"><span data-stu-id="85187-759">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="85187-760">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-760">controller = "Home"</span></span>                | <span data-ttu-id="85187-761">controller = "Kolejność", akcja = "O"</span><span class="sxs-lookup"><span data-stu-id="85187-761">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="85187-762">sterownik = "Home", kolor = "Czerwony"</span><span class="sxs-lookup"><span data-stu-id="85187-762">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="85187-763">akcja = "Informacje"</span><span class="sxs-lookup"><span data-stu-id="85187-763">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="85187-764">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-764">controller = "Home"</span></span>                | <span data-ttu-id="85187-765">akcja = "O", kolor = "Czerwony"</span><span class="sxs-lookup"><span data-stu-id="85187-765">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

### <a name="problems-with-route-value-invalidation"></a><span data-ttu-id="85187-766">Problemy z unieważnieniem wartości trasy</span><span class="sxs-lookup"><span data-stu-id="85187-766">Problems with route value invalidation</span></span>

<span data-ttu-id="85187-767">Od ASP.NET Core 3.0 niektóre schematy generowania adresów URL używane we wcześniejszych wersjach ASP.NET Core nie działają dobrze z generowaniem adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-767">As of ASP.NET Core 3.0, some URL generation schemes used in earlier ASP.NET Core versions don't work well with URL generation.</span></span> <span data-ttu-id="85187-768">Zespół ASP.NET Core planuje dodać funkcje, aby zaspokoić te potrzeby w przyszłej wersji.</span><span class="sxs-lookup"><span data-stu-id="85187-768">The ASP.NET Core team plans to add features to address these needs in a future release.</span></span> <span data-ttu-id="85187-769">Na razie najlepszym rozwiązaniem jest użycie starszego routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-769">For now the best solution is to use legacy routing.</span></span>

<span data-ttu-id="85187-770">Poniższy kod przedstawia przykład schematu generowania adresów URL, który nie jest obsługiwany przez routing.</span><span class="sxs-lookup"><span data-stu-id="85187-770">The following code shows an example of a URL generation scheme that's not supported by routing.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupUnsupported.cs?name=snippet)]

<span data-ttu-id="85187-771">W poprzednim kodzie `culture` parametr trasy jest używany do lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="85187-771">In the preceding code, the `culture` route parameter is used for localization.</span></span> <span data-ttu-id="85187-772">Pragnieniem jest, `culture` aby parametr był zawsze akceptowany jako wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-772">The desire is to have the `culture` parameter always accepted as an ambient value.</span></span> <span data-ttu-id="85187-773">Jednak `culture` parametr nie jest akceptowany jako wartość otoczenia ze względu na sposób działania wymaganych wartości:</span><span class="sxs-lookup"><span data-stu-id="85187-773">However, the `culture` parameter is not accepted as an ambient value because of the way required values work:</span></span>

* <span data-ttu-id="85187-774">W `"default"` szablonie trasy `culture` parametr trasy znajduje `controller`się po `controller` lewej stronie , `culture`więc zmiany nie unieważniają .</span><span class="sxs-lookup"><span data-stu-id="85187-774">In the `"default"` route template, the `culture` route parameter is to the left of `controller`, so changes to `controller` won't invalidate `culture`.</span></span>
* <span data-ttu-id="85187-775">W `"blog"` szablonie trasy `culture` parametr trasy jest uważany za `controller`prawy po prawej stronie , który pojawia się w wymaganych wartościach.</span><span class="sxs-lookup"><span data-stu-id="85187-775">In the `"blog"` route template, the `culture` route parameter is considered to be to the right of `controller`, which appears in the required values.</span></span>

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="85187-776">Konfigurowanie metadanych punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="85187-776">Configuring endpoint metadata</span></span>

<span data-ttu-id="85187-777">Poniższe łącza zawierają informacje dotyczące konfigurowania metadanych punktu końcowego:</span><span class="sxs-lookup"><span data-stu-id="85187-777">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="85187-778">Włącz cors z routingiem punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="85187-778">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="85187-779">[IAuthorizationPolicyProvider próbki](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) przy `[MinimumAgeAuthorize]` użyciu atrybutu niestandardowego</span><span class="sxs-lookup"><span data-stu-id="85187-779">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="85187-780">[Testowanie uwierzytelniania za pomocą atrybutu [Autoryzuj]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="85187-780">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="85187-781">[Wybieranie schematu za pomocą atrybutu [Autoryzuj]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="85187-781">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="85187-782">[Stosowanie zasad przy użyciu atrybutu [Autoryzuj]](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="85187-782">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="85187-783">Host dopasowywanie w trasach z RequireHost</span><span class="sxs-lookup"><span data-stu-id="85187-783">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="85187-784"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*>stosuje ograniczenie do trasy, która wymaga określonego hosta.</span><span class="sxs-lookup"><span data-stu-id="85187-784"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="85187-785">Parametrem `RequireHost` [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) może być:</span><span class="sxs-lookup"><span data-stu-id="85187-785">The `RequireHost` or [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) parameter can be:</span></span>

* <span data-ttu-id="85187-786">Host: `www.domain.com`, `www.domain.com` pasuje do dowolnego portu.</span><span class="sxs-lookup"><span data-stu-id="85187-786">Host: `www.domain.com`, matches `www.domain.com` with any port.</span></span>
* <span data-ttu-id="85187-787">Host z `*.domain.com`symbolami `www.domain.com`wieloznacznych: , mecze , `subdomain.domain.com`lub `www.subdomain.domain.com` na dowolnym porcie.</span><span class="sxs-lookup"><span data-stu-id="85187-787">Host with wildcard: `*.domain.com`, matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port.</span></span>
* <span data-ttu-id="85187-788">Port: `*:5000`, pasuje do portu 5000 z dowolnym hostem.</span><span class="sxs-lookup"><span data-stu-id="85187-788">Port: `*:5000`, matches port 5000 with any host.</span></span>
* <span data-ttu-id="85187-789">Host i `www.domain.com:5000` port: lub `*.domain.com:5000`, dopasowuje hosta i portu.</span><span class="sxs-lookup"><span data-stu-id="85187-789">Host and port: `www.domain.com:5000` or `*.domain.com:5000`, matches host and port.</span></span>

<span data-ttu-id="85187-790">Można określić wiele `RequireHost` `[Host]`parametrów za pomocą lub .</span><span class="sxs-lookup"><span data-stu-id="85187-790">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="85187-791">Ograniczenie dopasowuje hosty prawidłowe dla dowolnego z parametrów.</span><span class="sxs-lookup"><span data-stu-id="85187-791">The constraint  matches hosts valid for any of the parameters.</span></span> <span data-ttu-id="85187-792">Na przykład `[Host("domain.com", "*.domain.com")]` `domain.com`dopasowania `www.domain.com`, `subdomain.domain.com`i .</span><span class="sxs-lookup"><span data-stu-id="85187-792">For example, `[Host("domain.com", "*.domain.com")]` matches `domain.com`, `www.domain.com`, and `subdomain.domain.com`.</span></span>

<span data-ttu-id="85187-793">Następujący kod używa `RequireHost` do wymagania określonego hosta na trasie:</span><span class="sxs-lookup"><span data-stu-id="85187-793">The following code uses `RequireHost` to require the specified host on the route:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRequireHost.cs?name=snippet)]

<span data-ttu-id="85187-794">Poniższy kod używa `[Host]` atrybutu na kontrolerze, aby wymagać dowolnego z określonych hostów:</span><span class="sxs-lookup"><span data-stu-id="85187-794">The following code uses the `[Host]` attribute on the controller to require any of the specified hosts:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/ProductController.cs?name=snippet)]

<span data-ttu-id="85187-795">Gdy `[Host]` atrybut jest stosowany zarówno do kontrolera, jak i metody akcji:</span><span class="sxs-lookup"><span data-stu-id="85187-795">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="85187-796">Atrybut akcji jest używany.</span><span class="sxs-lookup"><span data-stu-id="85187-796">The attribute on the action is used.</span></span>
* <span data-ttu-id="85187-797">Atrybut kontrolera jest ignorowany.</span><span class="sxs-lookup"><span data-stu-id="85187-797">The controller attribute is ignored.</span></span>

## <a name="performance-guidance-for-routing"></a><span data-ttu-id="85187-798">Wskazówki dotyczące wydajności routingu</span><span class="sxs-lookup"><span data-stu-id="85187-798">Performance guidance for routing</span></span>

<span data-ttu-id="85187-799">Większość routingu została zaktualizowana w ASP.NET Core 3.0, aby zwiększyć wydajność.</span><span class="sxs-lookup"><span data-stu-id="85187-799">Most of routing was updated in ASP.NET Core 3.0 to increase performance.</span></span>

<span data-ttu-id="85187-800">Gdy aplikacja ma problemy z wydajnością, routing jest często podejrzewany jako problem.</span><span class="sxs-lookup"><span data-stu-id="85187-800">When an app has performance problems, routing is often suspected as the problem.</span></span> <span data-ttu-id="85187-801">Podejrzewa się, że routing przyczyny jest to, że struktury, takie jak kontrolery i Razor Pages raport ilość czasu spędzonego wewnątrz struktury w ich rejestrowania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="85187-801">The reason routing is suspected is that frameworks like controllers and Razor Pages report the amount of time spent inside the framework in their logging messages.</span></span> <span data-ttu-id="85187-802">Gdy istnieje znacząca różnica między czasem zgłoszonym przez kontrolerów a całkowitym czasem żądania:</span><span class="sxs-lookup"><span data-stu-id="85187-802">When there's a significant difference between the time reported by controllers and the total time of the request:</span></span>

* <span data-ttu-id="85187-803">Deweloperzy eliminują swój kod aplikacji jako źródło problemu.</span><span class="sxs-lookup"><span data-stu-id="85187-803">Developers eliminate their app code as the source of the problem.</span></span>
* <span data-ttu-id="85187-804">Często zakłada się, że routing jest przyczyną.</span><span class="sxs-lookup"><span data-stu-id="85187-804">It's common to assume routing is the cause.</span></span>

<span data-ttu-id="85187-805">Routing jest testowany pod względem wydajności przy użyciu tysięcy punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-805">Routing is performance tested using thousands of endpoints.</span></span> <span data-ttu-id="85187-806">Jest mało prawdopodobne, że typowa aplikacja napotka problem z wydajnością tylko przez zbyt duży.</span><span class="sxs-lookup"><span data-stu-id="85187-806">It's unlikely that a typical app will encounter a performance problem just by being too large.</span></span> <span data-ttu-id="85187-807">Najczęstszą główną przyczyną powolnej wydajności routingu jest zwykle źle zachowujące się niestandardowe oprogramowanie pośredniczące.</span><span class="sxs-lookup"><span data-stu-id="85187-807">The most common root cause of slow routing performance is usually a badly-behaving custom middleware.</span></span>

<span data-ttu-id="85187-808">W poniższym przykładzie kodu przedstawiono podstawową technikę zawężenia źródła opóźnienia:</span><span class="sxs-lookup"><span data-stu-id="85187-808">This following code sample demonstrates a basic technique for narrowing down the source of delay:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupDelay.cs?name=snippet)]

<span data-ttu-id="85187-809">Do routingu czasu:</span><span class="sxs-lookup"><span data-stu-id="85187-809">To time routing:</span></span>

* <span data-ttu-id="85187-810">Przeplot każdego oprogramowania pośredniczącego z kopią oprogramowania pośredniczącego chronometrażu pokazano w poprzednim kodzie.</span><span class="sxs-lookup"><span data-stu-id="85187-810">Interleave each middleware with a copy of the timing middleware shown in the preceding code.</span></span>
* <span data-ttu-id="85187-811">Dodaj unikatowy identyfikator, aby skorelować dane chronometrażu z kodem.</span><span class="sxs-lookup"><span data-stu-id="85187-811">Add a unique identifier to correlate the timing data with the code.</span></span>

<span data-ttu-id="85187-812">Jest to podstawowy sposób na zawężenie opóźnienia, gdy `10ms`jest to znaczące, na przykład, więcej niż .</span><span class="sxs-lookup"><span data-stu-id="85187-812">This is a basic way to narrow down the delay when it's significant, for example, more than `10ms`.</span></span>  <span data-ttu-id="85187-813">`Time 2` Odejmowanie `Time 1` od raportów `UseRouting` czasu spędzonego wewnątrz oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-813">Subtracting `Time 2` from `Time 1` reports the time spent inside the `UseRouting` middleware.</span></span>

<span data-ttu-id="85187-814">Poniższy kod używa bardziej kompaktowe podejście do poprzedniego kodu chronometrażu:</span><span class="sxs-lookup"><span data-stu-id="85187-814">The following code uses a more compact approach to the preceding timing code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippetSW)]

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippet)]

### <a name="potentially-expensive-routing-features"></a><span data-ttu-id="85187-815">Potencjalnie drogie funkcje routingu</span><span class="sxs-lookup"><span data-stu-id="85187-815">Potentially expensive routing features</span></span>

<span data-ttu-id="85187-816">Poniższa lista zawiera pewien wgląd w funkcje routingu, które są stosunkowo drogie w porównaniu z podstawowymi szablonami tras:</span><span class="sxs-lookup"><span data-stu-id="85187-816">The following list provides some insight into routing features that are relatively expensive compared with basic route templates:</span></span>

* <span data-ttu-id="85187-817">Wyrażenia regularne: Istnieje możliwość pisania wyrażeń regularnych, które są złożone lub mają długi czas pracy z niewielką ilością danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="85187-817">Regular expressions: It's possible to write regular expressions that are complex, or have long running time with a small amount of input.</span></span>

* <span data-ttu-id="85187-818">Segmenty złożone`{x}-{y}-{z}`( ):</span><span class="sxs-lookup"><span data-stu-id="85187-818">Complex segments (`{x}-{y}-{z}`):</span></span> 
  * <span data-ttu-id="85187-819">Są znacznie droższe niż analizowanie segmentu ścieżki zwykłego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-819">Are significantly more expensive than parsing a regular URL path segment.</span></span>
  * <span data-ttu-id="85187-820">Spowodować wiele więcej podciągów są przydzielane.</span><span class="sxs-lookup"><span data-stu-id="85187-820">Result in many more substrings being allocated.</span></span>
  * <span data-ttu-id="85187-821">Logika segmentu złożonego nie została zaktualizowana w aktualizacji wydajności routingu core 3.0 w ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="85187-821">The complex segment logic was not updated in ASP.NET Core 3.0 routing performance update.</span></span>

* <span data-ttu-id="85187-822">Synchroniczne dostęp do danych: wiele złożonych aplikacji ma dostęp do bazy danych w ramach routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-822">Synchronous data access: Many complex apps have database access as part of their routing.</span></span> <span data-ttu-id="85187-823">ASP.NET Core 2.2 i wcześniejsze routingu może nie zapewnić odpowiednich punktów rozszerzalności do obsługi routingu dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="85187-823">ASP.NET Core 2.2 and earlier routing might not provide the right extensibility points to support database access routing.</span></span> <span data-ttu-id="85187-824">Na przykład <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>i <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> są synchroniczne.</span><span class="sxs-lookup"><span data-stu-id="85187-824">For example, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, and <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> are synchronous.</span></span> <span data-ttu-id="85187-825">Punkty rozszerzalności, <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> takie <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> jak i są asynchroniczne.</span><span class="sxs-lookup"><span data-stu-id="85187-825">Extensibility points such as <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> and <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> are asynchronous.</span></span>

## <a name="guidance-for-library-authors"></a><span data-ttu-id="85187-826">Wskazówki dla autorów bibliotek</span><span class="sxs-lookup"><span data-stu-id="85187-826">Guidance for library authors</span></span>

<span data-ttu-id="85187-827">Ta sekcja zawiera wskazówki dla autorów biblioteki tworzących na routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-827">This section contains guidance for library authors building on top of routing.</span></span> <span data-ttu-id="85187-828">Te szczegóły mają na celu zapewnienie, że deweloperzy aplikacji mają dobre środowisko przy użyciu bibliotek i struktur, które rozszerzają routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-828">These details are intended to ensure that app developers have a good experience using libraries and frameworks that extend routing.</span></span>

### <a name="define-endpoints"></a><span data-ttu-id="85187-829">Definiowanie punktów końcowych</span><span class="sxs-lookup"><span data-stu-id="85187-829">Define endpoints</span></span>

<span data-ttu-id="85187-830">Aby utworzyć strukturę, która używa routingu do dopasowywania adresów <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>URL, zacznij od zdefiniowania środowiska użytkownika, które tworzy się na wierzchu programu .</span><span class="sxs-lookup"><span data-stu-id="85187-830">To create a framework that uses routing for URL matching, start by defining a user experience that builds on top of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>

<span data-ttu-id="85187-831">**Czy** budować na <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>szczycie .</span><span class="sxs-lookup"><span data-stu-id="85187-831">**DO** build on top of <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span> <span data-ttu-id="85187-832">Dzięki temu użytkownicy mogą skomponować strukturę z innymi funkcjami ASP.NET Core bez pomyłek.</span><span class="sxs-lookup"><span data-stu-id="85187-832">This allows users to compose your framework with other ASP.NET Core features without confusion.</span></span> <span data-ttu-id="85187-833">Każdy szablon ASP.NET Core zawiera routing.</span><span class="sxs-lookup"><span data-stu-id="85187-833">Every ASP.NET Core template includes routing.</span></span> <span data-ttu-id="85187-834">Załóżmy, że routing jest obecny i znany użytkownikom.</span><span class="sxs-lookup"><span data-stu-id="85187-834">Assume routing is present and familiar for users.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="85187-835">**DO** zwracać uszczelniony typ `MapMyFramework(...)` betonu <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>z wywołania do tego implementuje .</span><span class="sxs-lookup"><span data-stu-id="85187-835">**DO** return a sealed concrete type from a call to `MapMyFramework(...)` that implements <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span></span> <span data-ttu-id="85187-836">Większość `Map...` metod struktury postępuj zgodnie z tym wzorcem.</span><span class="sxs-lookup"><span data-stu-id="85187-836">Most framework `Map...` methods follow this pattern.</span></span> <span data-ttu-id="85187-837">Interfejs: `IEndpointConventionBuilder`</span><span class="sxs-lookup"><span data-stu-id="85187-837">The `IEndpointConventionBuilder` interface:</span></span>

* <span data-ttu-id="85187-838">Umożliwia możliwość komponowania metadanych.</span><span class="sxs-lookup"><span data-stu-id="85187-838">Allows composability of metadata.</span></span>
* <span data-ttu-id="85187-839">Jest przeznaczony przez różne metody rozszerzenia.</span><span class="sxs-lookup"><span data-stu-id="85187-839">Is targeted by a variety of extension methods.</span></span>

<span data-ttu-id="85187-840">Deklarowanie własnego typu umożliwia dodanie własnych funkcji specyficznych dla struktury do konstruktora.</span><span class="sxs-lookup"><span data-stu-id="85187-840">Declaring your own type allows you to add your own framework-specific functionality to the builder.</span></span> <span data-ttu-id="85187-841">Jest ok, aby zawinąć konstruktora zadeklarowanego przez framework i przekazywać do niego wywołania.</span><span class="sxs-lookup"><span data-stu-id="85187-841">It's ok to wrap a framework-declared builder and forward calls to it.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization()
                                 .WithMyFrameworkFeature(awesome: true);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="85187-842">**ROZWAŻ** napisanie <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>własnego .</span><span class="sxs-lookup"><span data-stu-id="85187-842">**CONSIDER** writing your own <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span></span> <span data-ttu-id="85187-843">`EndpointDataSource`jest niskim poziomie prymitywne do deklarowania i aktualizowania kolekcji punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-843">`EndpointDataSource` is the low-level primitive for declaring and updating a collection of endpoints.</span></span> <span data-ttu-id="85187-844">`EndpointDataSource`to potężny interfejs API używany przez kontrolery i strony Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-844">`EndpointDataSource` is a powerful API used by controllers and Razor Pages.</span></span>

<span data-ttu-id="85187-845">Testy routingu mają [podstawowy przykład](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) nieaktuacyjnego źródła danych.</span><span class="sxs-lookup"><span data-stu-id="85187-845">The routing tests have a [basic example](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) of a non-updating data source.</span></span>

<span data-ttu-id="85187-846">**NIE** próbuj domyślnie `EndpointDataSource` zarejestrować.</span><span class="sxs-lookup"><span data-stu-id="85187-846">**DO NOT** attempt to register an `EndpointDataSource` by default.</span></span> <span data-ttu-id="85187-847">Wymagaj od użytkowników, <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>aby zarejestrowali swoją strukturę w .</span><span class="sxs-lookup"><span data-stu-id="85187-847">Require users to register your framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span> <span data-ttu-id="85187-848">Filozofia routingu jest to, że nic `UseEndpoints` nie jest domyślnie uwzględnione i to jest miejsce do rejestrowania punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-848">The philosophy of routing is that nothing is included by default, and that `UseEndpoints` is the place to register endpoints.</span></span>

### <a name="creating-routing-integrated-middleware"></a><span data-ttu-id="85187-849">Tworzenie oprogramowania pośredniczącego zintegrowanego z routingu</span><span class="sxs-lookup"><span data-stu-id="85187-849">Creating routing-integrated middleware</span></span>

<span data-ttu-id="85187-850">**NALEŻY ROZWAŻYĆ** definiowanie typów metadanych jako interfejsu.</span><span class="sxs-lookup"><span data-stu-id="85187-850">**CONSIDER** defining metadata types as an interface.</span></span>

<span data-ttu-id="85187-851">**DO** umożliwiają użycie typów metadanych jako atrybutu klas i metod.</span><span class="sxs-lookup"><span data-stu-id="85187-851">**DO** make it possible to use metadata types as an attribute on classes and methods.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet2)]

<span data-ttu-id="85187-852">Struktury, takie jak kontrolery i strony Razor obsługują stosowanie atrybutów metadanych do typów i metod.</span><span class="sxs-lookup"><span data-stu-id="85187-852">Frameworks like controllers and Razor Pages support applying metadata attributes to types and methods.</span></span> <span data-ttu-id="85187-853">Jeśli zde zadeklarowasz typy metadanych:</span><span class="sxs-lookup"><span data-stu-id="85187-853">If you declare metadata types:</span></span>

* <span data-ttu-id="85187-854">Udostępnij je jako [atrybuty](/dotnet/csharp/programming-guide/concepts/attributes/).</span><span class="sxs-lookup"><span data-stu-id="85187-854">Make them accessible as [attributes](/dotnet/csharp/programming-guide/concepts/attributes/).</span></span>
* <span data-ttu-id="85187-855">Większość użytkowników jest zaznajomiona z zastosowaniem atrybutów.</span><span class="sxs-lookup"><span data-stu-id="85187-855">Most users are familiar with applying attributes.</span></span>

<span data-ttu-id="85187-856">Deklarowanie typu metadanych jako interfejsu dodaje kolejną warstwę elastyczności:</span><span class="sxs-lookup"><span data-stu-id="85187-856">Declaring a metadata type as an interface adds another layer of flexibility:</span></span>

* <span data-ttu-id="85187-857">Interfejsy można komponować.</span><span class="sxs-lookup"><span data-stu-id="85187-857">Interfaces are composable.</span></span>
* <span data-ttu-id="85187-858">Deweloperzy mogą deklarować własne typy, które łączą wiele zasad.</span><span class="sxs-lookup"><span data-stu-id="85187-858">Developers can declare their own types that combine multiple policies.</span></span>

<span data-ttu-id="85187-859">**DO** umożliwiają zastąpienie metadanych, jak pokazano w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="85187-859">**DO** make it possible to override metadata, as shown in the following example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet)]

<span data-ttu-id="85187-860">Najlepszym sposobem, aby postępować zgodnie z tymi wytycznymi jest uniknięcie definiowania **metadanych znaczników:**</span><span class="sxs-lookup"><span data-stu-id="85187-860">The best way to follow these guidelines is to avoid defining **marker metadata**:</span></span>

* <span data-ttu-id="85187-861">Nie tylko szukać obecności typu metadanych.</span><span class="sxs-lookup"><span data-stu-id="85187-861">Don't just look for the presence of a metadata type.</span></span>
* <span data-ttu-id="85187-862">Zdefiniuj właściwość na metadanych i sprawdź właściwość.</span><span class="sxs-lookup"><span data-stu-id="85187-862">Define a property on the metadata and check the property.</span></span>

<span data-ttu-id="85187-863">Kolekcja metadanych jest uporządkowana i obsługuje zastępowanie według priorytetu.</span><span class="sxs-lookup"><span data-stu-id="85187-863">The metadata collection is ordered and supports overriding by priority.</span></span> <span data-ttu-id="85187-864">W przypadku kontrolerów metadane metody akcji są najbardziej szczegółowe.</span><span class="sxs-lookup"><span data-stu-id="85187-864">In the case of controllers, metadata on the action method is most specific.</span></span>

<span data-ttu-id="85187-865">**CZY** oprogramowanie pośredniczące przydatne z i bez routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-865">**DO** make middleware useful with and without routing.</span></span>

```csharp
app.UseRouting();

app.UseAuthorization(new AuthorizationPolicy() { ... });

app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization();
});
```

<span data-ttu-id="85187-866">Jako przykład tej wytycznej należy `UseAuthorization` wziąć pod uwagę oprogramowanie pośredniczące.</span><span class="sxs-lookup"><span data-stu-id="85187-866">As an example of this guideline, consider the `UseAuthorization` middleware.</span></span> <span data-ttu-id="85187-867">Oprogramowanie pośredniczące autoryzacji umożliwia przekazywanie w zasadach rezerwowych.</span><span class="sxs-lookup"><span data-stu-id="85187-867">The authorization middleware allows you to pass in a fallback policy.</span></span> <!-- shown where?  (shown here) --> <span data-ttu-id="85187-868">Zasady rezerwowe, jeśli są określone, mają zastosowanie do obu:</span><span class="sxs-lookup"><span data-stu-id="85187-868">The fallback policy, if specified, applies to both:</span></span>

* <span data-ttu-id="85187-869">Punkty końcowe bez określonych zasad.</span><span class="sxs-lookup"><span data-stu-id="85187-869">Endpoints without a specified policy.</span></span>
* <span data-ttu-id="85187-870">Żądania, które nie pasują do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-870">Requests that don't match an endpoint.</span></span>

<span data-ttu-id="85187-871">Dzięki temu oprogramowanie pośredniczące autoryzacji jest przydatne poza kontekstem routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-871">This makes the authorization middleware useful outside of the context of routing.</span></span> <span data-ttu-id="85187-872">Oprogramowanie pośredniczące autoryzacji może być używane do programowania tradycyjnego oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-872">The authorization middleware can be used for traditional middleware programming.</span></span>

[!INCLUDE[](~/includes/dbg-route.md)]

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="85187-873">Routing jest odpowiedzialny za mapowanie identyfikatorów URI żądań do punktów końcowych i wysyłanie żądań przychodzących do tych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-873">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="85187-874">Trasy są definiowane w aplikacji i konfigurowane po uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-874">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="85187-875">Trasa może opcjonalnie wyodrębnić wartości z adresu URL zawartego w żądaniu, a te wartości mogą być następnie używane do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="85187-875">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="85187-876">Korzystając z informacji o trasie z aplikacji, routing jest również w stanie wygenerować adresy URL, które mapują do punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="85187-876">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="85187-877">Aby użyć najnowszych scenariuszy routingu w ASP.NET Core 2.2, określ [wersję](xref:mvc/compatibility-version) zgodności `Startup.ConfigureServices`z rejestracją usług MVC w:</span><span class="sxs-lookup"><span data-stu-id="85187-877">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="85187-878">Opcja <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> określa, czy routing powinien wewnętrznie używać logiki <xref:Microsoft.AspNetCore.Routing.IRouter>opartej na punkcie końcowym lub logiki opartej na ASP.NET Core 2.1 lub wcześniejszej.</span><span class="sxs-lookup"><span data-stu-id="85187-878">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="85187-879">Gdy wersja zgodności jest ustawiona na 2.2 lub `true`nowszą, wartością domyślną jest .</span><span class="sxs-lookup"><span data-stu-id="85187-879">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="85187-880">Ustaw wartość, `false` aby użyć wcześniejszej logiki routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-880">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="85187-881">Aby uzyskać <xref:Microsoft.AspNetCore.Routing.IRouter>więcej informacji na temat routingu opartego na tym temacie, zobacz [ASP.NET wersja core 2.1 tego tematu](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="85187-881">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="85187-882">Ten dokument obejmuje routing ASP.NET niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="85187-882">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="85187-883">Aby uzyskać informacje na temat ASP.NET routingu Core MVC, zobacz <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="85187-883">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="85187-884">Aby uzyskać informacje na temat konwencji routingu na stronach Razor Pages, zobacz <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="85187-884">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="85187-885">[Wyświetl lub pobierz przykładowy kod](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([jak pobrać](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="85187-885">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="85187-886">Podstawowe informacje o routingu</span><span class="sxs-lookup"><span data-stu-id="85187-886">Routing basics</span></span>

<span data-ttu-id="85187-887">Większość aplikacji powinna wybrać podstawowy i opisowy schemat routingu, aby adresy URL były czytelne i znaczące.</span><span class="sxs-lookup"><span data-stu-id="85187-887">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="85187-888">Domyślna trasa `{controller=Home}/{action=Index}/{id?}`konwencjonalna:</span><span class="sxs-lookup"><span data-stu-id="85187-888">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="85187-889">Obsługuje podstawowy i opisowy schemat routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-889">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="85187-890">Jest użytecznym punktem wyjścia dla aplikacji opartych na interfejsie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="85187-890">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="85187-891">Deweloperzy często dodają dodatkowe trasy terse do obszarów o dużym natężeniu ruchu aplikacji w sytuacjach specjalistycznych przy użyciu [routingu atrybutów](xref:mvc/controllers/routing#attribute-routing) lub dedykowanych tras konwencjonalnych.</span><span class="sxs-lookup"><span data-stu-id="85187-891">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span> <span data-ttu-id="85187-892">Przykłady sytuacji specjalistycznych obejmują punkty końcowe bloga i e-commerce.</span><span class="sxs-lookup"><span data-stu-id="85187-892">Specialized situations examples include, blog and ecommerce endpoints.</span></span>

<span data-ttu-id="85187-893">Interfejsy API sieci Web powinny używać routingu atrybutów do modelowania funkcji aplikacji jako zestawu zasobów, w których operacje są reprezentowane przez zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-893">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="85187-894">Oznacza to, że wiele operacji, na przykład GET i POST, na tym samym zasobie logicznym używać tego samego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-894">This means that many operations, for example, GET, and POST, on the same logical resource use the same URL.</span></span> <span data-ttu-id="85187-895">Routing atrybutów zapewnia poziom kontroli, który jest potrzebny do starannego projektowania układu publicznego punktu końcowego interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="85187-895">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="85187-896">Aplikacje Razor Pages używają domyślnego routingu konwencjonalnego do obsługi nazwanych zasobów w folderze *Strony* aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-896">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="85187-897">Dostępne są dodatkowe konwencje, które umożliwiają dostosowanie zachowania routingu stron Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-897">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="85187-898">Aby uzyskać więcej informacji, zobacz <xref:razor-pages/index> i <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="85187-898">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="85187-899">Obsługa generowania adresów URL umożliwia tworzenie aplikacji bez twardych adresów URL kodowania, aby połączyć aplikację ze sobą.</span><span class="sxs-lookup"><span data-stu-id="85187-899">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="85187-900">Ta obsługa umożliwia rozpoczęcie podstawowej konfiguracji routingu i modyfikowanie tras po określeniu układu zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-900">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="85187-901">Routing używa *punktów* końcowych`Endpoint`( ) do reprezentowania logicznych punktów końcowych w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-901">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="85187-902">Punkt końcowy definiuje delegata do przetwarzania żądań i zbiór dowolnych metadanych.</span><span class="sxs-lookup"><span data-stu-id="85187-902">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="85187-903">Metadane są używane implementują przekrojowe problemy oparte na zasadach i konfiguracji dołączonej do każdego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-903">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="85187-904">System wyznaczania tras ma następujące właściwości:</span><span class="sxs-lookup"><span data-stu-id="85187-904">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="85187-905">Składnia szablonu trasy służy do definiowania tras z tokenizowanymi parametrami trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-905">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="85187-906">Konfiguracja punktu końcowego w stylu konwencjonalnym i atrybutu jest dozwolona.</span><span class="sxs-lookup"><span data-stu-id="85187-906">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="85187-907"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint>służy do określenia, czy parametr URL zawiera prawidłową wartość dla danego ograniczenia punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-907"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="85187-908">Modele aplikacji, takie jak MVC/Razor Pages, rejestrują wszystkie swoje punkty końcowe, które mają przewidywalną implementację scenariuszy routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-908">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="85187-909">Implementacja routingu sprawia, że decyzje routingu w dowolnym miejscu w potoku oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-909">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="85187-910">Oprogramowanie pośredniczące, które pojawia się po oprogramowaniu pośredniczącym routingu można sprawdzić wynik decyzji punktu końcowego oprogramowania pośredniczącego routingu dla danego identyfikatora URI żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-910">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="85187-911">Jest możliwe do wyliczenia wszystkich punktów końcowych w aplikacji w dowolnym miejscu w potoku oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="85187-911">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="85187-912">Aplikacja może używać routingu do generowania adresów URL (na przykład przekierowania lub łączy) na podstawie informacji o punkcie końcowym, a tym samym unikać zakodowanych adresów URL, co pomaga w utrzymaniu.</span><span class="sxs-lookup"><span data-stu-id="85187-912">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="85187-913">Generowanie adresów URL opiera się na adresach, które obsługują dowolną rozszerzalność:</span><span class="sxs-lookup"><span data-stu-id="85187-913">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="85187-914">Interfejs API generatora łączy (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) można rozpoznać w dowolnym miejscu za pomocą [iniekcji zależności (DI)](xref:fundamentals/dependency-injection) do generowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-914">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="85187-915">Jeśli interfejs API generatora łączy nie <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> jest dostępny za pośrednictwem di, oferuje metody tworzenia adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-915">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="85187-916">Wraz z wydaniem routingu punktu końcowego w ASP.NET Core 2.2 łączenie punktów końcowych jest ograniczone do akcji i stron stron MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="85187-916">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="85187-917">Rozszerzenia możliwości łączenia punktów końcowych są planowane dla przyszłych wydań.</span><span class="sxs-lookup"><span data-stu-id="85187-917">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="85187-918">Routing jest połączony z potoku <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> [oprogramowania pośredniczącego](xref:fundamentals/middleware/index) przez klasę.</span><span class="sxs-lookup"><span data-stu-id="85187-918">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="85187-919">[ASP.NET Core MVC](xref:mvc/overview) dodaje routing do potoku oprogramowania pośredniczącego w ramach swojej konfiguracji i obsługuje routing w aplikacjach MVC i Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="85187-919">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="85187-920">Aby dowiedzieć się, jak używać routingu jako składnika autonomicznego, zobacz sekcję [Użyj oprogramowania pośredniczącego routingu.](#use-routing-middleware)</span><span class="sxs-lookup"><span data-stu-id="85187-920">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="85187-921">Dopasowywanie adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-921">URL matching</span></span>

<span data-ttu-id="85187-922">Dopasowywanie adresów URL jest procesem, w którym routing wysyła żądanie przychodzące do *punktu końcowego*.</span><span class="sxs-lookup"><span data-stu-id="85187-922">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="85187-923">Ten proces jest oparty na danych w ścieżce adresu URL, ale można go rozszerzyć, aby uwzględnić wszystkie dane w żądaniu.</span><span class="sxs-lookup"><span data-stu-id="85187-923">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="85187-924">Możliwość wysyłania żądań do oddzielnych programów obsługi jest kluczem do skalowania rozmiaru i złożoności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-924">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="85187-925">System routingu w routingu punktu końcowego jest odpowiedzialny za wszystkie decyzje dotyczące wysyłki.</span><span class="sxs-lookup"><span data-stu-id="85187-925">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="85187-926">Ponieważ oprogramowanie pośredniczące stosuje zasady oparte na wybranym punkcie końcowym, ważne jest, aby każda decyzja, która może mieć wpływ na wysyłkę lub stosowanie zasad zabezpieczeń, została podjęta wewnątrz systemu routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-926">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="85187-927">Po wykonaniu delegata punktu końcowego właściwości [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) są ustawione na odpowiednie wartości na podstawie przetwarzania żądań wykonywane do tej pory.</span><span class="sxs-lookup"><span data-stu-id="85187-927">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="85187-928">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) jest słownikiem *wartości trasy* wytwarzanych z trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-928">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="85187-929">Wartości te są zwykle określane przez tokenizacji adresu URL i może służyć do akceptowania danych wejściowych użytkownika lub do podejmowania dalszych decyzji wysyłki wewnątrz aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-929">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="85187-930">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) jest workiem właściwości dodatkowych danych związanych z dopasowaną trasą.</span><span class="sxs-lookup"><span data-stu-id="85187-930">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="85187-931"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*>są dostarczane do obsługi kojarzenia danych o stanie z każdej trasy, dzięki czemu aplikacja może podejmować decyzje na podstawie trasy dopasowane.</span><span class="sxs-lookup"><span data-stu-id="85187-931"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="85187-932">Te wartości są zdefiniowane przez dewelopera i **nie** wpływają na zachowanie routingu w żaden sposób.</span><span class="sxs-lookup"><span data-stu-id="85187-932">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="85187-933">Ponadto wartości ukryte w [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) mogą być dowolnego typu, w przeciwieństwie do [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), które muszą być konwertowane do i z ciągów.</span><span class="sxs-lookup"><span data-stu-id="85187-933">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="85187-934">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) to lista tras, które brały udział w pomyślnym dopasowaniu żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-934">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="85187-935">Trasy mogą być zagnieżdżone wewnątrz siebie.</span><span class="sxs-lookup"><span data-stu-id="85187-935">Routes can be nested inside of one another.</span></span> <span data-ttu-id="85187-936">Właściwość <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odzwierciedla ścieżkę przez drzewo logiczne tras, które doprowadziły do dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-936">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="85187-937">Ogólnie rzecz biorąc pierwszy <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> element w jest zbieranie trasy i powinny być używane do generowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-937">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="85187-938">Ostatni element <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> w jest program obsługi marszruty, który pasuje.</span><span class="sxs-lookup"><span data-stu-id="85187-938">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="85187-939">Generowanie adresów URL za pomocą linkgeneratora</span><span class="sxs-lookup"><span data-stu-id="85187-939">URL generation with LinkGenerator</span></span>

<span data-ttu-id="85187-940">Generowanie adresów URL to proces, w którym routing może tworzyć ścieżkę adresu URL na podstawie zestawu wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-940">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="85187-941">Pozwala to na logiczne oddzielenie punktów końcowych i adresów URL, które uzyskują do nich dostęp.</span><span class="sxs-lookup"><span data-stu-id="85187-941">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="85187-942">Routing punktu końcowego obejmuje<xref:Microsoft.AspNetCore.Routing.LinkGenerator>interfejs API generatora łączy ( ).</span><span class="sxs-lookup"><span data-stu-id="85187-942">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="85187-943"><xref:Microsoft.AspNetCore.Routing.LinkGenerator>jest usługą singleton, którą można pobrać z [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="85187-943"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="85187-944">Interfejs API może służyć poza kontekstem żądania wykonywania.</span><span class="sxs-lookup"><span data-stu-id="85187-944">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="85187-945">MVC <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> i scenariusze, które <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>opierają się na , takich jak [Pomocników tagów,](xref:mvc/views/tag-helpers/intro)Pomocników HTML i [wyniki akcji](xref:mvc/controllers/actions), użyj generatora łączy, aby zapewnić możliwości generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-945">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="85187-946">Generator łączy jest wspierany przez koncepcję systemów *adresów* i *adresów*.</span><span class="sxs-lookup"><span data-stu-id="85187-946">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="85187-947">Schemat adresów jest sposobem określania punktów końcowych, które powinny być brane pod uwagę dla generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-947">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="85187-948">Na przykład scenariusze wartości nazwy trasy i trasy, które wielu użytkowników zna ze stron MVC/Razor, są implementowane jako schemat adresowy.</span><span class="sxs-lookup"><span data-stu-id="85187-948">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="85187-949">Generator łączy może łączyć się z akcjami i stronami MVC/Razor Pages za pomocą następujących metod rozszerzenia:</span><span class="sxs-lookup"><span data-stu-id="85187-949">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="85187-950">Przeciążenie tych metod akceptuje argumenty, `HttpContext`które zawierają .</span><span class="sxs-lookup"><span data-stu-id="85187-950">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="85187-951">Metody te są funkcjonalnie równoważne `Url.Action` i `Url.Page` oferują dodatkową elastyczność i opcje.</span><span class="sxs-lookup"><span data-stu-id="85187-951">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="85187-952">Metody `GetPath*` są najbardziej `Url.Action` podobne `Url.Page` do i w tym generują identyfikator URI zawierający ścieżkę bezwzględną.</span><span class="sxs-lookup"><span data-stu-id="85187-952">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="85187-953">Metody `GetUri*` zawsze generują bezwzględny identyfikator URI zawierający schemat i host.</span><span class="sxs-lookup"><span data-stu-id="85187-953">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="85187-954">Metody, które `HttpContext` akceptują generowanie identyfikatora URI w kontekście żądania wykonywania.</span><span class="sxs-lookup"><span data-stu-id="85187-954">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="85187-955">Wartości trasy otoczenia, ścieżka bazowa adresu URL, schemat i host z żądania wykonywania są używane, chyba że zostaną zastąpione.</span><span class="sxs-lookup"><span data-stu-id="85187-955">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="85187-956"><xref:Microsoft.AspNetCore.Routing.LinkGenerator>nazywa się z adresem.</span><span class="sxs-lookup"><span data-stu-id="85187-956"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="85187-957">Generowanie identyfikatora URI odbywa się w dwóch etapach:</span><span class="sxs-lookup"><span data-stu-id="85187-957">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="85187-958">Adres jest powiązany z listą punktów końcowych, które pasują do adresu.</span><span class="sxs-lookup"><span data-stu-id="85187-958">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="85187-959">Każdy punkt końcowy `RoutePattern` jest obliczany, dopóki nie zostanie znaleziony wzorzec trasy, który pasuje do podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-959">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="85187-960">Wynikowe wyjście jest łączone z innymi częściami URI dostarczonymi do generatora łączy i zwróconymi.</span><span class="sxs-lookup"><span data-stu-id="85187-960">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="85187-961">Metody zapewniane <xref:Microsoft.AspNetCore.Routing.LinkGenerator> przez obsługę standardowych możliwości generowania łączy dla dowolnego typu adresu.</span><span class="sxs-lookup"><span data-stu-id="85187-961">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="85187-962">Najwygodniejszym sposobem użycia generatora łączy są metody rozszerzenia, które wykonują operacje dla określonego typu adresu.</span><span class="sxs-lookup"><span data-stu-id="85187-962">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="85187-963">Metoda rozszerzenia</span><span class="sxs-lookup"><span data-stu-id="85187-963">Extension Method</span></span>   | <span data-ttu-id="85187-964">Opis</span><span class="sxs-lookup"><span data-stu-id="85187-964">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="85187-965">Generuje identyfikator URI ze ścieżką bezwzględną na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-965">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="85187-966">Generuje bezwzględny identyfikator URI na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-966">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="85187-967">Należy zwrócić uwagę na następujące <xref:Microsoft.AspNetCore.Routing.LinkGenerator> implikacje metod wywoływania:</span><span class="sxs-lookup"><span data-stu-id="85187-967">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="85187-968">Użyj `GetUri*` metod rozszerzenia z ostrożnością w konfiguracji aplikacji, która nie sprawdza poprawności `Host` nagłówka żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="85187-968">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="85187-969">Jeśli `Host` nagłówek żądań przychodzących nie jest zweryfikowany, niezaufane dane wejściowe żądania mogą być wysyłane z powrotem do klienta w identyfikatorach URI w widoku/stronie.</span><span class="sxs-lookup"><span data-stu-id="85187-969">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="85187-970">Zaleca się, aby wszystkie aplikacje produkcyjne `Host` skonfigurować swój serwer, aby sprawdzić poprawność nagłówka względem znanych prawidłowych wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-970">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="85187-971">Należy <xref:Microsoft.AspNetCore.Routing.LinkGenerator> zachować ostrożność w `Map` oprogramowaniu pośredniczącym w połączeniu z programem lub . `MapWhen`</span><span class="sxs-lookup"><span data-stu-id="85187-971">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="85187-972">`Map*`zmienia ścieżkę podstawową żądania wykonywania, co wpływa na dane wyjściowe generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-972">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="85187-973">Wszystkie interfejsy <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API umożliwiają określanie ścieżki podstawowej.</span><span class="sxs-lookup"><span data-stu-id="85187-973">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="85187-974">Zawsze należy określić pustą `Map*`ścieżkę bazową, aby cofnąć wpływ na generowanie łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-974">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="85187-975">Różnice w stosunku do wcześniejszych wersji routingu</span><span class="sxs-lookup"><span data-stu-id="85187-975">Differences from earlier versions of routing</span></span>

<span data-ttu-id="85187-976">Istnieje kilka różnic między routingiem punktu końcowego w ASP.NET Core 2.2 lub nowszych i wcześniejszych wersjach routingu w ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="85187-976">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="85187-977">System routingu punktu końcowego <xref:Microsoft.AspNetCore.Routing.IRouter>nie obsługuje rozszerzalności opartej <xref:Microsoft.AspNetCore.Routing.Route>na punktach końcowych, w tym dziedziczenia po .</span><span class="sxs-lookup"><span data-stu-id="85187-977">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="85187-978">Routing punktu końcowego nie obsługuje [programu WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="85187-978">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="85187-979">Użyj [wersji zgodności 2.1](xref:mvc/compatibility-version) `.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`( ), aby kontynuować korzystanie z podkładki zgodności.</span><span class="sxs-lookup"><span data-stu-id="85187-979">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="85187-980">Routing punktu końcowego ma inne zachowanie dla wielkości liter y wygenerowane identyfikatory URI podczas korzystania z konwencjonalnych tras.</span><span class="sxs-lookup"><span data-stu-id="85187-980">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="85187-981">Rozważmy następujący domyślny szablon trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-981">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="85187-982">Załóżmy, że łącze do akcji jest generowane przy użyciu następującej trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-982">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="85187-983">Za <xref:Microsoft.AspNetCore.Routing.IRouter>pomocą routingu opartego na tym `/blog/ReadPost/17`kodzie generuje identyfikator URI , który respektuje wielkość liter podanej wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-983">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="85187-984">Routing punktu końcowego w ASP.NET core 2.2 `/Blog/ReadPost/17` lub nowszych produkuje ("Blog" jest kapitalizowany).</span><span class="sxs-lookup"><span data-stu-id="85187-984">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="85187-985">Routing punktu końcowego `IOutboundParameterTransformer` udostępnia interfejs, który może służyć do dostosowywania tego zachowania globalnie lub do stosowania różnych konwencji do mapowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-985">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="85187-986">Aby uzyskać więcej informacji, zobacz [sekcję Odwołanie do transformatora parametrów.](#parameter-transformer-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-986">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="85187-987">Generowanie łączy używane przez strony MVC/Razor ze konwencjonalnymi trasami zachowuje się inaczej podczas próby połączenia z kontrolerem/działaniem lub stroną, która nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="85187-987">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="85187-988">Rozważmy następujący domyślny szablon trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-988">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="85187-989">Załóżmy, że łącze do akcji jest generowane przy użyciu szablonu domyślnego z następującymi elementami:</span><span class="sxs-lookup"><span data-stu-id="85187-989">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="85187-990">Z `IRouter`routingu opartego na `/Blog/ReadPost/17`podstawie, `BlogController` wynik jest zawsze , nawet `ReadPost` jeśli nie istnieje lub nie ma metody akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-990">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="85187-991">Zgodnie z oczekiwaniami routing punktu końcowego w ASP.NET Core 2.2 lub nowszych `/Blog/ReadPost/17` powoduje, że istnieje metoda akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-991">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="85187-992">*Jednak routing punktu końcowego tworzy pusty ciąg, jeśli akcja nie istnieje.*</span><span class="sxs-lookup"><span data-stu-id="85187-992">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="85187-993">Koncepcyjnie routing punktu końcowego nie zakłada, że punkt końcowy istnieje, jeśli akcja nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="85187-993">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="85187-994">*Algorytm unieważnienia wartości otoczenia generowania* łącza zachowuje się inaczej, gdy jest używany z routingiem punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-994">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="85187-995">*Unieważnienie wartości otoczenia* jest algorytmem, który decyduje, które wartości trasy z aktualnie wykonywanego żądania (wartości otoczenia) mogą być używane w operacjach generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-995">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="85187-996">Routing konwencjonalny zawsze unieważniał dodatkowe wartości trasy podczas łączenia z inną akcją.</span><span class="sxs-lookup"><span data-stu-id="85187-996">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="85187-997">Routing atrybutów nie ma tego zachowania przed wydaniem ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="85187-997">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="85187-998">We wcześniejszych wersjach ASP.NET Core łącza do innej akcji, które używają tych samych nazw parametrów trasy, powodowały błędy generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-998">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="85187-999">W ASP.NET Core 2.2 lub nowszym obie formy routingu unieważniają wartości podczas łączenia z inną akcją.</span><span class="sxs-lookup"><span data-stu-id="85187-999">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="85187-1000">Rozważmy poniższy przykład w ASP.NET Core 2.1 lub wcześniejszych.</span><span class="sxs-lookup"><span data-stu-id="85187-1000">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="85187-1001">Podczas łączenia z inną akcją (lub inną stroną) wartości trasy mogą być ponownie zaużywane w niepożądany sposób.</span><span class="sxs-lookup"><span data-stu-id="85187-1001">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="85187-1002">W */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="85187-1002">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="85187-1003">W */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="85187-1003">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="85187-1004">Jeśli identyfikator URI znajduje się `/Store/Product/18` w ASP.NET Core 2.1 lub starszym, łącze wygenerowane na stronie Sklep/Informacje `@Url.Page("/Login")` przez to . `/Login/18`</span><span class="sxs-lookup"><span data-stu-id="85187-1004">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="85187-1005">Wartość `id` 18 jest ponownie, mimo że miejsce docelowe łącza jest zupełnie inną częścią aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1005">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="85187-1006">Wartość `id` trasy w kontekście `/Login` strony jest prawdopodobnie wartością identyfikatora użytkownika, a nie wartością identyfikatora produktu sklepu.</span><span class="sxs-lookup"><span data-stu-id="85187-1006">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="85187-1007">W routingu punktu końcowego z ASP.NET Core 2.2 `/Login`lub nowszym wynikiem jest .</span><span class="sxs-lookup"><span data-stu-id="85187-1007">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="85187-1008">Wartości otoczenia nie są ponownie używany, gdy połączone miejsce docelowe jest inną akcją lub stroną.</span><span class="sxs-lookup"><span data-stu-id="85187-1008">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="85187-1009">Składnia parametru trasy zaokrąglania: Ukośniki do przodu nie są`**`kodowane podczas używania dwustyguszki ( ) składni parametru catch-all.</span><span class="sxs-lookup"><span data-stu-id="85187-1009">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="85187-1010">Podczas generowania łączy system routingu koduje wartość przechwyconą w`**`podwójnej gwiazdki ( `{**myparametername}`) parametr catch-all (na przykład) z wyjątkiem ukośników do przodu.</span><span class="sxs-lookup"><span data-stu-id="85187-1010">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="85187-1011">Połowa z podwójną gwiazdką jest obsługiwana z `IRouter`routingiem opartym na ASP.NET Core 2.2 lub nowszym.</span><span class="sxs-lookup"><span data-stu-id="85187-1011">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="85187-1012">Składnia parametrów pojedynczej gwiazdki catch-all w poprzednich wersjach`{*myparametername}`ASP.NET Core ( ) pozostaje obsługiwana, a ukośniki do przodu są zakodowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1012">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="85187-1013">Trasa</span><span class="sxs-lookup"><span data-stu-id="85187-1013">Route</span></span>              | <span data-ttu-id="85187-1014">Łącze wygenerowane za pomocą</span><span class="sxs-lookup"><span data-stu-id="85187-1014">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="85187-1015">`/search/admin%2Fproducts`(ukośnik do przodu jest zakodowany)</span><span class="sxs-lookup"><span data-stu-id="85187-1015">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="85187-1016">Przykład oprogramowania pośredniczącego</span><span class="sxs-lookup"><span data-stu-id="85187-1016">Middleware example</span></span>

<span data-ttu-id="85187-1017">W poniższym przykładzie oprogramowanie pośredniczące używa <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejsu API do utworzenia łącza do metody akcji, która zawiera listę produktów magazynu.</span><span class="sxs-lookup"><span data-stu-id="85187-1017">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="85187-1018">Za pomocą generatora łączy przez wstrzyknięcie `GenerateLink` go do klasy i wywołanie jest dostępna dla każdej klasy w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1018">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="85187-1019">Tworzenie tras</span><span class="sxs-lookup"><span data-stu-id="85187-1019">Create routes</span></span>

<span data-ttu-id="85187-1020">Większość aplikacji tworzy <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> trasy przez wywołanie lub <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>jedną z podobnych metod rozszerzenia zdefiniowanych w programie .</span><span class="sxs-lookup"><span data-stu-id="85187-1020">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="85187-1021">Każda z <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> metod rozszerzenia utworzyć <xref:Microsoft.AspNetCore.Routing.Route> wystąpienie i dodać go do kolekcji trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1021">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="85187-1022"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>nie akceptuje parametru obsługi marszruty.</span><span class="sxs-lookup"><span data-stu-id="85187-1022"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="85187-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>dodaje tylko trasy obsługiwane przez <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>plik .</span><span class="sxs-lookup"><span data-stu-id="85187-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="85187-1024">Aby dowiedzieć się więcej o <xref:mvc/controllers/routing>routingu w MVC, zobacz .</span><span class="sxs-lookup"><span data-stu-id="85187-1024">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="85187-1025">Poniższy przykład kodu jest <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> przykładem wywołania używanego przez typową definicję trasy core MVC ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="85187-1025">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="85187-1026">Ten szablon pasuje do ścieżki adresu URL i wyodrębnia wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1026">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="85187-1027">Na przykład ścieżka `/Products/Details/17` generuje następujące wartości `{ controller = Products, action = Details, id = 17 }`trasy: .</span><span class="sxs-lookup"><span data-stu-id="85187-1027">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="85187-1028">Wartości trasy są określane przez podzielenie ścieżki adresu URL na segmenty i dopasowanie każdego segmentu do nazwy *parametru trasy* w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1028">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="85187-1029">Parametry trasy są nazwane.</span><span class="sxs-lookup"><span data-stu-id="85187-1029">Route parameters are named.</span></span> <span data-ttu-id="85187-1030">Parametry zdefiniowane przez załączenie nazwy `{ ... }`parametru w nawiasy klamrowe .</span><span class="sxs-lookup"><span data-stu-id="85187-1030">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="85187-1031">Poprzedni szablon może również odpowiadać `/` ścieżce `{ controller = Home, action = Index }`adresu URL i tworzyć wartości .</span><span class="sxs-lookup"><span data-stu-id="85187-1031">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="85187-1032">Dzieje się `{controller}` tak, ponieważ parametry `{action}` i `id` trasy mają wartości domyślne, a parametr trasy jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="85187-1032">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="85187-1033">Znak równości (`=`), po którym następuje wartość po nazwie parametru trasy definiuje wartość domyślną dla parametru.</span><span class="sxs-lookup"><span data-stu-id="85187-1033">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="85187-1034">Znak zapytania`?`( ) po nazwie parametru trasy definiuje parametr opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="85187-1034">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="85187-1035">Parametry trasy z wartością domyślną *zawsze* generują wartość trasy, gdy trasa jest zgodna.</span><span class="sxs-lookup"><span data-stu-id="85187-1035">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="85187-1036">Parametry opcjonalne nie generują wartości trasy, jeśli nie ma odpowiedniego segmentu ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1036">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="85187-1037">Zobacz sekcję [odwołania do szablonu trasy,](#route-template-reference) aby uzyskać dokładny opis scenariuszy szablonu trasy i składni.</span><span class="sxs-lookup"><span data-stu-id="85187-1037">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="85187-1038">W poniższym przykładzie definicja `{id:int}` parametru trasy definiuje ograniczenie [trasy](#route-constraint-reference) dla parametru `id` trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-1038">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="85187-1039">Ten szablon pasuje do `/Products/Details/17` ścieżki `/Products/Details/Apples`adresu URL, takiej jak, ale nie .</span><span class="sxs-lookup"><span data-stu-id="85187-1039">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="85187-1040">Ograniczenia trasy <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementują i sprawdzają wartości trasy, aby je zweryfikować.</span><span class="sxs-lookup"><span data-stu-id="85187-1040">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="85187-1041">W tym przykładzie `id` wartość trasy musi być konwertowana na całkowitą.</span><span class="sxs-lookup"><span data-stu-id="85187-1041">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="85187-1042">Zobacz [route-constraint-reference, aby](#route-constraint-reference) uzyskać wyjaśnienie ograniczeń trasy dostarczonych przez strukturę.</span><span class="sxs-lookup"><span data-stu-id="85187-1042">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="85187-1043">Dodatkowe przeciążenia <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> wartości `constraints`akceptowania dla , `dataTokens`i `defaults`.</span><span class="sxs-lookup"><span data-stu-id="85187-1043">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="85187-1044">Typowym zastosowaniem tych parametrów jest przekazanie anonimowo wpisanego obiektu, w którym nazwy właściwości typu anonimowego odpowiadają nazwom parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1044">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="85187-1045">Poniższe <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> przykłady tworzą równoważne trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-1045">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="85187-1046">Składnia wbudowana do definiowania ograniczeń i wartości domyślnych może być wygodna w przypadku prostych tras.</span><span class="sxs-lookup"><span data-stu-id="85187-1046">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="85187-1047">Istnieją jednak scenariusze, takie jak tokeny danych, które nie są obsługiwane przez składnię wbudowaną.</span><span class="sxs-lookup"><span data-stu-id="85187-1047">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="85187-1048">W poniższym przykładzie przedstawiono kilka dodatkowych scenariuszy:</span><span class="sxs-lookup"><span data-stu-id="85187-1048">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="85187-1049">Poprzedni szablon pasuje do ścieżki `/Blog/All-About-Routing/Introduction` adresu URL, `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`takiej jak i wyodrębnia wartości .</span><span class="sxs-lookup"><span data-stu-id="85187-1049">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="85187-1050">Domyślne wartości `controller` trasy `action` dla i są tworzone przez trasę, nawet jeśli w szablonie nie ma odpowiednich parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1050">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="85187-1051">Wartości domyślne można określić w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1051">Default values can be specified in the route template.</span></span> <span data-ttu-id="85187-1052">Parametr `article` trasy jest definiowany jako *catch-all* przez pojawienie się`**`podwójnej gwiazdki ( ) przed nazwą parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1052">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="85187-1053">Parametry trasy catch-all przechwytują pozostałą część ścieżki adresu URL i mogą również odpowiadać pustejasce.</span><span class="sxs-lookup"><span data-stu-id="85187-1053">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="85187-1054">W poniższym przykładzie dodano ograniczenia trasy i tokeny danych:</span><span class="sxs-lookup"><span data-stu-id="85187-1054">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="85187-1055">Poprzedni szablon pasuje do ścieżki `/en-US/Products/5` adresu URL, `{ controller = Products, action = Details, id = 5 }` takiej jak `{ locale = en-US }`i wyodrębnia wartości i tokeny danych.</span><span class="sxs-lookup"><span data-stu-id="85187-1055">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Lokalne tokeny systemu Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="85187-1057">Generowanie adresu URL klasy trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1057">Route class URL generation</span></span>

<span data-ttu-id="85187-1058">Klasa <xref:Microsoft.AspNetCore.Routing.Route> może również wykonywać generowanie adresów URL, łącząc zestaw wartości trasy z szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1058">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="85187-1059">Jest to logicznie odwrotny proces dopasowywania ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1059">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="85187-1060">Aby lepiej zrozumieć generowanie adresów URL, wyobraź sobie, jaki adres URL chcesz wygenerować, a następnie zastanów się, jak szablon trasy będzie zgodny z tym adresem URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1060">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="85187-1061">Jakie wartości powstałyby?</span><span class="sxs-lookup"><span data-stu-id="85187-1061">What values would be produced?</span></span> <span data-ttu-id="85187-1062">Jest to odpowiednik przybliżone, <xref:Microsoft.AspNetCore.Routing.Route> jak działa generowanie adresów URL w klasie.</span><span class="sxs-lookup"><span data-stu-id="85187-1062">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="85187-1063">W poniższym przykładzie użyto ogólnej trasy domyślnej ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="85187-1063">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="85187-1064">Z wartościami `{ controller = Products, action = List }`trasy `/Products/List` generowany jest adres URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1064">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="85187-1065">Wartości trasy są zastępowane odpowiednimi parametrami trasy w celu utworzenia ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1065">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="85187-1066">Ponieważ `id` jest opcjonalnym parametrem trasy, adres URL `id`jest pomyślnie generowany bez wartości dla .</span><span class="sxs-lookup"><span data-stu-id="85187-1066">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="85187-1067">Z wartościami `{ controller = Home, action = Index }`trasy `/` generowany jest adres URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1067">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="85187-1068">Podane wartości trasy są zgodne z wartościami domyślnymi, a segmenty odpowiadające wartościom domyślnym są bezpiecznie pomijane.</span><span class="sxs-lookup"><span data-stu-id="85187-1068">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="85187-1069">Oba adresy URL wygenerowane w obie`/Home/Index` `/`strony z następującą definicją trasy ( i ) generują te same wartości trasy, które zostały użyte do wygenerowania adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1069">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="85187-1070">Aplikacja używająca ASP.NET Core MVC <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> powinna używać do generowania adresów URL zamiast wywoływania bezpośrednio do routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-1070">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="85187-1071">Aby uzyskać więcej informacji na temat generowania adresów URL, zobacz sekcję [odwołanie do generowania adresów URL.](#url-generation-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-1071">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="85187-1072">Korzystanie z oprogramowania pośredniczącego routingu</span><span class="sxs-lookup"><span data-stu-id="85187-1072">Use Routing Middleware</span></span>

<span data-ttu-id="85187-1073">Odwołanie się do [metapakietu Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) w pliku projektu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1073">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="85187-1074">Dodaj routing do kontenera usługi w: `Startup.ConfigureServices`</span><span class="sxs-lookup"><span data-stu-id="85187-1074">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="85187-1075">Trasy muszą być skonfigurowane w metodzie. `Startup.Configure`</span><span class="sxs-lookup"><span data-stu-id="85187-1075">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="85187-1076">Przykładowa aplikacja używa następujących interfejsów API:</span><span class="sxs-lookup"><span data-stu-id="85187-1076">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="85187-1077"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>&ndash; Pasuje tylko do żądań HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="85187-1077"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="85187-1078">W poniższej tabeli przedstawiono odpowiedzi z podanymi identyfikatorami URI.</span><span class="sxs-lookup"><span data-stu-id="85187-1078">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="85187-1079">Identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="85187-1079">URI</span></span>                    | <span data-ttu-id="85187-1080">Odpowiedź</span><span class="sxs-lookup"><span data-stu-id="85187-1080">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="85187-1081">Cześć!</span><span class="sxs-lookup"><span data-stu-id="85187-1081">Hello!</span></span> <span data-ttu-id="85187-1082">Wartości trasy: [operacja, tworzenie], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="85187-1082">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="85187-1083">Cześć!</span><span class="sxs-lookup"><span data-stu-id="85187-1083">Hello!</span></span> <span data-ttu-id="85187-1084">Wartości trasy: [operacja, ścieżka], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="85187-1084">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="85187-1085">Cześć!</span><span class="sxs-lookup"><span data-stu-id="85187-1085">Hello!</span></span> <span data-ttu-id="85187-1086">Wartości trasy: [operacja, ścieżka], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="85187-1086">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="85187-1087">Żądanie przechodzi, bez dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-1087">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="85187-1088">Cześć, Joe!</span><span class="sxs-lookup"><span data-stu-id="85187-1088">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="85187-1089">Żądanie przechodzi, pasuje tylko do protokołu HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="85187-1089">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="85187-1090">Żądanie przechodzi, bez dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-1090">The request falls through, no match.</span></span>              |

<span data-ttu-id="85187-1091">Struktura zawiera zestaw metod rozszerzenia do tworzenia<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>tras ( ):</span><span class="sxs-lookup"><span data-stu-id="85187-1091">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="85187-1092">Metody `Map[Verb]` używają ograniczeń, aby ograniczyć trasę do zlecenia HTTP w nazwie metody.</span><span class="sxs-lookup"><span data-stu-id="85187-1092">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="85187-1093">Na przykład <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> zobacz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>i .</span><span class="sxs-lookup"><span data-stu-id="85187-1093">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="85187-1094">Odwołanie do szablonu trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1094">Route template reference</span></span>

<span data-ttu-id="85187-1095">Tokeny w nawiasach`{ ... }`klamrowych ( ) definiują *parametry trasy,* które są powiązane, jeśli trasa jest dopasowywała.</span><span class="sxs-lookup"><span data-stu-id="85187-1095">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="85187-1096">Można zdefiniować więcej niż jeden parametr trasy w segmencie trasy, ale muszą one być oddzielone wartością literału.</span><span class="sxs-lookup"><span data-stu-id="85187-1096">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="85187-1097">Na przykład `{controller=Home}{action=Index}` nie jest prawidłową trasą, ponieważ nie `{controller}` ma `{action}`wartości literału między i .</span><span class="sxs-lookup"><span data-stu-id="85187-1097">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="85187-1098">Te parametry trasy muszą mieć nazwę i mogą mieć określone dodatkowe atrybuty.</span><span class="sxs-lookup"><span data-stu-id="85187-1098">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="85187-1099">Tekst dosłowny inny niż `{id}`parametry trasy (na `/` przykład) i separator ścieżki muszą być zgodne z tekstem w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1099">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="85187-1100">Dopasowanie tekstu jest niewrażliwe na rozmiary i opiera się na zdekodowanym reprezentacji ścieżki adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1100">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="85187-1101">`{` Aby dopasować dosłowny ogranicznik parametru trasy ( lub `}``{{` ), `}}`wyjdź z ogranicznika, powtarzając znak ( lub ).</span><span class="sxs-lookup"><span data-stu-id="85187-1101">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="85187-1102">Wzorce adresów URL, które próbują przechwycić nazwę pliku z opcjonalnym rozszerzeniem pliku, mają dodatkowe uwagi.</span><span class="sxs-lookup"><span data-stu-id="85187-1102">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="85187-1103">Rozważmy na przykład `files/{filename}.{ext?}`szablon .</span><span class="sxs-lookup"><span data-stu-id="85187-1103">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="85187-1104">Gdy wartości `filename` dla `ext` obu i istnieją, obie wartości są wypełniane.</span><span class="sxs-lookup"><span data-stu-id="85187-1104">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="85187-1105">Jeśli w adresie URL `filename` istnieje tylko wartość, trasa jest`.`zgodna, ponieważ okres końcowy ( ) jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="85187-1105">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="85187-1106">Następujące adresy URL są zgodne z tą trasą:</span><span class="sxs-lookup"><span data-stu-id="85187-1106">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="85187-1107">Gwiazdki (`*`) lub podwójnej gwiazdki`**`( ) jako prefiksu parametru trasy do powiązania z resztą identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="85187-1107">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="85187-1108">Są one nazywane *catch-all* parametrów.</span><span class="sxs-lookup"><span data-stu-id="85187-1108">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="85187-1109">Na przykład `blog/{**slug}` dopasowuje dowolny identyfikator `/blog` URI, który rozpoczyna się od `slug` i ma dowolną wartość po nim, która jest przypisana do wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1109">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="85187-1110">Catch-all parametry mogą również odpowiadać pusty ciąg.</span><span class="sxs-lookup"><span data-stu-id="85187-1110">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="85187-1111">Parametr catch-all wycina odpowiednie znaki, gdy trasa jest używana do`/`generowania adresu URL, w tym separatora ścieżki ( ) znaków.</span><span class="sxs-lookup"><span data-stu-id="85187-1111">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="85187-1112">Na przykład trasa `foo/{*path}` z `{ path = "my/path" }` wartościami `foo/my%2Fpath`trasy generuje .</span><span class="sxs-lookup"><span data-stu-id="85187-1112">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="85187-1113">Zwróć uwagę na ukucie do przodu.</span><span class="sxs-lookup"><span data-stu-id="85187-1113">Note the escaped forward slash.</span></span> <span data-ttu-id="85187-1114">Aby znaki separatora ścieżki w `**` obie strony, należy użyć prefiksu parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1114">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="85187-1115">Trasa `foo/{**path}` z `{ path = "my/path" }` generuje `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="85187-1115">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="85187-1116">Parametry trasy mogą mieć *wartości domyślne* wyznaczone przez określenie wartości domyślnej po`=`nazwie parametru oddzielonej znakiem równości ( ).</span><span class="sxs-lookup"><span data-stu-id="85187-1116">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="85187-1117">Na przykład `{controller=Home}` definiuje `Home` jako wartość `controller`domyślną dla .</span><span class="sxs-lookup"><span data-stu-id="85187-1117">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="85187-1118">Wartość domyślna jest używana, jeśli w adresie URL parametru nie ma żadnej wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-1118">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="85187-1119">Parametry trasy są opcjonalne, dołączając`?`znak zapytania ( ) na końcu `id?`nazwy parametru, jak w .</span><span class="sxs-lookup"><span data-stu-id="85187-1119">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="85187-1120">Różnica między wartościami opcjonalnymi a domyślnymi parametrami trasy polega na&mdash;tym, że parametr trasy z wartością domyślną zawsze tworzy wartość, którą parametr opcjonalny ma wartość tylko wtedy, gdy wartość jest dostarczana przez adres URL żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1120">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="85187-1121">Parametry trasy mogą mieć ograniczenia, które muszą odpowiadać wartości trasy powiązanej z adresem URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1121">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="85187-1122">Dodanie dwukropka (`:`) i nazwy ograniczenia po nazwie parametru trasy określa ograniczenie *wbudowane* dla parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1122">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="85187-1123">Jeśli ograniczenie wymaga argumentów, są one ujęte`(...)`w nawiasy ( ) po nazwie ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1123">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="85187-1124">Można określić wiele ograniczeń wbudowanych, dołączając`:`inny dwukropek ( ) i nazwę ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1124">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="85187-1125">Nazwa ograniczenia i argumenty są <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> przekazywane do usługi, aby utworzyć wystąpienie do użycia w przetwarzaniu adresów <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1125">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="85187-1126">Na przykład szablon `blog/{article:minlength(10)}` trasy określa `minlength` ograniczenie z `10`argumentem .</span><span class="sxs-lookup"><span data-stu-id="85187-1126">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="85187-1127">Aby uzyskać więcej informacji na temat ograniczeń trasy i listy ograniczeń przewidzianych przez strukturę, zobacz [sekcja Odwołanie do ograniczenia trasy.](#route-constraint-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-1127">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="85187-1128">Parametry trasy mogą również mieć transformatory parametrów, które przekształcają wartość parametru podczas generowania łączy i dopasowywania akcji i stron do adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1128">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="85187-1129">Podobnie jak wiązania, transformatory parametrów można dodać w linii`:`do parametru trasy, dodając dwukropek ( ) i nazwę transformatora po nazwie parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1129">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="85187-1130">Na przykład szablon `blog/{article:slugify}` trasy określa `slugify` transformator.</span><span class="sxs-lookup"><span data-stu-id="85187-1130">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="85187-1131">Aby uzyskać więcej informacji na temat transformatorów parametrów, zobacz [sekcję Odwołanie do transformatora parametrów.](#parameter-transformer-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-1131">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="85187-1132">W poniższej tabeli przedstawiono przykładowe szablony tras i ich zachowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-1132">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="85187-1133">Szablon trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1133">Route Template</span></span>                           | <span data-ttu-id="85187-1134">Przykładowy pasujący identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="85187-1134">Example Matching URI</span></span>    | <span data-ttu-id="85187-1135">Identyfikator URI żądania&hellip;</span><span class="sxs-lookup"><span data-stu-id="85187-1135">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="85187-1136">Pasuje tylko do `/hello`pojedynczej ścieżki .</span><span class="sxs-lookup"><span data-stu-id="85187-1136">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="85187-1137">Dopasowuje `Page` `Home`i ustawia na .</span><span class="sxs-lookup"><span data-stu-id="85187-1137">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="85187-1138">Dopasowuje `Page` `Contact`i ustawia na .</span><span class="sxs-lookup"><span data-stu-id="85187-1138">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="85187-1139">Mapy do `Products` kontrolera i `List` akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-1139">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="85187-1140">Mapy do `Products` kontrolera `Details` `id` i akcji ( ustawiona na 123).</span><span class="sxs-lookup"><span data-stu-id="85187-1140">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="85187-1141">Mapy do `Home` kontrolera `Index` `id` i metody ( jest ignorowana).</span><span class="sxs-lookup"><span data-stu-id="85187-1141">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="85187-1142">Korzystanie z szablonu jest zazwyczaj najprostszym podejściem do routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-1142">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="85187-1143">Ograniczenia i wartości domyślne można również określić poza szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1143">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="85187-1144">Włącz [rejestrowanie,](xref:fundamentals/logging/index) aby zobaczyć, jak wbudowane implementacje routingu, takie jak <xref:Microsoft.AspNetCore.Routing.Route>, dopasowywanie żądań.</span><span class="sxs-lookup"><span data-stu-id="85187-1144">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="85187-1145">Nazwy marszruty zarezerwowane</span><span class="sxs-lookup"><span data-stu-id="85187-1145">Reserved routing names</span></span>

<span data-ttu-id="85187-1146">Następujące słowa kluczowe są zastrzeżonymi nazwami i nie mogą być używane jako nazwy lub parametry trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-1146">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="85187-1147">Odwołanie do ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1147">Route constraint reference</span></span>

<span data-ttu-id="85187-1148">Ograniczenia trasy są wykonywane, gdy dopasowanie wystąpiło z przychodzącym adresem URL, a ścieżka adresu URL jest tokenizowana na wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1148">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="85187-1149">Ograniczenia trasy zazwyczaj sprawdzają wartość trasy skojarzoną za pośrednictwem szablonu trasy i podejmują decyzję tak/nie o tym, czy wartość jest dopuszczalna.</span><span class="sxs-lookup"><span data-stu-id="85187-1149">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="85187-1150">Niektóre ograniczenia trasy używają danych poza wartością trasy, aby rozważyć, czy żądanie może być kierowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1150">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="85187-1151">Na przykład <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> można zaakceptować lub odrzucić żądanie na podstawie jego zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-1151">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="85187-1152">Ograniczenia są używane w żądaniach routingu i generowaniu łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-1152">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="85187-1153">Nie używaj ograniczeń do **sprawdzania poprawności danych wejściowych**.</span><span class="sxs-lookup"><span data-stu-id="85187-1153">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="85187-1154">Jeśli ograniczenia są używane do **sprawdzania poprawności danych wejściowych,** nieprawidłowe wyniki wejściowe w *404 - Nie znaleziono* odpowiedzi zamiast *400 - Złe żądanie* z odpowiednim komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="85187-1154">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="85187-1155">Ograniczenia trasy są używane do **rozróżniania** podobnych tras, a nie do sprawdzania poprawności danych wejściowych dla określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1155">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="85187-1156">W poniższej tabeli przedstawiono przykładowe ograniczenia trasy i ich oczekiwane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-1156">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="85187-1157">ograniczenie</span><span class="sxs-lookup"><span data-stu-id="85187-1157">constraint</span></span> | <span data-ttu-id="85187-1158">Przykład</span><span class="sxs-lookup"><span data-stu-id="85187-1158">Example</span></span> | <span data-ttu-id="85187-1159">Przykładowe dopasowania</span><span class="sxs-lookup"><span data-stu-id="85187-1159">Example Matches</span></span> | <span data-ttu-id="85187-1160">Uwagi</span><span class="sxs-lookup"><span data-stu-id="85187-1160">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="85187-1161">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="85187-1161">`123456789`, `-123456789`</span></span> | <span data-ttu-id="85187-1162">Dopasowuje dowolną całkowitą.</span><span class="sxs-lookup"><span data-stu-id="85187-1162">Matches any integer.</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="85187-1163">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="85187-1163">`true`, `FALSE`</span></span> | <span data-ttu-id="85187-1164">Dopasowuje lub "false.Matches `true` or 'false.</span><span class="sxs-lookup"><span data-stu-id="85187-1164">Matches `true` or \`false.</span></span> <span data-ttu-id="85187-1165">Bez uwzględniania wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="85187-1165">Case-insensitive.</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="85187-1166">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="85187-1166">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="85187-1167">Pasuje do `DateTime` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1167">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="85187-1168">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1168">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="85187-1169">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="85187-1169">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="85187-1170">Pasuje do `decimal` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1170">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="85187-1171">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1171">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="85187-1172">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="85187-1172">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="85187-1173">Pasuje do `double` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1173">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="85187-1174">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1174">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="85187-1175">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="85187-1175">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="85187-1176">Pasuje do `float` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1176">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="85187-1177">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1177">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="85187-1178">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="85187-1178">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="85187-1179">Pasuje do `Guid` prawidłowej wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-1179">Matches a valid `Guid` value.</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="85187-1180">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="85187-1180">`123456789`, `-123456789`</span></span> | <span data-ttu-id="85187-1181">Pasuje do `long` prawidłowej wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-1181">Matches a valid `long` value.</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="85187-1182">Ciąg musi mieć co najmniej 4 znaki.</span><span class="sxs-lookup"><span data-stu-id="85187-1182">String must be at least 4 characters.</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="85187-1183">Ciąg ma maksymalnie 8 znaków.</span><span class="sxs-lookup"><span data-stu-id="85187-1183">String has maximum of 8 characters.</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="85187-1184">Ciąg musi mieć dokładnie 12 znaków.</span><span class="sxs-lookup"><span data-stu-id="85187-1184">String must be exactly 12 characters long.</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="85187-1185">Ciąg musi mieć co najmniej 8 znaków i maksymalnie 16 znaków.</span><span class="sxs-lookup"><span data-stu-id="85187-1185">String must be at least 8 and has maximum of 16 characters.</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="85187-1186">Wartość całkowita musi wynosić co najmniej 18.</span><span class="sxs-lookup"><span data-stu-id="85187-1186">Integer value must be at least 18.</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="85187-1187">Wartość całkowita maksymalnie 120.</span><span class="sxs-lookup"><span data-stu-id="85187-1187">Integer value maximum of 120.</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="85187-1188">Wartość całkowita musi wynosić co najmniej 18 i maksymalnie 120.</span><span class="sxs-lookup"><span data-stu-id="85187-1188">Integer value must be at least 18 and maximum of 120.</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="85187-1189">Ciąg musi składać się z `a` - `z`jednego lub więcej znaków alfabetycznych .</span><span class="sxs-lookup"><span data-stu-id="85187-1189">String must consist of one or more alphabetical characters `a`-`z`.</span></span>  <span data-ttu-id="85187-1190">Bez uwzględniania wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="85187-1190">Case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="85187-1191">Ciąg musi być zgodny z wyrażeniem regularnym.</span><span class="sxs-lookup"><span data-stu-id="85187-1191">String must match the regular expression.</span></span> <span data-ttu-id="85187-1192">Zobacz wskazówki dotyczące definiowania wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="85187-1192">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="85187-1193">Służy do wymuszania, że wartość nieparametryczny jest obecny podczas generowania adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1193">Used to enforce that a non-parameter value is present during URL generation.</span></span> |

<span data-ttu-id="85187-1194">Wiele ograniczeń rozdzielanych dwukropkiem można zastosować do pojedynczego parametru.</span><span class="sxs-lookup"><span data-stu-id="85187-1194">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="85187-1195">Na przykład następujące ograniczenie ogranicza parametr do wartości całkowitej 1 lub większej:</span><span class="sxs-lookup"><span data-stu-id="85187-1195">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="85187-1196">Ograniczenia trasy, które weryfikują adres URL i są `int` `DateTime`konwertowane na typ CLR (na przykład lub ) zawsze używają kultury niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1196">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="85187-1197">Te ograniczenia zakładają, że adres URL nie jest zlokalizowany.</span><span class="sxs-lookup"><span data-stu-id="85187-1197">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="85187-1198">Ograniczenia trasy dostarczone przez strukturę nie modyfikują wartości przechowywanych w wartościach marszruty.</span><span class="sxs-lookup"><span data-stu-id="85187-1198">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="85187-1199">Wszystkie wartości trasy analizowane z adresu URL są przechowywane jako ciągi.</span><span class="sxs-lookup"><span data-stu-id="85187-1199">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="85187-1200">Na przykład `float` ograniczenie próbuje przekonwertować wartość trasy na float, ale przekonwertowana wartość jest używana tylko do sprawdzenia, czy można ją przekonwertować na float.</span><span class="sxs-lookup"><span data-stu-id="85187-1200">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="85187-1201">Wyrażenia regularne</span><span class="sxs-lookup"><span data-stu-id="85187-1201">Regular expressions</span></span>

<span data-ttu-id="85187-1202">Struktura ASP.NET Core dodaje `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktora wyrażeń regularnych.</span><span class="sxs-lookup"><span data-stu-id="85187-1202">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="85187-1203">Opis <xref:System.Text.RegularExpressions.RegexOptions> tych członków można znaleźć w części.</span><span class="sxs-lookup"><span data-stu-id="85187-1203">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="85187-1204">Wyrażenia regularne używają ograniczników i tokenów podobnych do tych używanych przez routing i język C#.</span><span class="sxs-lookup"><span data-stu-id="85187-1204">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="85187-1205">Tokeny wyrażenia regularnego muszą zostać zmienione.</span><span class="sxs-lookup"><span data-stu-id="85187-1205">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="85187-1206">Aby użyć wyrażenia `^\d{3}-\d{2}-\d{4}$` regularnego w routingu:</span><span class="sxs-lookup"><span data-stu-id="85187-1206">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing:</span></span>

* <span data-ttu-id="85187-1207">Wyrażenie musi mieć pojedyncze `\` znaki ukośnika odwrotnego `\\` podane w ciągu jako podwójne znaki ukośnika odwrotnego w kodzie źródłowym.</span><span class="sxs-lookup"><span data-stu-id="85187-1207">The expression must have the single backslash `\` characters provided in the string as double backslash `\\` characters in the source code.</span></span>
* <span data-ttu-id="85187-1208">Wyrażenie regularne musi `\\` nas w `\` celu ucieczki znak ucieczki ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-1208">The regular expression must us `\\` in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="85187-1209">Wyrażenie regularne nie wymaga `\\` użycia [dosłownie literałów ciągów](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="85187-1209">The regular expression doesn't require `\\` when using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="85187-1210">Aby uniknąć znaków ogranicznika `}` `[`parametru marszruty `{`, `{{` `}`, `[[` `]`, podwoić znaki w wyrażeniu , , , `]]`.</span><span class="sxs-lookup"><span data-stu-id="85187-1210">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression `{{`, `}`, `[[`, `]]`.</span></span> <span data-ttu-id="85187-1211">W poniższej tabeli przedstawiono wyrażenie regularne i wersję odstępów ekscesowych:</span><span class="sxs-lookup"><span data-stu-id="85187-1211">The following table shows a regular expression and the escaped version:</span></span>

| <span data-ttu-id="85187-1212">Wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="85187-1212">Regular Expression</span></span>    | <span data-ttu-id="85187-1213">Wysunęło się wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="85187-1213">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="85187-1214">Wyrażenia regularne używane w routingu często `^` zaczynają się od znaku szycie i pasują do pozycji początkowej ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-1214">Regular expressions used in routing often start with the caret `^` character and match starting position of the string.</span></span> <span data-ttu-id="85187-1215">Wyrażenia często kończą się znakiem `$` znaku dolara i odpowiadają końcu ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-1215">The expressions often end with the dollar sign `$` character and match end of the string.</span></span> <span data-ttu-id="85187-1216">Znaki `^` `$` i upewnij się, że wyrażenie regularne odpowiada wartości całego parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1216">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="85187-1217">Bez `^` znaków `$` i wyrażenie regularne odpowiada wszystkie podciągi w ciągu, który jest często niepożądane.</span><span class="sxs-lookup"><span data-stu-id="85187-1217">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="85187-1218">W poniższej tabeli przedstawiono przykłady i wyjaśniono, dlaczego są zgodne lub nie dopasowywać.</span><span class="sxs-lookup"><span data-stu-id="85187-1218">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="85187-1219">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="85187-1219">Expression</span></span>   | <span data-ttu-id="85187-1220">Ciąg</span><span class="sxs-lookup"><span data-stu-id="85187-1220">String</span></span>    | <span data-ttu-id="85187-1221">Dopasowanie</span><span class="sxs-lookup"><span data-stu-id="85187-1221">Match</span></span> | <span data-ttu-id="85187-1222">Komentarz</span><span class="sxs-lookup"><span data-stu-id="85187-1222">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="85187-1223">hello</span><span class="sxs-lookup"><span data-stu-id="85187-1223">hello</span></span>     | <span data-ttu-id="85187-1224">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1224">Yes</span></span>   | <span data-ttu-id="85187-1225">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="85187-1225">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="85187-1226">123abc456</span><span class="sxs-lookup"><span data-stu-id="85187-1226">123abc456</span></span> | <span data-ttu-id="85187-1227">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1227">Yes</span></span>   | <span data-ttu-id="85187-1228">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="85187-1228">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="85187-1229">Mz</span><span class="sxs-lookup"><span data-stu-id="85187-1229">mz</span></span>        | <span data-ttu-id="85187-1230">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1230">Yes</span></span>   | <span data-ttu-id="85187-1231">Dopasowuje wyrażenie</span><span class="sxs-lookup"><span data-stu-id="85187-1231">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="85187-1232">MZ</span><span class="sxs-lookup"><span data-stu-id="85187-1232">MZ</span></span>        | <span data-ttu-id="85187-1233">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1233">Yes</span></span>   | <span data-ttu-id="85187-1234">Nie z uwzględnieniem wielkości liter</span><span class="sxs-lookup"><span data-stu-id="85187-1234">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="85187-1235">hello</span><span class="sxs-lookup"><span data-stu-id="85187-1235">hello</span></span>     | <span data-ttu-id="85187-1236">Nie</span><span class="sxs-lookup"><span data-stu-id="85187-1236">No</span></span>    | <span data-ttu-id="85187-1237">Zobacz `^` `$` i powyżej</span><span class="sxs-lookup"><span data-stu-id="85187-1237">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="85187-1238">123abc456</span><span class="sxs-lookup"><span data-stu-id="85187-1238">123abc456</span></span> | <span data-ttu-id="85187-1239">Nie</span><span class="sxs-lookup"><span data-stu-id="85187-1239">No</span></span>    | <span data-ttu-id="85187-1240">Zobacz `^` `$` i powyżej</span><span class="sxs-lookup"><span data-stu-id="85187-1240">See `^` and `$` above</span></span> |

<span data-ttu-id="85187-1241">Aby uzyskać więcej informacji na temat składni wyrażeń regularnych, zobacz [.NET Framework Wyrażenia regularne](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="85187-1241">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="85187-1242">Aby ograniczyć parametr do znanego zestawu możliwych wartości, należy użyć wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="85187-1242">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="85187-1243">Na przykład `{action:regex(^(list|get|create)$)}` tylko `action` dopasowuje `list` `get`wartość `create`trasy do , lub .</span><span class="sxs-lookup"><span data-stu-id="85187-1243">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="85187-1244">Jeśli przekazywane do słownika ograniczeń, `^(list|get|create)$` ciąg jest równoważne.</span><span class="sxs-lookup"><span data-stu-id="85187-1244">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="85187-1245">Ograniczenia przekazywane w słowniku ograniczeń (nie wbudowane w szablonie), które nie pasują do jednego ze znanych ograniczeń, są również traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="85187-1245">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="85187-1246">Niestandardowe ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1246">Custom route constraints</span></span>

<span data-ttu-id="85187-1247">Oprócz wbudowanych ograniczeń trasy ograniczenia trasy można tworzyć przez implementowanie <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="85187-1247">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="85187-1248">Interfejs <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> zawiera jedną metodę, która zwraca, `Match` `true` jeśli `false` ograniczenie jest spełnione i w inny sposób.</span><span class="sxs-lookup"><span data-stu-id="85187-1248">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="85187-1249">Aby użyć <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>niestandardowego, typ ograniczenia trasy musi być <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> zarejestrowany w kontenerze usługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1249">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="85187-1250">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> to słownik, który mapuje <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> klucze ograniczenia trasy do implementacji, które sprawdzają te ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1250">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="85187-1251">Aplikacja może <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> być aktualizowana `Startup.ConfigureServices` w ramach [usługi. Wywołanie AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) lub <xref:Microsoft.AspNetCore.Routing.RouteOptions> konfiguracja `services.Configure<RouteOptions>`bezpośrednio z programem .</span><span class="sxs-lookup"><span data-stu-id="85187-1251">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="85187-1252">Przykład:</span><span class="sxs-lookup"><span data-stu-id="85187-1252">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="85187-1253">Ograniczenie można następnie zastosować do tras w zwykły sposób, przy użyciu nazwy określonej podczas rejestrowania typu ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1253">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="85187-1254">Przykład:</span><span class="sxs-lookup"><span data-stu-id="85187-1254">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="85187-1255">Odwołanie do transformatora parametrów</span><span class="sxs-lookup"><span data-stu-id="85187-1255">Parameter transformer reference</span></span>

<span data-ttu-id="85187-1256">Transformatory parametrów:</span><span class="sxs-lookup"><span data-stu-id="85187-1256">Parameter transformers:</span></span>

* <span data-ttu-id="85187-1257">Wykonywanie podczas generowania łącza <xref:Microsoft.AspNetCore.Routing.Route>dla pliku .</span><span class="sxs-lookup"><span data-stu-id="85187-1257">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="85187-1258">Zaimplementuj `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`plik .</span><span class="sxs-lookup"><span data-stu-id="85187-1258">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="85187-1259">Są konfigurowane przy użyciu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>programu .</span><span class="sxs-lookup"><span data-stu-id="85187-1259">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="85187-1260">Należy wziąć wartość trasy parametru i przekształcić go w nową wartość ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-1260">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="85187-1261">Wynik przy użyciu wartości przekształcone w wygenerowanym łączu.</span><span class="sxs-lookup"><span data-stu-id="85187-1261">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="85187-1262">`slugify` Na przykład niestandardowy transformator parametrów we wzorcu `blog\{article:slugify}` trasy z `Url.Action(new { article = "MyTestArticle" })` generuje `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="85187-1262">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="85187-1263">Aby użyć transformatora parametrów we wzorcu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> trasy, skonfiguruj go najpierw za pomocą: `Startup.ConfigureServices`</span><span class="sxs-lookup"><span data-stu-id="85187-1263">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="85187-1264">Transformatory parametrów są używane przez platformę do przekształcania identyfikatora URI, gdzie punkt końcowy jest rozpoznawany.</span><span class="sxs-lookup"><span data-stu-id="85187-1264">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="85187-1265">Na przykład ASP.NET Core MVC używa transformatorów parametrów do przekształcania `area` `controller`wartości `action`trasy `page`używanej do dopasowania , , i .</span><span class="sxs-lookup"><span data-stu-id="85187-1265">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="85187-1266">W poprzedniej trasie akcja `SubscriptionManagementController.GetAll` jest dopasowywała `/subscription-management/get-all`się do identyfikatora URI .</span><span class="sxs-lookup"><span data-stu-id="85187-1266">With the preceding route, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="85187-1267">Transformator parametrów nie zmienia wartości trasy używanej do generowania łącza.</span><span class="sxs-lookup"><span data-stu-id="85187-1267">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="85187-1268">Na przykład `Url.Action("GetAll", "SubscriptionManagement")` wyjścia `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="85187-1268">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="85187-1269">ASP.NET Core udostępnia konwencje interfejsu API do używania transformatorów parametrów z wygenerowanymi trasami:</span><span class="sxs-lookup"><span data-stu-id="85187-1269">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="85187-1270">ASP.NET Core MVC ma `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` konwencję interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="85187-1270">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="85187-1271">Ta konwencja stosuje określony transformator parametrów do wszystkich tras atrybutów w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1271">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="85187-1272">Transformator parametrów przekształca tokeny trasy atrybutu, ponieważ są one zastępowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1272">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="85187-1273">Aby uzyskać więcej informacji, zobacz [Używanie transformatora parametrów w celu dostosowania zastępowania tokenów](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="85187-1273">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="85187-1274">Razor Pages `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` ma konwencję INTERFEJSU API.</span><span class="sxs-lookup"><span data-stu-id="85187-1274">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="85187-1275">Ta konwencja stosuje określony transformator parametrów do wszystkich automatycznie odnalezionych stron Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-1275">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="85187-1276">Transformator parametrów przekształca segmenty folderów i nazw plików tras Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="85187-1276">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="85187-1277">Aby uzyskać więcej informacji, zobacz [Dostosowywanie tras stron za pomocą transformatora parametrów](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="85187-1277">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="85187-1278">Odwołanie do generowania adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-1278">URL generation reference</span></span>

<span data-ttu-id="85187-1279">W poniższym przykładzie pokazano, jak wygenerować łącze <xref:Microsoft.AspNetCore.Routing.RouteCollection>do trasy, pod jakimasemie jest słownik wartości trasy i .</span><span class="sxs-lookup"><span data-stu-id="85187-1279">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="85187-1280">Wygenerowany <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> na końcu poprzedniej próbki `/package/create/123`to .</span><span class="sxs-lookup"><span data-stu-id="85187-1280">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="85187-1281">Słownik dostarcza wartości `operation` i `id` trasy szablonu "Track Package `package/{operation}/{id}`Route", .</span><span class="sxs-lookup"><span data-stu-id="85187-1281">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="85187-1282">Aby uzyskać szczegółowe informacje, zobacz przykładowy kod w sekcji [Użyj oprogramowania pośredniczącego routingu](#use-routing-middleware) lub [w przykładowej aplikacji](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="85187-1282">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="85187-1283">Drugim parametrem <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> konstruktora jest zbiór *wartości otoczenia*.</span><span class="sxs-lookup"><span data-stu-id="85187-1283">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="85187-1284">Wartości otoczenia są wygodne w użyciu, ponieważ ograniczają liczbę wartości, które deweloper musi określić w kontekście żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1284">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="85187-1285">Bieżące wartości trasy bieżącego żądania są traktowane jako wartości otoczenia dla generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-1285">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="85187-1286">W `About` ASP.NET Core MVC app akcji `HomeController`, nie trzeba określić wartość trasy kontrolera, aby `Index` &mdash;połączyć się `Home` z akcji otaczającej wartość jest używany.</span><span class="sxs-lookup"><span data-stu-id="85187-1286">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="85187-1287">Wartości otoczenia, które nie pasują do parametru, są ignorowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1287">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="85187-1288">Wartości otoczenia są również ignorowane, gdy jawnie podana wartość zastępuje wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1288">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="85187-1289">Dopasowywanie odbywa się od lewej do prawej w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1289">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="85187-1290">Wartości jawnie podane, ale nie pasują do segmentu trasy są dodawane do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="85187-1290">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="85187-1291">W poniższej tabeli przedstawiono `{controller}/{action}/{id?}`wynik podczas korzystania z szablonu trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-1291">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="85187-1292">Wartości otoczenia</span><span class="sxs-lookup"><span data-stu-id="85187-1292">Ambient Values</span></span>                     | <span data-ttu-id="85187-1293">Wartości jawne</span><span class="sxs-lookup"><span data-stu-id="85187-1293">Explicit Values</span></span>                        | <span data-ttu-id="85187-1294">Wynik</span><span class="sxs-lookup"><span data-stu-id="85187-1294">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="85187-1295">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-1295">controller = "Home"</span></span>                | <span data-ttu-id="85187-1296">akcja = "Informacje"</span><span class="sxs-lookup"><span data-stu-id="85187-1296">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="85187-1297">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-1297">controller = "Home"</span></span>                | <span data-ttu-id="85187-1298">controller = "Kolejność", akcja = "O"</span><span class="sxs-lookup"><span data-stu-id="85187-1298">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="85187-1299">sterownik = "Home", kolor = "Czerwony"</span><span class="sxs-lookup"><span data-stu-id="85187-1299">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="85187-1300">akcja = "Informacje"</span><span class="sxs-lookup"><span data-stu-id="85187-1300">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="85187-1301">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-1301">controller = "Home"</span></span>                | <span data-ttu-id="85187-1302">akcja = "O", kolor = "Czerwony"</span><span class="sxs-lookup"><span data-stu-id="85187-1302">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="85187-1303">Jeśli trasa ma wartość domyślną, która nie odpowiada parametrowi i ta wartość jest jawnie podana, musi być zgodna z wartością domyślną:</span><span class="sxs-lookup"><span data-stu-id="85187-1303">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="85187-1304">Generowanie łączy generuje tylko łącze dla `controller` tej `action` trasy, gdy pasujące wartości dla i są dostarczane.</span><span class="sxs-lookup"><span data-stu-id="85187-1304">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="85187-1305">Segmenty złożone</span><span class="sxs-lookup"><span data-stu-id="85187-1305">Complex segments</span></span>

<span data-ttu-id="85187-1306">Złożone segmenty (na przykład) `[Route("/x{token}y")]`są przetwarzane przez dopasowanie literałów od prawej do lewej w sposób niechciwy.</span><span class="sxs-lookup"><span data-stu-id="85187-1306">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="85187-1307">Zobacz [ten kod,](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) aby uzyskać szczegółowe wyjaśnienie, jak segmenty złożone są dopasowywały.</span><span class="sxs-lookup"><span data-stu-id="85187-1307">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="85187-1308">[Przykładowy kod](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) nie jest używany przez ASP.NET Core, ale zapewnia dobre wyjaśnienie złożonych segmentów.</span><span class="sxs-lookup"><span data-stu-id="85187-1308">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="85187-1309">Routing jest odpowiedzialny za mapowanie identyfikatorów URI żądań do obsługi tras i wysyłania żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="85187-1309">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="85187-1310">Trasy są definiowane w aplikacji i konfigurowane po uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1310">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="85187-1311">Trasa może opcjonalnie wyodrębnić wartości z adresu URL zawartego w żądaniu, a te wartości mogą być następnie używane do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="85187-1311">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="85187-1312">Korzystając ze skonfigurowanych tras z aplikacji, routing jest w stanie wygenerować adresy URL, które mapują do obsługi trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1312">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="85187-1313">Aby użyć najnowszych scenariuszy routingu w ASP.NET Core 2.1, określ [wersję](xref:mvc/compatibility-version) zgodności `Startup.ConfigureServices`z rejestracją usług MVC w:</span><span class="sxs-lookup"><span data-stu-id="85187-1313">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="85187-1314">Ten dokument obejmuje routing ASP.NET niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="85187-1314">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="85187-1315">Aby uzyskać informacje na temat ASP.NET routingu Core MVC, zobacz <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="85187-1315">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="85187-1316">Aby uzyskać informacje na temat konwencji routingu na stronach Razor Pages, zobacz <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="85187-1316">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="85187-1317">[Wyświetl lub pobierz przykładowy kod](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([jak pobrać](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="85187-1317">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="85187-1318">Podstawowe informacje o routingu</span><span class="sxs-lookup"><span data-stu-id="85187-1318">Routing basics</span></span>

<span data-ttu-id="85187-1319">Większość aplikacji powinna wybrać podstawowy i opisowy schemat routingu, aby adresy URL były czytelne i znaczące.</span><span class="sxs-lookup"><span data-stu-id="85187-1319">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="85187-1320">Domyślna trasa `{controller=Home}/{action=Index}/{id?}`konwencjonalna:</span><span class="sxs-lookup"><span data-stu-id="85187-1320">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="85187-1321">Obsługuje podstawowy i opisowy schemat routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-1321">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="85187-1322">Jest użytecznym punktem wyjścia dla aplikacji opartych na interfejsie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="85187-1322">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="85187-1323">Deweloperzy często dodają dodatkowe trasy terse do obszarów o dużym natężeniu ruchu aplikacji w sytuacjach specjalistycznych (na przykład blog i punkty końcowe e-commerce) przy użyciu [routingu atrybutów](xref:mvc/controllers/routing#attribute-routing) lub dedykowanych tras konwencjonalnych.</span><span class="sxs-lookup"><span data-stu-id="85187-1323">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="85187-1324">Interfejsy API sieci Web powinny używać routingu atrybutów do modelowania funkcji aplikacji jako zestawu zasobów, w których operacje są reprezentowane przez zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-1324">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="85187-1325">Oznacza to, że wiele operacji (na przykład GET, POST) na tym samym zasobie logicznym będzie używać tego samego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1325">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="85187-1326">Routing atrybutów zapewnia poziom kontroli, który jest potrzebny do starannego projektowania układu publicznego punktu końcowego interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="85187-1326">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="85187-1327">Aplikacje Razor Pages używają domyślnego routingu konwencjonalnego do obsługi nazwanych zasobów w folderze *Strony* aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1327">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="85187-1328">Dostępne są dodatkowe konwencje, które umożliwiają dostosowanie zachowania routingu stron Razor.</span><span class="sxs-lookup"><span data-stu-id="85187-1328">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="85187-1329">Aby uzyskać więcej informacji, zobacz <xref:razor-pages/index> i <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="85187-1329">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="85187-1330">Obsługa generowania adresów URL umożliwia tworzenie aplikacji bez twardych adresów URL kodowania, aby połączyć aplikację ze sobą.</span><span class="sxs-lookup"><span data-stu-id="85187-1330">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="85187-1331">Ta obsługa umożliwia rozpoczęcie podstawowej konfiguracji routingu i modyfikowanie tras po określeniu układu zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1331">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="85187-1332">Usługa Routing używa tras <xref:Microsoft.AspNetCore.Routing.IRouter> implementacji do:</span><span class="sxs-lookup"><span data-stu-id="85187-1332">Routing uses routes implementations of <xref:Microsoft.AspNetCore.Routing.IRouter> to:</span></span>

* <span data-ttu-id="85187-1333">Mapowanie przychodzących żądań do *obsługi tras*.</span><span class="sxs-lookup"><span data-stu-id="85187-1333">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="85187-1334">Wygeneruj adresy URL używane w odpowiedziach.</span><span class="sxs-lookup"><span data-stu-id="85187-1334">Generate the URLs used in responses.</span></span>

<span data-ttu-id="85187-1335">Domyślnie aplikacja ma jedną kolekcję tras.</span><span class="sxs-lookup"><span data-stu-id="85187-1335">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="85187-1336">Po odebraniu żądania trasy w kolekcji są przetwarzane w kolejności, w jakiej istnieją w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="85187-1336">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="85187-1337">Struktura próbuje dopasować adres URL żądania przychodzącego do <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> trasy w kolekcji, wywołując metodę na każdej trasie w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="85187-1337">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="85187-1338">Odpowiedzi można użyć routingu do generowania adresów URL (na przykład przekierowania lub łącza) na podstawie informacji o trasie, a tym samym uniknąć zakodowanych adresów URL, co pomaga w utrzymaniu.</span><span class="sxs-lookup"><span data-stu-id="85187-1338">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="85187-1339">System wyznaczania tras ma następujące właściwości:</span><span class="sxs-lookup"><span data-stu-id="85187-1339">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="85187-1340">Składnia szablonu trasy służy do definiowania tras z tokenizowanymi parametrami trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1340">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="85187-1341">Konfiguracja punktu końcowego w stylu konwencjonalnym i atrybutu jest dozwolona.</span><span class="sxs-lookup"><span data-stu-id="85187-1341">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="85187-1342"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint>służy do określenia, czy parametr URL zawiera prawidłową wartość dla danego ograniczenia punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="85187-1342"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="85187-1343">Modele aplikacji, takie jak MVC/Razor Pages, rejestrują wszystkie swoje trasy, które mają przewidywalną implementację scenariuszy routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-1343">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="85187-1344">Odpowiedzi można użyć routingu do generowania adresów URL (na przykład przekierowania lub łącza) na podstawie informacji o trasie, a tym samym uniknąć zakodowanych adresów URL, co pomaga w utrzymaniu.</span><span class="sxs-lookup"><span data-stu-id="85187-1344">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="85187-1345">Generowanie adresów URL opiera się na trasach, które obsługują dowolną rozszerzalność.</span><span class="sxs-lookup"><span data-stu-id="85187-1345">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="85187-1346"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper>oferuje metody tworzenia adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1346"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>
<!-- fix [middleware](xref:fundamentals/middleware/index) -->
<span data-ttu-id="85187-1347">Routing jest połączony z potoku <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> [oprogramowania pośredniczącego](xref:fundamentals/middleware/index) przez klasę.</span><span class="sxs-lookup"><span data-stu-id="85187-1347">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="85187-1348">[ASP.NET Core MVC](xref:mvc/overview) dodaje routing do potoku oprogramowania pośredniczącego w ramach swojej konfiguracji i obsługuje routing w aplikacjach MVC i Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="85187-1348">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="85187-1349">Aby dowiedzieć się, jak używać routingu jako składnika autonomicznego, zobacz sekcję [Użyj oprogramowania pośredniczącego routingu.](#use-routing-middleware)</span><span class="sxs-lookup"><span data-stu-id="85187-1349">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="85187-1350">Dopasowywanie adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-1350">URL matching</span></span>

<span data-ttu-id="85187-1351">Dopasowywanie adresów URL jest procesem, w którym routing wysyła żądanie przychodzące do *programu obsługi*.</span><span class="sxs-lookup"><span data-stu-id="85187-1351">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="85187-1352">Ten proces jest oparty na danych w ścieżce adresu URL, ale można go rozszerzyć, aby uwzględnić wszystkie dane w żądaniu.</span><span class="sxs-lookup"><span data-stu-id="85187-1352">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="85187-1353">Możliwość wysyłania żądań do oddzielnych programów obsługi jest kluczem do skalowania rozmiaru i złożoności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1353">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="85187-1354">Przychodzące żądania <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>wprowadź , <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> który wywołuje metodę na każdej trasie w sekwencji.</span><span class="sxs-lookup"><span data-stu-id="85187-1354">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="85187-1355">Wystąpienie <xref:Microsoft.AspNetCore.Routing.IRouter> decyduje, czy *do obsługi* żądania, ustawiając [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) do non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="85187-1355">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="85187-1356">Jeśli trasa ustawia program obsługi dla żądania, przetwarzanie trasy zatrzymuje się, a program obsługi jest wywoływany do przetwarzania żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1356">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="85187-1357">Jeśli nie zostanie znaleziony żaden program obsługi trasy do przetwarzania żądania, oprogramowanie pośredniczące przekazuje żądanie do następnego oprogramowania pośredniczącego w potoku żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1357">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="85187-1358">Podstawowym dane <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> wejściowe do jest [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) skojarzone z bieżącym żądaniem.</span><span class="sxs-lookup"><span data-stu-id="85187-1358">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="85187-1359">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) i [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) są wyjścia ustawione po trasie jest dopasowywał.</span><span class="sxs-lookup"><span data-stu-id="85187-1359">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="85187-1360">Dopasowanie, które <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> wywołuje również ustawia właściwości [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) do odpowiednich wartości na podstawie przetwarzania żądań wykonywane do tej pory.</span><span class="sxs-lookup"><span data-stu-id="85187-1360">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="85187-1361">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) jest słownikiem *wartości trasy* wytwarzanych z trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1361">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="85187-1362">Wartości te są zwykle określane przez tokenizacji adresu URL i może służyć do akceptowania danych wejściowych użytkownika lub do podejmowania dalszych decyzji wysyłki wewnątrz aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1362">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="85187-1363">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) jest workiem właściwości dodatkowych danych związanych z dopasowaną trasą.</span><span class="sxs-lookup"><span data-stu-id="85187-1363">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="85187-1364"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*>są dostarczane do obsługi kojarzenia danych o stanie z każdej trasy, dzięki czemu aplikacja może podejmować decyzje na podstawie trasy dopasowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1364"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="85187-1365">Te wartości są zdefiniowane przez dewelopera i **nie** wpływają na zachowanie routingu w żaden sposób.</span><span class="sxs-lookup"><span data-stu-id="85187-1365">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="85187-1366">Ponadto wartości ukryte w [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) mogą być dowolnego typu, w przeciwieństwie do [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), które muszą być konwertowane do i z ciągów.</span><span class="sxs-lookup"><span data-stu-id="85187-1366">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="85187-1367">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) to lista tras, które brały udział w pomyślnym dopasowaniu żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1367">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="85187-1368">Trasy mogą być zagnieżdżone wewnątrz siebie.</span><span class="sxs-lookup"><span data-stu-id="85187-1368">Routes can be nested inside of one another.</span></span> <span data-ttu-id="85187-1369">Właściwość <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odzwierciedla ścieżkę przez drzewo logiczne tras, które doprowadziły do dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-1369">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="85187-1370">Ogólnie rzecz biorąc pierwszy <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> element w jest zbieranie trasy i powinny być używane do generowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1370">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="85187-1371">Ostatni element <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> w jest program obsługi marszruty, który pasuje.</span><span class="sxs-lookup"><span data-stu-id="85187-1371">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="85187-1372">Generowanie adresu URL</span><span class="sxs-lookup"><span data-stu-id="85187-1372">URL generation</span></span>

<span data-ttu-id="85187-1373">Generowanie adresów URL to proces, w którym routing może tworzyć ścieżkę adresu URL na podstawie zestawu wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1373">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="85187-1374">Umożliwia to logiczne oddzielenie programów obsługi trasy i adresów URL, które do nich uzyskują dostęp.</span><span class="sxs-lookup"><span data-stu-id="85187-1374">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="85187-1375">Generowanie adresu URL następuje podobny proces iteracji, ale zaczyna <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> się od kodu użytkownika lub struktury wywoływania do metody kolekcji trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1375">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="85187-1376">Każda *trasa* <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> ma swoją metodę wywoływaną <xref:Microsoft.AspNetCore.Routing.VirtualPathData> w sekwencji, dopóki nie zostanie zwrócona wartość null.</span><span class="sxs-lookup"><span data-stu-id="85187-1376">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="85187-1377">Podstawowe dane wejściowe <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> to:</span><span class="sxs-lookup"><span data-stu-id="85187-1377">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="85187-1378">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="85187-1378">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="85187-1379">VirtualPathContext.Wartości</span><span class="sxs-lookup"><span data-stu-id="85187-1379">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="85187-1380">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="85187-1380">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="85187-1381">Trasy używają przede wszystkim wartości <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> trasy podanych przez i zdecydować, czy jest możliwe wygenerowanie adresu URL i jakie wartości mają być uwzględnione.</span><span class="sxs-lookup"><span data-stu-id="85187-1381">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="85187-1382">Są <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to zestaw wartości trasy, które zostały utworzone z dopasowania bieżącego żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1382">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="85187-1383">Z kolei <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> są to wartości trasy, które określają sposób generowania żądanego adresu URL dla bieżącej operacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1383">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="85187-1384">Jest <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> to przewidziane w przypadku, gdy trasa powinna uzyskać usługi lub dodatkowe dane skojarzone z bieżącym kontekstem.</span><span class="sxs-lookup"><span data-stu-id="85187-1384">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="85187-1385">[VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) można potraktowania jako zestawu nadpisań dla [virtualpathcontext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="85187-1385">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="85187-1386">Generowanie adresów URL próbuje ponownie użyć wartości trasy z bieżącego żądania do generowania adresów URL dla łączy przy użyciu tych samych wartości trasy lub trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1386">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="85187-1387">Wyjście jest <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> . <xref:Microsoft.AspNetCore.Routing.VirtualPathData></span><span class="sxs-lookup"><span data-stu-id="85187-1387">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="85187-1388"><xref:Microsoft.AspNetCore.Routing.VirtualPathData>jest równoległym <xref:Microsoft.AspNetCore.Routing.RouteData></span><span class="sxs-lookup"><span data-stu-id="85187-1388"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="85187-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData>zawiera <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> wyjściowy adres URL i niektóre dodatkowe właściwości, które powinny być ustawione przez trasę.</span><span class="sxs-lookup"><span data-stu-id="85187-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="85187-1390">Właściwość [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) zawiera *ścieżkę wirtualną* wyprodukowaną przez trasę.</span><span class="sxs-lookup"><span data-stu-id="85187-1390">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="85187-1391">W zależności od potrzeb może być konieczne dalsze przetwarzanie ścieżki.</span><span class="sxs-lookup"><span data-stu-id="85187-1391">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="85187-1392">Jeśli chcesz renderować wygenerowany adres URL w formacie HTML, należy dołączyć ścieżkę podstawową aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1392">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="85187-1393">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) jest odwołaniem do trasy, która pomyślnie wygenerowała adres URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1393">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="85187-1394">[VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) właściwości jest słownik dodatkowych danych związanych z marszrutą, która wygenerowała adres URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1394">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="85187-1395">Jest to paralela [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="85187-1395">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="85187-1396">Tworzenie tras</span><span class="sxs-lookup"><span data-stu-id="85187-1396">Create routes</span></span>

<span data-ttu-id="85187-1397">Routing zapewnia <xref:Microsoft.AspNetCore.Routing.Route> klasę jako standardową implementację <xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="85187-1397">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="85187-1398"><xref:Microsoft.AspNetCore.Routing.Route>Używa składni *szablonu trasy* do definiowania wzorców dopasowanych <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> do ścieżki adresu URL, gdy jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="85187-1398"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="85187-1399"><xref:Microsoft.AspNetCore.Routing.Route>używa tego samego szablonu trasy <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> do generowania adresu URL, gdy jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="85187-1399"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="85187-1400">Większość aplikacji tworzy <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> trasy przez wywołanie lub <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>jedną z podobnych metod rozszerzenia zdefiniowanych w programie .</span><span class="sxs-lookup"><span data-stu-id="85187-1400">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="85187-1401">Każda z <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> metod rozszerzenia utworzyć <xref:Microsoft.AspNetCore.Routing.Route> wystąpienie i dodać go do kolekcji trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1401">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="85187-1402"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>nie akceptuje parametru obsługi marszruty.</span><span class="sxs-lookup"><span data-stu-id="85187-1402"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="85187-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>dodaje tylko trasy obsługiwane przez <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>plik .</span><span class="sxs-lookup"><span data-stu-id="85187-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="85187-1404">Domyślny program `IRouter`obsługi jest , a program obsługi może nie obsługiwać żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1404">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="85187-1405">Na przykład ASP.NET Core MVC jest zazwyczaj skonfigurowany jako domyślny program obsługi, który obsługuje tylko żądania, które pasują do dostępnego kontrolera i akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-1405">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="85187-1406">Aby dowiedzieć się więcej o <xref:mvc/controllers/routing>routingu w MVC, zobacz .</span><span class="sxs-lookup"><span data-stu-id="85187-1406">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="85187-1407">Poniższy przykład kodu jest <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> przykładem wywołania używanego przez typową definicję trasy core MVC ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="85187-1407">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="85187-1408">Ten szablon pasuje do ścieżki adresu URL i wyodrębnia wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1408">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="85187-1409">Na przykład ścieżka `/Products/Details/17` generuje następujące wartości `{ controller = Products, action = Details, id = 17 }`trasy: .</span><span class="sxs-lookup"><span data-stu-id="85187-1409">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="85187-1410">Wartości trasy są określane przez podzielenie ścieżki adresu URL na segmenty i dopasowanie każdego segmentu do nazwy *parametru trasy* w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1410">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="85187-1411">Parametry trasy są nazwane.</span><span class="sxs-lookup"><span data-stu-id="85187-1411">Route parameters are named.</span></span> <span data-ttu-id="85187-1412">Parametry zdefiniowane przez załączenie nazwy `{ ... }`parametru w nawiasy klamrowe .</span><span class="sxs-lookup"><span data-stu-id="85187-1412">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="85187-1413">Poprzedni szablon może również odpowiadać `/` ścieżce `{ controller = Home, action = Index }`adresu URL i tworzyć wartości .</span><span class="sxs-lookup"><span data-stu-id="85187-1413">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="85187-1414">Dzieje się `{controller}` tak, ponieważ parametry `{action}` i `id` trasy mają wartości domyślne, a parametr trasy jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="85187-1414">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="85187-1415">Znak równości (`=`), po którym następuje wartość po nazwie parametru trasy definiuje wartość domyślną dla parametru.</span><span class="sxs-lookup"><span data-stu-id="85187-1415">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="85187-1416">Znak zapytania`?`( ) po nazwie parametru trasy definiuje parametr opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="85187-1416">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="85187-1417">Parametry trasy z wartością domyślną *zawsze* generują wartość trasy, gdy trasa jest zgodna.</span><span class="sxs-lookup"><span data-stu-id="85187-1417">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="85187-1418">Parametry opcjonalne nie generują wartości trasy, jeśli nie ma odpowiedniego segmentu ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1418">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="85187-1419">Zobacz sekcję [odwołania do szablonu trasy,](#route-template-reference) aby uzyskać dokładny opis scenariuszy szablonu trasy i składni.</span><span class="sxs-lookup"><span data-stu-id="85187-1419">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="85187-1420">W poniższym przykładzie definicja `{id:int}` parametru trasy definiuje ograniczenie [trasy](#route-constraint-reference) dla parametru `id` trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-1420">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="85187-1421">Ten szablon pasuje do `/Products/Details/17` ścieżki `/Products/Details/Apples`adresu URL, takiej jak, ale nie .</span><span class="sxs-lookup"><span data-stu-id="85187-1421">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="85187-1422">Ograniczenia trasy <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementują i sprawdzają wartości trasy, aby je zweryfikować.</span><span class="sxs-lookup"><span data-stu-id="85187-1422">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="85187-1423">W tym przykładzie `id` wartość trasy musi być konwertowana na całkowitą.</span><span class="sxs-lookup"><span data-stu-id="85187-1423">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="85187-1424">Zobacz [route-constraint-reference, aby](#route-constraint-reference) uzyskać wyjaśnienie ograniczeń trasy dostarczonych przez strukturę.</span><span class="sxs-lookup"><span data-stu-id="85187-1424">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="85187-1425">Dodatkowe przeciążenia <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> wartości `constraints`akceptowania dla , `dataTokens`i `defaults`.</span><span class="sxs-lookup"><span data-stu-id="85187-1425">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="85187-1426">Typowym zastosowaniem tych parametrów jest przekazanie anonimowo wpisanego obiektu, w którym nazwy właściwości typu anonimowego odpowiadają nazwom parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1426">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="85187-1427">Poniższe <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> przykłady tworzą równoważne trasy:</span><span class="sxs-lookup"><span data-stu-id="85187-1427">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="85187-1428">Składnia wbudowana do definiowania ograniczeń i wartości domyślnych może być wygodna w przypadku prostych tras.</span><span class="sxs-lookup"><span data-stu-id="85187-1428">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="85187-1429">Istnieją jednak scenariusze, takie jak tokeny danych, które nie są obsługiwane przez składnię wbudowaną.</span><span class="sxs-lookup"><span data-stu-id="85187-1429">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="85187-1430">W poniższym przykładzie przedstawiono kilka dodatkowych scenariuszy:</span><span class="sxs-lookup"><span data-stu-id="85187-1430">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="85187-1431">Poprzedni szablon pasuje do ścieżki `/Blog/All-About-Routing/Introduction` adresu URL, `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`takiej jak i wyodrębnia wartości .</span><span class="sxs-lookup"><span data-stu-id="85187-1431">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="85187-1432">Domyślne wartości `controller` trasy `action` dla i są tworzone przez trasę, nawet jeśli w szablonie nie ma odpowiednich parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1432">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="85187-1433">Wartości domyślne można określić w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1433">Default values can be specified in the route template.</span></span> <span data-ttu-id="85187-1434">Parametr `article` trasy jest definiowany jako *catch-all* przez pojawienie`*`się gwiazdki ( ) przed nazwą parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1434">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="85187-1435">Parametry trasy catch-all przechwytują pozostałą część ścieżki adresu URL i mogą również odpowiadać pustejasce.</span><span class="sxs-lookup"><span data-stu-id="85187-1435">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="85187-1436">W poniższym przykładzie dodano ograniczenia trasy i tokeny danych:</span><span class="sxs-lookup"><span data-stu-id="85187-1436">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="85187-1437">Poprzedni szablon pasuje do ścieżki `/en-US/Products/5` adresu URL, `{ controller = Products, action = Details, id = 5 }` takiej jak `{ locale = en-US }`i wyodrębnia wartości i tokeny danych.</span><span class="sxs-lookup"><span data-stu-id="85187-1437">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Lokalne tokeny systemu Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="85187-1439">Generowanie adresu URL klasy trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1439">Route class URL generation</span></span>

<span data-ttu-id="85187-1440">Klasa <xref:Microsoft.AspNetCore.Routing.Route> może również wykonywać generowanie adresów URL, łącząc zestaw wartości trasy z szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1440">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="85187-1441">Jest to logicznie odwrotny proces dopasowywania ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1441">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="85187-1442">Aby lepiej zrozumieć generowanie adresów URL, wyobraź sobie, jaki adres URL chcesz wygenerować, a następnie zastanów się, jak szablon trasy będzie zgodny z tym adresem URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1442">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="85187-1443">Jakie wartości powstałyby?</span><span class="sxs-lookup"><span data-stu-id="85187-1443">What values would be produced?</span></span> <span data-ttu-id="85187-1444">Jest to odpowiednik przybliżone, <xref:Microsoft.AspNetCore.Routing.Route> jak działa generowanie adresów URL w klasie.</span><span class="sxs-lookup"><span data-stu-id="85187-1444">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="85187-1445">W poniższym przykładzie użyto ogólnej trasy domyślnej ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="85187-1445">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="85187-1446">Z wartościami `{ controller = Products, action = List }`trasy `/Products/List` generowany jest adres URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1446">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="85187-1447">Wartości trasy są zastępowane odpowiednimi parametrami trasy w celu utworzenia ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1447">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="85187-1448">Ponieważ `id` jest opcjonalnym parametrem trasy, adres URL `id`jest pomyślnie generowany bez wartości dla .</span><span class="sxs-lookup"><span data-stu-id="85187-1448">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="85187-1449">Z wartościami `{ controller = Home, action = Index }`trasy `/` generowany jest adres URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1449">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="85187-1450">Podane wartości trasy są zgodne z wartościami domyślnymi, a segmenty odpowiadające wartościom domyślnym są bezpiecznie pomijane.</span><span class="sxs-lookup"><span data-stu-id="85187-1450">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="85187-1451">Oba adresy URL wygenerowane w obie`/Home/Index` `/`strony z następującą definicją trasy ( i ) generują te same wartości trasy, które zostały użyte do wygenerowania adresu URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1451">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="85187-1452">Aplikacja używająca ASP.NET Core MVC <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> powinna używać do generowania adresów URL zamiast wywoływania bezpośrednio do routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-1452">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="85187-1453">Aby uzyskać więcej informacji na temat generowania adresów URL, zobacz sekcję [odwołanie do generowania adresów URL.](#url-generation-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-1453">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="85187-1454">Korzystanie z oprogramowania pośredniczącego routingu</span><span class="sxs-lookup"><span data-stu-id="85187-1454">Use routing middleware</span></span>

<span data-ttu-id="85187-1455">Odwołanie się do [metapakietu Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) w pliku projektu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1455">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="85187-1456">Dodaj routing do kontenera usługi w: `Startup.ConfigureServices`</span><span class="sxs-lookup"><span data-stu-id="85187-1456">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="85187-1457">Trasy muszą być skonfigurowane w metodzie. `Startup.Configure`</span><span class="sxs-lookup"><span data-stu-id="85187-1457">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="85187-1458">Przykładowa aplikacja używa następujących interfejsów API:</span><span class="sxs-lookup"><span data-stu-id="85187-1458">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="85187-1459"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>&ndash; Pasuje tylko do żądań HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="85187-1459"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="85187-1460">W poniższej tabeli przedstawiono odpowiedzi z podanymi identyfikatorami URI.</span><span class="sxs-lookup"><span data-stu-id="85187-1460">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="85187-1461">Identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="85187-1461">URI</span></span>                    | <span data-ttu-id="85187-1462">Odpowiedź</span><span class="sxs-lookup"><span data-stu-id="85187-1462">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="85187-1463">Cześć!</span><span class="sxs-lookup"><span data-stu-id="85187-1463">Hello!</span></span> <span data-ttu-id="85187-1464">Wartości trasy: [operacja, tworzenie], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="85187-1464">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="85187-1465">Cześć!</span><span class="sxs-lookup"><span data-stu-id="85187-1465">Hello!</span></span> <span data-ttu-id="85187-1466">Wartości trasy: [operacja, ścieżka], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="85187-1466">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="85187-1467">Cześć!</span><span class="sxs-lookup"><span data-stu-id="85187-1467">Hello!</span></span> <span data-ttu-id="85187-1468">Wartości trasy: [operacja, ścieżka], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="85187-1468">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="85187-1469">Żądanie przechodzi, bez dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-1469">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="85187-1470">Cześć, Joe!</span><span class="sxs-lookup"><span data-stu-id="85187-1470">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="85187-1471">Żądanie przechodzi, pasuje tylko do protokołu HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="85187-1471">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="85187-1472">Żądanie przechodzi, bez dopasowania.</span><span class="sxs-lookup"><span data-stu-id="85187-1472">The request falls through, no match.</span></span>              |

<span data-ttu-id="85187-1473">Jeśli konfigurujesz jedną trasę, <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> wywołanie `IRouter` przekazywania w wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="85187-1473">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="85187-1474">Nie musisz używać <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="85187-1474">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="85187-1475">Struktura zawiera zestaw metod rozszerzenia do tworzenia<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>tras ( ):</span><span class="sxs-lookup"><span data-stu-id="85187-1475">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="85187-1476">Niektóre z wymienionych metod, takie jak <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, wymagają . <xref:Microsoft.AspNetCore.Http.RequestDelegate></span><span class="sxs-lookup"><span data-stu-id="85187-1476">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="85187-1477">Jest <xref:Microsoft.AspNetCore.Http.RequestDelegate> używany jako *program obsługi trasy,* gdy trasa jest zgodna.</span><span class="sxs-lookup"><span data-stu-id="85187-1477">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="85187-1478">Inne metody w tej rodzinie umożliwiają konfigurowanie potoku oprogramowania pośredniczącego do użycia jako program obsługi trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1478">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="85187-1479">Jeśli `Map*` metoda nie akceptuje programu obsługi, <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>na przykład <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>, używa .</span><span class="sxs-lookup"><span data-stu-id="85187-1479">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="85187-1480">Metody `Map[Verb]` używają ograniczeń, aby ograniczyć trasę do zlecenia HTTP w nazwie metody.</span><span class="sxs-lookup"><span data-stu-id="85187-1480">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="85187-1481">Na przykład <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> zobacz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>i .</span><span class="sxs-lookup"><span data-stu-id="85187-1481">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="85187-1482">Odwołanie do szablonu trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1482">Route template reference</span></span>

<span data-ttu-id="85187-1483">Tokeny w nawiasach`{ ... }`klamrowych ( ) definiują *parametry trasy,* które są powiązane, jeśli trasa jest dopasowywała.</span><span class="sxs-lookup"><span data-stu-id="85187-1483">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="85187-1484">Można zdefiniować więcej niż jeden parametr trasy w segmencie trasy, ale muszą one być oddzielone wartością literału.</span><span class="sxs-lookup"><span data-stu-id="85187-1484">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="85187-1485">Na przykład `{controller=Home}{action=Index}` nie jest prawidłową trasą, ponieważ nie `{controller}` ma `{action}`wartości literału między i .</span><span class="sxs-lookup"><span data-stu-id="85187-1485">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="85187-1486">Te parametry trasy muszą mieć nazwę i mogą mieć określone dodatkowe atrybuty.</span><span class="sxs-lookup"><span data-stu-id="85187-1486">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="85187-1487">Tekst dosłowny inny niż `{id}`parametry trasy (na `/` przykład) i separator ścieżki muszą być zgodne z tekstem w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1487">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="85187-1488">Dopasowanie tekstu jest niewrażliwe na rozmiary i opiera się na zdekodowanym reprezentacji ścieżki adresów URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1488">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="85187-1489">`{` Aby dopasować dosłowny ogranicznik parametru trasy ( lub `}``{{` ), `}}`wyjdź z ogranicznika, powtarzając znak ( lub ).</span><span class="sxs-lookup"><span data-stu-id="85187-1489">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="85187-1490">Wzorce adresów URL, które próbują przechwycić nazwę pliku z opcjonalnym rozszerzeniem pliku, mają dodatkowe uwagi.</span><span class="sxs-lookup"><span data-stu-id="85187-1490">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="85187-1491">Rozważmy na przykład `files/{filename}.{ext?}`szablon .</span><span class="sxs-lookup"><span data-stu-id="85187-1491">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="85187-1492">Gdy wartości `filename` dla `ext` obu i istnieją, obie wartości są wypełniane.</span><span class="sxs-lookup"><span data-stu-id="85187-1492">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="85187-1493">Jeśli w adresie URL `filename` istnieje tylko wartość, trasa jest`.`zgodna, ponieważ okres końcowy ( ) jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="85187-1493">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="85187-1494">Następujące adresy URL są zgodne z tą trasą:</span><span class="sxs-lookup"><span data-stu-id="85187-1494">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="85187-1495">Gwiazdkę (`*`) można użyć jako prefiksu parametru trasy do powiązania z resztą identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="85187-1495">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="85187-1496">Jest to tak zwany parametr *catch-all.*</span><span class="sxs-lookup"><span data-stu-id="85187-1496">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="85187-1497">Na przykład `blog/{*slug}` dopasowuje dowolny identyfikator `/blog` URI, który rozpoczyna się od `slug` i ma dowolną wartość po nim, która jest przypisana do wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1497">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="85187-1498">Catch-all parametry mogą również odpowiadać pusty ciąg.</span><span class="sxs-lookup"><span data-stu-id="85187-1498">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="85187-1499">Parametr catch-all wycina odpowiednie znaki, gdy trasa jest używana do`/`generowania adresu URL, w tym separatora ścieżki ( ) znaków.</span><span class="sxs-lookup"><span data-stu-id="85187-1499">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="85187-1500">Na przykład trasa `foo/{*path}` z `{ path = "my/path" }` wartościami `foo/my%2Fpath`trasy generuje .</span><span class="sxs-lookup"><span data-stu-id="85187-1500">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="85187-1501">Zwróć uwagę na ukucie do przodu.</span><span class="sxs-lookup"><span data-stu-id="85187-1501">Note the escaped forward slash.</span></span>

<span data-ttu-id="85187-1502">Parametry trasy mogą mieć *wartości domyślne* wyznaczone przez określenie wartości domyślnej po`=`nazwie parametru oddzielonej znakiem równości ( ).</span><span class="sxs-lookup"><span data-stu-id="85187-1502">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="85187-1503">Na przykład `{controller=Home}` definiuje `Home` jako wartość `controller`domyślną dla .</span><span class="sxs-lookup"><span data-stu-id="85187-1503">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="85187-1504">Wartość domyślna jest używana, jeśli w adresie URL parametru nie ma żadnej wartości.</span><span class="sxs-lookup"><span data-stu-id="85187-1504">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="85187-1505">Parametry trasy są opcjonalne, dołączając`?`znak zapytania ( ) na końcu `id?`nazwy parametru, jak w .</span><span class="sxs-lookup"><span data-stu-id="85187-1505">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="85187-1506">Różnica między wartościami opcjonalnymi a domyślnymi parametrami trasy polega na&mdash;tym, że parametr trasy z wartością domyślną zawsze tworzy wartość, którą parametr opcjonalny ma wartość tylko wtedy, gdy wartość jest dostarczana przez adres URL żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1506">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="85187-1507">Parametry trasy mogą mieć ograniczenia, które muszą odpowiadać wartości trasy powiązanej z adresem URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1507">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="85187-1508">Dodanie dwukropka (`:`) i nazwy ograniczenia po nazwie parametru trasy określa ograniczenie *wbudowane* dla parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1508">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="85187-1509">Jeśli ograniczenie wymaga argumentów, są one ujęte`(...)`w nawiasy ( ) po nazwie ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1509">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="85187-1510">Można określić wiele ograniczeń wbudowanych, dołączając`:`inny dwukropek ( ) i nazwę ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1510">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="85187-1511">Nazwa ograniczenia i argumenty są <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> przekazywane do usługi, aby utworzyć wystąpienie do użycia w przetwarzaniu adresów <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1511">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="85187-1512">Na przykład szablon `blog/{article:minlength(10)}` trasy określa `minlength` ograniczenie z `10`argumentem .</span><span class="sxs-lookup"><span data-stu-id="85187-1512">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="85187-1513">Aby uzyskać więcej informacji na temat ograniczeń trasy i listy ograniczeń przewidzianych przez strukturę, zobacz [sekcja Odwołanie do ograniczenia trasy.](#route-constraint-reference)</span><span class="sxs-lookup"><span data-stu-id="85187-1513">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="85187-1514">W poniższej tabeli przedstawiono przykładowe szablony tras i ich zachowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-1514">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="85187-1515">Szablon trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1515">Route Template</span></span>                           | <span data-ttu-id="85187-1516">Przykładowy pasujący identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="85187-1516">Example Matching URI</span></span>    | <span data-ttu-id="85187-1517">Identyfikator URI żądania&hellip;</span><span class="sxs-lookup"><span data-stu-id="85187-1517">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="85187-1518">Pasuje tylko do `/hello`pojedynczej ścieżki .</span><span class="sxs-lookup"><span data-stu-id="85187-1518">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="85187-1519">Dopasowuje `Page` `Home`i ustawia na .</span><span class="sxs-lookup"><span data-stu-id="85187-1519">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="85187-1520">Dopasowuje `Page` `Contact`i ustawia na .</span><span class="sxs-lookup"><span data-stu-id="85187-1520">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="85187-1521">Mapy do `Products` kontrolera i `List` akcji.</span><span class="sxs-lookup"><span data-stu-id="85187-1521">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="85187-1522">Mapy do `Products` kontrolera `Details` `id` i akcji ( ustawiona na 123).</span><span class="sxs-lookup"><span data-stu-id="85187-1522">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="85187-1523">Mapy do `Home` kontrolera `Index` `id` i metody ( jest ignorowana).</span><span class="sxs-lookup"><span data-stu-id="85187-1523">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="85187-1524">Korzystanie z szablonu jest zazwyczaj najprostszym podejściem do routingu.</span><span class="sxs-lookup"><span data-stu-id="85187-1524">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="85187-1525">Ograniczenia i wartości domyślne można również określić poza szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1525">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="85187-1526">Włącz [rejestrowanie,](xref:fundamentals/logging/index) aby zobaczyć, jak wbudowane implementacje routingu, takie jak <xref:Microsoft.AspNetCore.Routing.Route>, dopasowywanie żądań.</span><span class="sxs-lookup"><span data-stu-id="85187-1526">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="85187-1527">Odwołanie do ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1527">Route constraint reference</span></span>

<span data-ttu-id="85187-1528">Ograniczenia trasy są wykonywane, gdy dopasowanie wystąpiło z przychodzącym adresem URL, a ścieżka adresu URL jest tokenizowana na wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1528">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="85187-1529">Ograniczenia trasy zazwyczaj sprawdzają wartość trasy skojarzoną za pośrednictwem szablonu trasy i podejmują decyzję tak/nie o tym, czy wartość jest dopuszczalna.</span><span class="sxs-lookup"><span data-stu-id="85187-1529">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="85187-1530">Niektóre ograniczenia trasy używają danych poza wartością trasy, aby rozważyć, czy żądanie może być kierowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1530">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="85187-1531">Na przykład <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> można zaakceptować lub odrzucić żądanie na podstawie jego zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="85187-1531">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="85187-1532">Ograniczenia są używane w żądaniach routingu i generowaniu łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-1532">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="85187-1533">Nie używaj ograniczeń do **sprawdzania poprawności danych wejściowych**.</span><span class="sxs-lookup"><span data-stu-id="85187-1533">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="85187-1534">Jeśli ograniczenia są używane do **sprawdzania poprawności danych wejściowych,** nieprawidłowe wyniki wejściowe w *404 - Nie znaleziono* odpowiedzi zamiast *400 - Złe żądanie* z odpowiednim komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="85187-1534">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="85187-1535">Ograniczenia trasy są używane do **rozróżniania** podobnych tras, a nie do sprawdzania poprawności danych wejściowych dla określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1535">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="85187-1536">W poniższej tabeli przedstawiono przykładowe ograniczenia trasy i ich oczekiwane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="85187-1536">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="85187-1537">ograniczenie</span><span class="sxs-lookup"><span data-stu-id="85187-1537">constraint</span></span> | <span data-ttu-id="85187-1538">Przykład</span><span class="sxs-lookup"><span data-stu-id="85187-1538">Example</span></span> | <span data-ttu-id="85187-1539">Przykładowe dopasowania</span><span class="sxs-lookup"><span data-stu-id="85187-1539">Example Matches</span></span> | <span data-ttu-id="85187-1540">Uwagi</span><span class="sxs-lookup"><span data-stu-id="85187-1540">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="85187-1541">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="85187-1541">`123456789`, `-123456789`</span></span> | <span data-ttu-id="85187-1542">Dopasowuje dowolną całkowitą</span><span class="sxs-lookup"><span data-stu-id="85187-1542">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="85187-1543">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="85187-1543">`true`, `FALSE`</span></span> | <span data-ttu-id="85187-1544">Dopasowania `true` `false` lub (niewrażliwe na wielkości liter)</span><span class="sxs-lookup"><span data-stu-id="85187-1544">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="85187-1545">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="85187-1545">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="85187-1546">Pasuje do `DateTime` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1546">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="85187-1547">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1547">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="85187-1548">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="85187-1548">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="85187-1549">Pasuje do `decimal` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1549">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="85187-1550">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1550">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="85187-1551">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="85187-1551">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="85187-1552">Pasuje do `double` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1552">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="85187-1553">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1553">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="85187-1554">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="85187-1554">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="85187-1555">Pasuje do `float` prawidłowej wartości w kulturze niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1555">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="85187-1556">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="85187-1556">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="85187-1557">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="85187-1557">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="85187-1558">Dopasowuje `Guid` prawidłową wartość</span><span class="sxs-lookup"><span data-stu-id="85187-1558">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="85187-1559">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="85187-1559">`123456789`, `-123456789`</span></span> | <span data-ttu-id="85187-1560">Dopasowuje `long` prawidłową wartość</span><span class="sxs-lookup"><span data-stu-id="85187-1560">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="85187-1561">Ciąg musi zawierać co najmniej 4 znaki</span><span class="sxs-lookup"><span data-stu-id="85187-1561">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="85187-1562">Ciąg nie może zawierać więcej niż 8 znaków</span><span class="sxs-lookup"><span data-stu-id="85187-1562">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="85187-1563">Ciąg musi mieć dokładnie 12 znaków</span><span class="sxs-lookup"><span data-stu-id="85187-1563">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="85187-1564">Ciąg musi mieć co najmniej 8 znaków i nie więcej niż 16 znaków</span><span class="sxs-lookup"><span data-stu-id="85187-1564">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="85187-1565">Wartość całkowita musi wynosić co najmniej 18</span><span class="sxs-lookup"><span data-stu-id="85187-1565">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="85187-1566">Wartość całkowita nie może być większa niż 120</span><span class="sxs-lookup"><span data-stu-id="85187-1566">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="85187-1567">Wartość całkowita musi wynosić co najmniej 18, ale nie więcej niż 120</span><span class="sxs-lookup"><span data-stu-id="85187-1567">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="85187-1568">Ciąg musi składać się z jednego`a`-`z`lub więcej znaków alfabetycznych ( , bez uwzględniania wielkości liter)</span><span class="sxs-lookup"><span data-stu-id="85187-1568">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="85187-1569">Ciąg musi być zgodny z wyrażeniem regularnym (zobacz wskazówki dotyczące definiowania wyrażenia regularnego)</span><span class="sxs-lookup"><span data-stu-id="85187-1569">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="85187-1570">Służy do wymuszania obecności wartości nieparametryjnej podczas generowania adresu URL</span><span class="sxs-lookup"><span data-stu-id="85187-1570">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="85187-1571">Wiele ograniczeń rozdzielanych dwukropkiem można zastosować do pojedynczego parametru.</span><span class="sxs-lookup"><span data-stu-id="85187-1571">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="85187-1572">Na przykład następujące ograniczenie ogranicza parametr do wartości całkowitej 1 lub większej:</span><span class="sxs-lookup"><span data-stu-id="85187-1572">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="85187-1573">Ograniczenia trasy, które weryfikują adres URL i są `int` `DateTime`konwertowane na typ CLR (na przykład lub ) zawsze używają kultury niezmiennej.</span><span class="sxs-lookup"><span data-stu-id="85187-1573">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="85187-1574">Te ograniczenia zakładają, że adres URL nie jest zlokalizowany.</span><span class="sxs-lookup"><span data-stu-id="85187-1574">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="85187-1575">Ograniczenia trasy dostarczone przez strukturę nie modyfikują wartości przechowywanych w wartościach marszruty.</span><span class="sxs-lookup"><span data-stu-id="85187-1575">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="85187-1576">Wszystkie wartości trasy analizowane z adresu URL są przechowywane jako ciągi.</span><span class="sxs-lookup"><span data-stu-id="85187-1576">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="85187-1577">Na przykład `float` ograniczenie próbuje przekonwertować wartość trasy na float, ale przekonwertowana wartość jest używana tylko do sprawdzenia, czy można ją przekonwertować na float.</span><span class="sxs-lookup"><span data-stu-id="85187-1577">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="85187-1578">Wyrażenia regularne</span><span class="sxs-lookup"><span data-stu-id="85187-1578">Regular expressions</span></span>

<span data-ttu-id="85187-1579">Struktura ASP.NET Core dodaje `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktora wyrażeń regularnych.</span><span class="sxs-lookup"><span data-stu-id="85187-1579">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="85187-1580">Opis <xref:System.Text.RegularExpressions.RegexOptions> tych członków można znaleźć w części.</span><span class="sxs-lookup"><span data-stu-id="85187-1580">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="85187-1581">Wyrażenia regularne używają ograniczników i tokenów podobnych do tych używanych przez routing i język C#.</span><span class="sxs-lookup"><span data-stu-id="85187-1581">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="85187-1582">Tokeny wyrażenia regularnego muszą zostać zmienione.</span><span class="sxs-lookup"><span data-stu-id="85187-1582">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="85187-1583">Aby użyć wyrażenia `^\d{3}-\d{2}-\d{4}$` regularnego w routingu, `\` wyrażenie musi mieć (pojedyncze ukośnik odwrotny) znaki podane w ciągu jako `\\` `\` (podwójne ukośnik wsteczny) znaków w pliku źródłowym C# w celu ucieczki znak ucieczki ciągu (chyba że przy użyciu [dosłownie literałów ciągów](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="85187-1583">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="85187-1584">Aby uniknąć znaków ogranicznika`{` `}`parametru `]`marszruty ( ,`{{` `}`, `[[` `[` `]]`, ), podwoić znaki w wyrażeniu ( , , , ).</span><span class="sxs-lookup"><span data-stu-id="85187-1584">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="85187-1585">W poniższej tabeli przedstawiono wyrażenie regularne i wersję ze strony osób zmienionych.</span><span class="sxs-lookup"><span data-stu-id="85187-1585">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="85187-1586">Wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="85187-1586">Regular Expression</span></span>    | <span data-ttu-id="85187-1587">Wysunęło się wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="85187-1587">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="85187-1588">Wyrażenia regularne używane w routingu często`^`zaczynają się od znaku cieszy ( ) i pasują do pozycji początkowej ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-1588">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="85187-1589">Wyrażenia często kończą się znakiem`$`dolara ( ) znakiem i dopasowaniem końca ciągu.</span><span class="sxs-lookup"><span data-stu-id="85187-1589">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="85187-1590">Znaki `^` `$` i upewnij się, że wyrażenie regularne odpowiada wartości całego parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="85187-1590">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="85187-1591">Bez `^` znaków `$` i wyrażenie regularne odpowiada wszystkie podciągi w ciągu, który jest często niepożądane.</span><span class="sxs-lookup"><span data-stu-id="85187-1591">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="85187-1592">W poniższej tabeli przedstawiono przykłady i wyjaśniono, dlaczego są zgodne lub nie dopasowywać.</span><span class="sxs-lookup"><span data-stu-id="85187-1592">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="85187-1593">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="85187-1593">Expression</span></span>   | <span data-ttu-id="85187-1594">Ciąg</span><span class="sxs-lookup"><span data-stu-id="85187-1594">String</span></span>    | <span data-ttu-id="85187-1595">Dopasowanie</span><span class="sxs-lookup"><span data-stu-id="85187-1595">Match</span></span> | <span data-ttu-id="85187-1596">Komentarz</span><span class="sxs-lookup"><span data-stu-id="85187-1596">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="85187-1597">hello</span><span class="sxs-lookup"><span data-stu-id="85187-1597">hello</span></span>     | <span data-ttu-id="85187-1598">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1598">Yes</span></span>   | <span data-ttu-id="85187-1599">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="85187-1599">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="85187-1600">123abc456</span><span class="sxs-lookup"><span data-stu-id="85187-1600">123abc456</span></span> | <span data-ttu-id="85187-1601">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1601">Yes</span></span>   | <span data-ttu-id="85187-1602">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="85187-1602">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="85187-1603">Mz</span><span class="sxs-lookup"><span data-stu-id="85187-1603">mz</span></span>        | <span data-ttu-id="85187-1604">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1604">Yes</span></span>   | <span data-ttu-id="85187-1605">Dopasowuje wyrażenie</span><span class="sxs-lookup"><span data-stu-id="85187-1605">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="85187-1606">MZ</span><span class="sxs-lookup"><span data-stu-id="85187-1606">MZ</span></span>        | <span data-ttu-id="85187-1607">Tak</span><span class="sxs-lookup"><span data-stu-id="85187-1607">Yes</span></span>   | <span data-ttu-id="85187-1608">Nie z uwzględnieniem wielkości liter</span><span class="sxs-lookup"><span data-stu-id="85187-1608">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="85187-1609">hello</span><span class="sxs-lookup"><span data-stu-id="85187-1609">hello</span></span>     | <span data-ttu-id="85187-1610">Nie</span><span class="sxs-lookup"><span data-stu-id="85187-1610">No</span></span>    | <span data-ttu-id="85187-1611">Zobacz `^` `$` i powyżej</span><span class="sxs-lookup"><span data-stu-id="85187-1611">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="85187-1612">123abc456</span><span class="sxs-lookup"><span data-stu-id="85187-1612">123abc456</span></span> | <span data-ttu-id="85187-1613">Nie</span><span class="sxs-lookup"><span data-stu-id="85187-1613">No</span></span>    | <span data-ttu-id="85187-1614">Zobacz `^` `$` i powyżej</span><span class="sxs-lookup"><span data-stu-id="85187-1614">See `^` and `$` above</span></span> |

<span data-ttu-id="85187-1615">Aby uzyskać więcej informacji na temat składni wyrażeń regularnych, zobacz [.NET Framework Wyrażenia regularne](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="85187-1615">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="85187-1616">Aby ograniczyć parametr do znanego zestawu możliwych wartości, należy użyć wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="85187-1616">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="85187-1617">Na przykład `{action:regex(^(list|get|create)$)}` tylko `action` dopasowuje `list` `get`wartość `create`trasy do , lub .</span><span class="sxs-lookup"><span data-stu-id="85187-1617">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="85187-1618">Jeśli przekazywane do słownika ograniczeń, `^(list|get|create)$` ciąg jest równoważne.</span><span class="sxs-lookup"><span data-stu-id="85187-1618">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="85187-1619">Ograniczenia przekazywane w słowniku ograniczeń (nie wbudowane w szablonie), które nie pasują do jednego ze znanych ograniczeń, są również traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="85187-1619">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="85187-1620">Niestandardowe ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="85187-1620">Custom Route Constraints</span></span>

<span data-ttu-id="85187-1621">Oprócz wbudowanych ograniczeń trasy ograniczenia trasy można tworzyć przez implementowanie <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="85187-1621">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="85187-1622">Interfejs <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> zawiera jedną metodę, która zwraca, `Match` `true` jeśli `false` ograniczenie jest spełnione i w inny sposób.</span><span class="sxs-lookup"><span data-stu-id="85187-1622">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="85187-1623">Aby użyć <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>niestandardowego, typ ograniczenia trasy musi być <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> zarejestrowany w kontenerze usługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="85187-1623">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="85187-1624">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> to słownik, który mapuje <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> klucze ograniczenia trasy do implementacji, które sprawdzają te ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1624">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="85187-1625">Aplikacja może <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> być aktualizowana `Startup.ConfigureServices` w ramach [usługi. Wywołanie AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) lub <xref:Microsoft.AspNetCore.Routing.RouteOptions> konfiguracja `services.Configure<RouteOptions>`bezpośrednio z programem .</span><span class="sxs-lookup"><span data-stu-id="85187-1625">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="85187-1626">Przykład:</span><span class="sxs-lookup"><span data-stu-id="85187-1626">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="85187-1627">Ograniczenie można następnie zastosować do tras w zwykły sposób, przy użyciu nazwy określonej podczas rejestrowania typu ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1627">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="85187-1628">Przykład:</span><span class="sxs-lookup"><span data-stu-id="85187-1628">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="85187-1629">Odwołanie do generowania adresów URL</span><span class="sxs-lookup"><span data-stu-id="85187-1629">URL generation reference</span></span>

<span data-ttu-id="85187-1630">W poniższym przykładzie pokazano, jak wygenerować łącze <xref:Microsoft.AspNetCore.Routing.RouteCollection>do trasy, pod jakimasemie jest słownik wartości trasy i .</span><span class="sxs-lookup"><span data-stu-id="85187-1630">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="85187-1631">Wygenerowany <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> na końcu poprzedniej próbki `/package/create/123`to .</span><span class="sxs-lookup"><span data-stu-id="85187-1631">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="85187-1632">Słownik dostarcza wartości `operation` i `id` trasy szablonu "Track Package `package/{operation}/{id}`Route", .</span><span class="sxs-lookup"><span data-stu-id="85187-1632">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="85187-1633">Aby uzyskać szczegółowe informacje, zobacz przykładowy kod w sekcji [Użyj oprogramowania pośredniczącego routingu](#use-routing-middleware) lub [w przykładowej aplikacji](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="85187-1633">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="85187-1634">Drugim parametrem <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> konstruktora jest zbiór *wartości otoczenia*.</span><span class="sxs-lookup"><span data-stu-id="85187-1634">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="85187-1635">Wartości otoczenia są wygodne w użyciu, ponieważ ograniczają liczbę wartości, które deweloper musi określić w kontekście żądania.</span><span class="sxs-lookup"><span data-stu-id="85187-1635">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="85187-1636">Bieżące wartości trasy bieżącego żądania są traktowane jako wartości otoczenia dla generowania łączy.</span><span class="sxs-lookup"><span data-stu-id="85187-1636">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="85187-1637">W `About` ASP.NET Core MVC app akcji `HomeController`, nie trzeba określić wartość trasy kontrolera, aby `Index` &mdash;połączyć się `Home` z akcji otaczającej wartość jest używany.</span><span class="sxs-lookup"><span data-stu-id="85187-1637">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="85187-1638">Wartości otoczenia, które nie pasują do parametru, są ignorowane.</span><span class="sxs-lookup"><span data-stu-id="85187-1638">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="85187-1639">Wartości otoczenia są również ignorowane, gdy jawnie podana wartość zastępuje wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="85187-1639">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="85187-1640">Dopasowywanie odbywa się od lewej do prawej w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="85187-1640">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="85187-1641">Wartości jawnie podane, ale nie pasują do segmentu trasy są dodawane do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="85187-1641">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="85187-1642">W poniższej tabeli przedstawiono `{controller}/{action}/{id?}`wynik podczas korzystania z szablonu trasy .</span><span class="sxs-lookup"><span data-stu-id="85187-1642">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="85187-1643">Wartości otoczenia</span><span class="sxs-lookup"><span data-stu-id="85187-1643">Ambient Values</span></span>                     | <span data-ttu-id="85187-1644">Wartości jawne</span><span class="sxs-lookup"><span data-stu-id="85187-1644">Explicit Values</span></span>                        | <span data-ttu-id="85187-1645">Wynik</span><span class="sxs-lookup"><span data-stu-id="85187-1645">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="85187-1646">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-1646">controller = "Home"</span></span>                | <span data-ttu-id="85187-1647">akcja = "Informacje"</span><span class="sxs-lookup"><span data-stu-id="85187-1647">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="85187-1648">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-1648">controller = "Home"</span></span>                | <span data-ttu-id="85187-1649">controller = "Kolejność", akcja = "O"</span><span class="sxs-lookup"><span data-stu-id="85187-1649">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="85187-1650">sterownik = "Home", kolor = "Czerwony"</span><span class="sxs-lookup"><span data-stu-id="85187-1650">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="85187-1651">akcja = "Informacje"</span><span class="sxs-lookup"><span data-stu-id="85187-1651">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="85187-1652">sterownik = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="85187-1652">controller = "Home"</span></span>                | <span data-ttu-id="85187-1653">akcja = "O", kolor = "Czerwony"</span><span class="sxs-lookup"><span data-stu-id="85187-1653">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="85187-1654">Jeśli trasa ma wartość domyślną, która nie odpowiada parametrowi i ta wartość jest jawnie podana, musi być zgodna z wartością domyślną:</span><span class="sxs-lookup"><span data-stu-id="85187-1654">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="85187-1655">Generowanie łączy generuje tylko łącze dla `controller` tej `action` trasy, gdy pasujące wartości dla i są dostarczane.</span><span class="sxs-lookup"><span data-stu-id="85187-1655">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="85187-1656">Segmenty złożone</span><span class="sxs-lookup"><span data-stu-id="85187-1656">Complex segments</span></span>

<span data-ttu-id="85187-1657">Złożone segmenty (na przykład) `[Route("/x{token}y")]`są przetwarzane przez dopasowanie literałów od prawej do lewej w sposób niechciwy.</span><span class="sxs-lookup"><span data-stu-id="85187-1657">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="85187-1658">Zobacz [ten kod,](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) aby uzyskać szczegółowe wyjaśnienie, jak segmenty złożone są dopasowywały.</span><span class="sxs-lookup"><span data-stu-id="85187-1658">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="85187-1659">[Przykładowy kod](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) nie jest używany przez ASP.NET Core, ale zapewnia dobre wyjaśnienie złożonych segmentów.</span><span class="sxs-lookup"><span data-stu-id="85187-1659">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>

::: moniker-end
