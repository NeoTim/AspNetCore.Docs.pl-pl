# <a name="upload-files-sample-app"></a><span data-ttu-id="af779-101">Przykładowa aplikacja przekazywania plików</span><span class="sxs-lookup"><span data-stu-id="af779-101">Upload Files Sample App</span></span>

<span data-ttu-id="af779-102">Ta przykładowa aplikacja pokazuje Koncepcje opisane w temacie [przekazywanie plików w ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) tematu.</span><span class="sxs-lookup"><span data-stu-id="af779-102">This sample app demonstrates concepts described in the [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) topic.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="af779-103">Zagadnienia dotyczące bezpieczeństwa</span><span class="sxs-lookup"><span data-stu-id="af779-103">Security considerations</span></span>

<span data-ttu-id="af779-104">Należy zachować ostrożność, zapewniając użytkownikom możliwość przekazywania plików na serwer.</span><span class="sxs-lookup"><span data-stu-id="af779-104">Use caution when providing users with the ability to upload files to a server.</span></span> <span data-ttu-id="af779-105">Osoby atakujące mogą wykonywać ataki [typu "odmowa usługi"](/windows-hardware/drivers/ifs/denial-of-service) , próbować przekazać wirusy lub złośliwe oprogramowanie lub próbować złamać sieci i serwery w inny sposób.</span><span class="sxs-lookup"><span data-stu-id="af779-105">Attackers may execute [denial of service](/windows-hardware/drivers/ifs/denial-of-service) attacks, attempt to upload viruses or malware, or attempt to compromise networks and servers in other ways.</span></span>

<span data-ttu-id="af779-106">Kroki zabezpieczeń, które zmniejszają prawdopodobieństwo pomyślnego ataku:</span><span class="sxs-lookup"><span data-stu-id="af779-106">Security steps that reduce the likelihood of a successful attack are:</span></span>

* <span data-ttu-id="af779-107">Przekaż pliki do dedykowanego obszaru przekazywania plików w systemie, najlepiej do dysku niesystemowego.</span><span class="sxs-lookup"><span data-stu-id="af779-107">Upload files to a dedicated file upload area on the system, preferably to a non-system drive.</span></span> <span data-ttu-id="af779-108">Użycie dedykowanej lokalizacji ułatwia nakładanie środków zabezpieczeń na przekazane pliki.</span><span class="sxs-lookup"><span data-stu-id="af779-108">Use of a dedicated location makes it easier to impose security measures on uploaded files.</span></span> <span data-ttu-id="af779-109">Wyłącz uprawnienia do wykonywania w lokalizacji przekazywania pliku. &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-109">Disable execute permissions on the file upload location.&dagger;</span></span>
* <span data-ttu-id="af779-110">Nigdy nie Utrwalaj przekazanych plików w tym samym drzewie katalogów co aplikacja. &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-110">Never persist uploaded files in the same directory tree as the app.&dagger;</span></span>
* <span data-ttu-id="af779-111">Użyj bezpiecznej nazwy pliku, która jest określana przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="af779-111">Use a safe file name determined by the app.</span></span> <span data-ttu-id="af779-112">Nie używaj nazwy pliku dostarczonej przez dane wejściowe użytkownika lub niezaufanej nazwy pliku przekazanego pliku. &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-112">Don't use a file name provided by user input or the untrusted file name of the uploaded file.&dagger;</span></span>
* <span data-ttu-id="af779-113">Zezwala tylko na określony zestaw zatwierdzonych rozszerzeń plików. &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-113">Only allow a specific set of approved file extensions.&dagger;</span></span>
* <span data-ttu-id="af779-114">Sprawdź podpis formatu pliku, aby uniemożliwić użytkownikowi przekazanie zamaskowanego pliku (na przykład przekazanie pliku *exe* z rozszerzeniem *txt* ). &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-114">Check the file format signature to prevent a user from uploading a masqueraded file (for example, uploading an *.exe* file with a *.txt* extension).&dagger;</span></span>
* <span data-ttu-id="af779-115">Sprawdź, czy na serwerze są również wykonywane sprawdzenia po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="af779-115">Verify that client-side checks are also performed on the server.</span></span> <span data-ttu-id="af779-116">Sprawdzanie po stronie klienta można łatwo obejść. &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-116">Client-side checks are easy to circumvent.&dagger;</span></span>
* <span data-ttu-id="af779-117">Sprawdź rozmiar przekazywania i Zapobiegaj przeciążom, które są większe niż oczekiwano. &dagger;</span><span class="sxs-lookup"><span data-stu-id="af779-117">Check the size of the upload and prevent uploads that are larger than expected.&dagger;</span></span>
* <span data-ttu-id="af779-118">Jeśli pliki nie powinny być zastąpione przez przekazany plik o tej samej nazwie, przed przekazaniem pliku Sprawdź nazwę pliku względem bazy danych lub magazynu fizycznego.</span><span class="sxs-lookup"><span data-stu-id="af779-118">When files shouldn't be overwritten by an uploaded file with the same name, check the file name against the database or physical storage before uploading the file.</span></span>
* <span data-ttu-id="af779-119">**Przed zapisaniem pliku Uruchom skaner wirusów/złośliwego oprogramowania dla przekazanej zawartości.**</span><span class="sxs-lookup"><span data-stu-id="af779-119">**Run a virus/malware scanner on uploaded content before the file is stored.**</span></span>

<span data-ttu-id="af779-120">Przykładowa aplikacja &dagger;The ilustruje podejście, które spełnia kryteria.</span><span class="sxs-lookup"><span data-stu-id="af779-120">&dagger;The sample app demonstrates an approach that meets the criteria.</span></span>

> [!WARNING]
> <span data-ttu-id="af779-121">Przekazywanie złośliwego kodu do systemu często jest pierwszym krokiem do wykonywania kodu, która może być:</span><span class="sxs-lookup"><span data-stu-id="af779-121">Uploading malicious code to a system is frequently the first step to executing code that can:</span></span>
>
> * <span data-ttu-id="af779-122">Całkowicie przejęcia w systemie.</span><span class="sxs-lookup"><span data-stu-id="af779-122">Completely takeover a system.</span></span>
> * <span data-ttu-id="af779-123">Przeciąż system z wynikiem awarii systemu.</span><span class="sxs-lookup"><span data-stu-id="af779-123">Overload a system with the result that the system crashes.</span></span>
> * <span data-ttu-id="af779-124">Naruszyć bezpieczeństwo danych użytkownika lub systemu.</span><span class="sxs-lookup"><span data-stu-id="af779-124">Compromise user or system data.</span></span>
> * <span data-ttu-id="af779-125">Zastosuj graffiti do publicznego interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="af779-125">Apply graffiti to a public UI.</span></span>
>
> <span data-ttu-id="af779-126">Instrukcje dotyczące zmniejszenie obszaru powierzchni ataku, akceptując pliki użytkowników zobacz następujące zasoby:</span><span class="sxs-lookup"><span data-stu-id="af779-126">For information on reducing the attack surface area when accepting files from users, see the following resources:</span></span>
>
> * [<span data-ttu-id="af779-127">Przekazywanie pliku bez ograniczeń</span><span class="sxs-lookup"><span data-stu-id="af779-127">Unrestricted File Upload</span></span>](https://www.owasp.org/index.php/Unrestricted_File_Upload)
> * <span data-ttu-id="af779-128">@no__t — zabezpieczenia 0Azure: Upewnij się, że podczas akceptowania plików od użytkowników jest stosowane odpowiednie kontrolki @ no__t-0</span><span class="sxs-lookup"><span data-stu-id="af779-128">[Azure Security: Ensure appropriate controls are in place when accepting files from users](/azure/security/azure-security-threat-modeling-tool-input-validation#controls-users)</span></span>

<span data-ttu-id="af779-129">Aby uzyskać dodatkowe informacje, zobacz [przekazywanie plików w ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span><span class="sxs-lookup"><span data-stu-id="af779-129">For additional information, see [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span></span>

## <a name="how-to-use-the-sample"></a><span data-ttu-id="af779-130">Jak używać przykładu</span><span class="sxs-lookup"><span data-stu-id="af779-130">How to use the sample</span></span>

<span data-ttu-id="af779-131">W pliku *appSettings. JSON* :</span><span class="sxs-lookup"><span data-stu-id="af779-131">In the *appsettings.json* file:</span></span>

1. <span data-ttu-id="af779-132">Ustaw ścieżkę dla przechowywanych plików (`StoredFilesPath`).</span><span class="sxs-lookup"><span data-stu-id="af779-132">Set the path for stored files (`StoredFilesPath`).</span></span>

   * <span data-ttu-id="af779-133">Aplikacja Przykładowa ustawia wartość na `c:\\files`, która zakłada, że folder o nazwie *Files* istnieje na głównym dysku systemowym C:.</span><span class="sxs-lookup"><span data-stu-id="af779-133">The sample app sets the value to `c:\\files`, which assumes that a folder named *files* exists at the system's C: drive root.</span></span>
   * <span data-ttu-id="af779-134">Ścieżka musi istnieć.</span><span class="sxs-lookup"><span data-stu-id="af779-134">The path must exist.</span></span> <span data-ttu-id="af779-135">Utwórz folder *Files* na dysku C: lub Ustaw ścieżkę do odpowiedniej lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="af779-135">Create a *files* folder on the system's C: drive or set the path to a suitable location.</span></span>
   * <span data-ttu-id="af779-136">Proces aplikacji wymaga uprawnień do odczytu/zapisu dla ścieżki.</span><span class="sxs-lookup"><span data-stu-id="af779-136">The app's process requires read/write permissions to the path.</span></span>
   * <span data-ttu-id="af779-137">**WAŻNE!**</span><span class="sxs-lookup"><span data-stu-id="af779-137">**IMPORTANT!**</span></span> <span data-ttu-id="af779-138">Wyłącz uprawnienia do wykonywania dla wszystkich użytkowników w ścieżce.</span><span class="sxs-lookup"><span data-stu-id="af779-138">Disable execute permissions for all users at the path.</span></span>

1. <span data-ttu-id="af779-139">Ustaw limit rozmiaru pliku (`FileSizeLimit`) w bajtach.</span><span class="sxs-lookup"><span data-stu-id="af779-139">Set the file size limit (`FileSizeLimit`) in bytes.</span></span> <span data-ttu-id="af779-140">Domyślna wartość `2097152` (2 097 152 bajtów) aplikacji umożliwia przekazywanie plików do 2 MB.</span><span class="sxs-lookup"><span data-stu-id="af779-140">The sample app's default value of `2097152` (2,097,152 bytes) permits file uploads up to 2 MB.</span></span>
